jQuery.sap.declare("sap.basetable.crosstab.BaseControl"),jQuery.sap.require("sap.ui.core.Control"),sap.ui.core.Control.extend("sap.basetable.crosstab.BaseControl",{"metadata":{"properties":{"uiConfig":{"type":"object","group":"Misc","defaultValue":null}}}}),sap.basetable.crosstab.BaseControl.prototype.init=function(){this._app$=null,this._uiConfig=null,this._controls={},this._requestedLoad=null,this._handlers={"resize":null}},sap.basetable.crosstab.BaseControl.prototype.exit=function(){this._app$=null,this._deregister();for(var t in this._controls)this._controls[t].destroy()},sap.basetable.crosstab.BaseControl.prototype.onBeforeRendering=function(){this._deregister()},sap.basetable.crosstab.BaseControl.prototype.onAfterRendering=function(){this._app$?(this._app$.appendTo(this.getDomRef()),this._validateSize(),this._updateChildren(this.mProperties)):(this._app$=jQuery(document.createElement("div")).appendTo(this.getDomRef()).addClass("ui5-viz-controls-app"),jQuery(this._app$).attr("data-sap-ui-preserve",!0),this._createChildren(),this._validateSize()),this._crosstab._addResizeListener(),this._register()},sap.basetable.crosstab.BaseControl.prototype.getUiConfig=function(){return this._uiConfig},sap.basetable.crosstab.BaseControl.prototype.setUiConfig=function(t){this._app$||this._mergeConfig(t)},sap.basetable.crosstab.BaseControl.prototype.save=function(){var t={};for(var e in this._controls)t[e]=this._controls[e].save();return t},sap.basetable.crosstab.BaseControl.prototype.load=function(t){for(var e in t)this._controls[e]?this._controls[e].load(t[e]):this._requestedLoad=t},sap.basetable.crosstab.BaseControl.prototype._createChildren=function(){},sap.basetable.crosstab.BaseControl.prototype._updateChildren=function(){},sap.basetable.crosstab.BaseControl.prototype._mergeConfig=function(t){this._uiConfig=t},sap.basetable.crosstab.BaseControl.prototype._deregister=function(){this._handlers.resize&&sap.ui.core.ResizeHandler.deregister(this._handlers.resize),this._handlers.resize=null},sap.basetable.crosstab.BaseControl.prototype._register=function(){this._handlers.resize=sap.ui.core.ResizeHandler.register(this.getDomRef(),jQuery.proxy(this._validateSize,this))},sap.basetable.crosstab.BaseControl.prototype._validateSize=function(){},sap.basetable.crosstab.BaseControl.prototype._registerControl=function(t,e){this._controls[t]=e,this._requestedLoad&&this._requestedLoad[t]&&(e.load(this._requestedLoad[t]),delete this._requestedLoad[t])},jQuery.sap.declare("sap.basetable.crosstab.CellGroup"),sap.basetable.crosstab.CellGroup=function(t,e,s,a,r){this._id=e,this._tuplePaths=s,this._cellType=r?r:sap.basetable.crosstab.CellGroup.CELL_TYPE_DATAPOINTS,this._groupType=a?a:sap.basetable.crosstab.CellGroup.TYPE_INDIVIDUAL,this._crosstabModel=t.model(),this._cellHeight=t.getCellHeight(),this._cellWidth=t.getCellWidth()},sap.basetable.crosstab.CellGroup.prototype={"_mergedContainerId":void 0,"_data":[]},sap.basetable.crosstab.CellGroup.CELL_TYPE_DATAPOINTS="datapoints",sap.basetable.crosstab.CellGroup.CELL_TYPE_MEMBER_HEADER="memberHeader",sap.basetable.crosstab.CellGroup.GROUP_TYPE_RANGE="range",sap.basetable.crosstab.CellGroup.GROUP_TYPE_INDIVIDUAL="individual",sap.basetable.crosstab.CellGroup.DATA_TYPE_TUPLEPATHS="tuplePaths",sap.basetable.crosstab.CellGroup.DATA_TYPE_RAW="raw",sap.basetable.crosstab.CellGroup.RENDERER_TYPE_CVOM="cvom",sap.basetable.crosstab.CellGroup.RENDERER_TYPE_MINICHART="minichart",sap.basetable.crosstab.CellGroup.RENDERER_TYPE_CUSTOM="custom",sap.basetable.crosstab.CellGroup.prototype.id=function(t){return arguments.length?(this._id=t,this._id):this._id},sap.basetable.crosstab.CellGroup.prototype.tuplePaths=function(t){return arguments.length?(this._tuplePaths=t,this._tuplePaths):this._tuplePaths},sap.basetable.crosstab.CellGroup.prototype.cellType=function(t){return arguments.length?(this._cellType=t,this._cellType):this._cellType},sap.basetable.crosstab.CellGroup.prototype.groupType=function(t){return arguments.length?(this._groupType=t,this._groupType):this._groupType},sap.basetable.crosstab.CellGroup.prototype.formats=function(t){return arguments.length?(this._formats=t,void 0):this._formats},sap.basetable.crosstab.CellGroup.prototype.expression=function(t){return arguments.length?(this._expression=t,void 0):this._expression},sap.basetable.crosstab.CellGroup.prototype.data=function(t,e){if(!arguments.length)return this._data;if(sap.basetable.crosstab.CellGroup.DATA_TYPE_TUPLEPATHS===e){var s=this._getCellCoordinates(this._crosstabModel.getNumberOfTuples(0),this._crosstabModel.getNumberOfTuples(1),t,sap.basetable.crosstab.CellGroup.GROUP_TYPE_RANGE);this._data=[],this._data[0]=[],s.forEach(function(t){var e="dataCell_"+t[0]+"_"+t[1],s=$("#"+e);this._data[0].push(s.text())}.bind(this))}else this._data=t},sap.basetable.crosstab.CellGroup.prototype.setMerged=function(t){this._isMerged=t},sap.basetable.crosstab.CellGroup.prototype.isMerged=function(){return this._isMerged},sap.basetable.crosstab.CellGroup.prototype.renderer=function(t){return arguments.length?(this._renderer=t,void 0):this._renderer},sap.basetable.crosstab.CellGroup.prototype.draw=function(){if(this._isMerged){var t=this.data();this.mergeCell(),t.length>0&&this.data(t),this._drawCell(this._mergedContainerId,this._data[0])}else{var e=this._crosstabModel.getNumberOfTuples(0),s=this._crosstabModel.getNumberOfTuples(1),a=this._getCellCoordinates(e,s,this._tuplePaths,this._groupType);a.forEach(function(t,e){var s="dataCell_"+t[0]+"_"+t[1],a=$("#"+s),r=this._data.length>0?this._data[e]:a.text();this._drawCell(s,r)}.bind(this))}},sap.basetable.crosstab.CellGroup.prototype.mergeCell=function(){var t,e=this._crosstabModel.getNumberOfTuples(0),s=this._crosstabModel.getNumberOfTuples(1),a=this._getCellCoordinates(e,s,this._tuplePaths,this._groupType);this._data=[],this._data[0]=[],a.forEach(function(e,s){var a="dataCell_"+e[0]+"_"+e[1],r=$("#"+a);this._data[0].push(r.text());var o=$("#"+a).closest("td"),i=$("#"+a).closest("tr");0===s&&(t=i),i[0].removeChild(o[0])}.bind(this));var r=a[0],o=a[a.length-1];this._mergedContainerId="dataCell_"+r[0]+"_"+r[1];var i=o[0]-r[0]+1,n=o[1]-r[1]+1,l=sap.basetable.crosstab.utils.RenderUtils.createContentCell(this._mergedContainerId,this._cellWidth(),this._cellHeight(),this._borderWidth(),void 0,i,n,"crosstab-Cell");t.append(l),this._isMerged=!0},sap.basetable.crosstab.CellGroup.prototype._getTupleIndex=function(t){var e=[],s=[];return e=this._crosstabModel.getTupleIndex(0,t),void 0===e&&(e=[],s=this._crosstabModel.getTupleIndex(1,t)),{"rowTupleIndexRange":e,"columnTupleIndexRange":s}},sap.basetable.crosstab.CellGroup.prototype._getCellCoordinates=function(t,e,s,a){var r=[];if(s.forEach(function(s){var a=[],o=[],i=[],n=!1,l=!1;if(1===s.length)a=this._getTupleIndex(s[0]),0===a.rowTupleIndexRange.length?(i=a.columnTupleIndexRange,n=!0):(o=a.rowTupleIndexRange,l=!0);else if(2===s.length)for(var c=0;s.length>c;c++)a=this._getTupleIndex(s[c]),0===a.rowTupleIndexRange.length?i=a.columnTupleIndexRange:o=a.rowTupleIndexRange;if(n)for(var d=0;t>d;d++)for(var b=i[0];i[1]>b;b++)r.push([d,b]);else if(l)for(var h=o[0];o[1]>h;h++)for(var p=0;e>p;p++)r.push([h,p]);else r.push([o[0],i[0]])}.bind(this)),a===sap.basetable.crosstab.CellGroup.GROUP_TYPE_RANGE){var o=r[0],i=r[1];r=[];for(var n=o[0];i[0]>=n;n++)for(var l=o[1];i[1]>=l;l++)r.push([n,l])}return r},sap.basetable.crosstab.CellGroup.prototype._drawCell=function(t,e){var s=this._renderer;if(s){var a=s.type;if(sap.basetable.crosstab.CellGroup.RENDERER_TYPE_CVOM===a)sap.basetable.crosstab.renderer.CVOMRenderer.render(s.body,t,e,this._formats);else if(sap.basetable.crosstab.CellGroup.RENDERER_TYPE_MINICHART===a){var r={"analysisAxis":[{"index":1,"data":[{"type":"Dimension","values":[]}]}],"measureValuesGroup":[{"index":1,"data":[{"type":"Measure","values":[]}]}]};r.measureValuesGroup[0].data[0].values[0]=[],e.forEach(function(t){r.measureValuesGroup[0].data[0].values[0].push(parseFloat(t)),r.analysisAxis[0].data[0].values.push("0")}),sap.basetable.crosstab.renderer.CVOMRenderer.render(s.body,t,r,this._formats)}else sap.basetable.crosstab.CellGroup.RENDERER_TYPE_CUSTOM===a&&sap.basetable.crosstab.renderer.CustomRenderer.render(s.body,t,e,this._formats)}else sap.basetable.crosstab.renderer.StringRenderer.render(t,e,this._formats)},jQuery.sap.declare("sap.basetable.crosstab.ConditionalCellFormatter"),sap.basetable.crosstab.ConditionalCellFormatter=function(){},sap.basetable.crosstab.ConditionalCellFormatter.prototype.generateCellCallback=function(t,e,s){var a=t(e,{"measure":s});return a},jQuery.sap.declare("sap.basetable.crosstab.Crosstab"),sap.basetable.crosstab.Crosstab=function(t){this._crosstabScrollBarEventMediator=new sap.basetable.crosstab.CrosstabScrollBarEventMediator,this._crosstabScrollBarEventConstants=new sap.basetable.crosstab.CrosstabScrollBarEventConstants,this._crosstabConstants=new sap.basetable.crosstab.CrosstabConstants,this._crosstabElementResizedEventConstants=new sap.basetable.crosstab.CrosstabElementResizedEventConstants,this._model=new sap.basetable.crosstab.CrosstabModel(t,this,this._crosstabScrollBarEventMediator,this._crosstabScrollBarEventConstants,this._crosstabElementResizedEventConstants),this._container=t.container,this._size=t.size,this._id=t.parentId,this._crosstabContainers=new sap.basetable.crosstab.CrosstabContainers(this,this._crosstabScrollBarEventMediator,this._crosstabScrollBarEventConstants),this._renderer=new sap.basetable.crosstab.CrosstabRenderer(this,this._crosstabScrollBarEventMediator,t),this._registerScrollBarEvents(),this._crosstabScrollBarController=new sap.basetable.crosstab.CrosstabScrollBarController(this,this._crosstabScrollBarEventMediator,this._crosstabScrollBarEventConstants),this._conditionalFormat=null,this._conditionalFormatRules=[],this._addSelectionListener(),this._crosstabElementResizeHandler=new sap.basetable.crosstab.CrosstabElementResizeHandler(this,this._model,this._renderer,this._crosstabElementResizedEventConstants),this._addResizeListener()},sap.basetable.crosstab.Crosstab.prototype={"_verticallyScrollable":!0,"_horizontallyScrollable":!0,"_scaleFactor":1,"ROW_AXIS":0,"COLUMN_AXIS":1,"BORDER_WIDTH":1,"EXTRA_ROW_BUFFER":1},sap.basetable.crosstab.Crosstab.prototype.getCellWidth=function(){return this._size.cellWidth?this._size.cellWidth:this._crosstabConstants.CELL_WIDTH},sap.basetable.crosstab.Crosstab.prototype.getCellHeight=function(){return this._size.cellHeight?this._size.cellHeight:this._crosstabConstants.CELL_HEIGHT},sap.basetable.crosstab.Crosstab.prototype.getRowCellHeight=function(){return this._size.rowCellHeight?this._size.rowCellHeight:this._crosstabConstants.CELL_HEIGHT},sap.basetable.crosstab.Crosstab.prototype.getRowCellWidth=function(){return this._size.rowCellWidth?this._size.rowCellWidth:this._crosstabConstants.ROW_CELL_WIDTH},sap.basetable.crosstab.Crosstab.prototype.getBorderWidth=function(){return this._size.borderWidth?this._size.borderWidth:this.BORDER_WIDTH},sap.basetable.crosstab.Crosstab.prototype.getId=function(){return this._id},sap.basetable.crosstab.Crosstab.prototype.getHeight=function(){return this._size.height},sap.basetable.crosstab.Crosstab.prototype.getWidth=function(){return this._size.width},sap.basetable.crosstab.Crosstab.prototype.getTotalHeight=function(){var t=this.model().getFullAxisLength(this.ROW_AXIS);return this.model().getPageSize()>=t?this.getSize(this.ROW_AXIS,t,!0):t*this.getCellHeight()},sap.basetable.crosstab.Crosstab.prototype.getTotalWidth=function(){var t=this.model().getFullAxisLength(this.COLUMN_AXIS);return this.getSize(this.COLUMN_AXIS,t,!0)},sap.basetable.crosstab.Crosstab.prototype.getSize=function(t,e,s){var a=[{"key":this.ROW_AXIS,"value":this.COLUMN_AXIS},{"key":this.COLUMN_AXIS,"value":this.ROW_AXIS}],r=0,o=0,i=this.model().getDimensions(a[t].value).length;return t===this.ROW_AXIS&&0===e?(i+=1,this.model().getMeasureMembers().length>0&&(i+=1),o=this.getCellHeight()*i):(0===e&&(e=i),a[t].value===this.COLUMN_AXIS&&(i+=1),t===this.ROW_AXIS?(r+=this.getCellHeight()*e,o=this.getCellHeight()*i):(r+=this._renderer.calculateRightAreaWidth(s),o=this._renderer.calculateLeftAreaWidth()),r+o)},sap.basetable.crosstab.Crosstab.prototype.getPageWidth=function(){var t=this.model().getPageSize();return this.getSize(this.COLUMN_AXIS,t)},sap.basetable.crosstab.Crosstab.prototype.getPageHeight=function(){var t=this.model().getPageSize();return this.getSize(this.ROW_AXIS,t)},sap.basetable.crosstab.Crosstab.prototype.getCrosstabElementResizeHandler=function(){return this._crosstabElementResizeHandler},sap.basetable.crosstab.Crosstab.prototype._registerScrollBarEvents=function(){this._registerBorderEvent(),this._registerNextPageEvent(),this._registerUpdateAxisLengthEvent()},sap.basetable.crosstab.Crosstab.prototype._registerBorderEvent=function(){this._crosstabScrollBarEventMediator.subscribe(this._crosstabScrollBarEventConstants.borderEvent,this.borderEvent.bind(this))},sap.basetable.crosstab.Crosstab.prototype.borderEvent=function(t){this.getRenderer().updateContainerBordersEvent(t)},sap.basetable.crosstab.Crosstab.prototype._registerNextPageEvent=function(){this._crosstabScrollBarEventMediator.subscribe(this._crosstabScrollBarEventConstants.nextPageEvent,this.requestNextPageEvent.bind(this))},sap.basetable.crosstab.Crosstab.prototype.requestNextPageEvent=function(t){this.model().fetchPage(t)},sap.basetable.crosstab.Crosstab.prototype._registerUpdateAxisLengthEvent=function(){this._crosstabScrollBarEventMediator.subscribe(this._crosstabScrollBarEventConstants.updateAxisLength,this.updateAxisLength.bind(this))},sap.basetable.crosstab.Crosstab.prototype.updateAxisLength=function(t){var e=this._renderer.getScrollbarVisibility();this._crosstabScrollBarController.updateScrollBars(this._crosstabScrollBarEventConstants.updateAxisLength,t,e)},sap.basetable.crosstab.Crosstab.prototype.container=function(){return this._container},sap.basetable.crosstab.Crosstab.prototype.model=function(){return this._model},sap.basetable.crosstab.Crosstab.prototype.conditionalFormat=function(){return this._conditionalFormat},sap.basetable.crosstab.Crosstab.prototype.setConditionalFormat=function(t){this._conditionalFormat=t},sap.basetable.crosstab.Crosstab.prototype.setConditionalFormatRules=function(t){(null===t||void 0===t)&&(t=[]),(t.length>0||this._conditionalFormatRules.length!==t.length&&"function"==typeof this.draw)&&this.redraw(this._crosstabScrollBarEventConstants.conditionalFormatEvent),this._conditionalFormatRules=t},sap.basetable.crosstab.Crosstab.prototype.setResizedElements=function(t,e){t=t||[],this._model.setResizedElements(t),e||"function"!=typeof this.draw||this.redraw(this._crosstabElementResizedEventConstants.elementResizedEvent)},sap.basetable.crosstab.Crosstab.prototype.crosstabContainers=function(){return this._crosstabContainers},sap.basetable.crosstab.Crosstab.prototype.getRenderer=function(){return this._renderer},sap.basetable.crosstab.Crosstab.prototype.getCrosstabScrollBarController=function(){return this._crosstabScrollBarController},sap.basetable.crosstab.Crosstab.prototype.select=function(t,e,s){return this._model.select(t,e,s)},sap.basetable.crosstab.Crosstab.prototype.setDataProvider=function(t){this._model.setDataProvider(t)},sap.basetable.crosstab.Crosstab.prototype.vizUpdate=function(t){this.setDataProvider(t),this._renderer.draw(),this.renderCellGroups()},sap.basetable.crosstab.Crosstab.prototype.renderCellGroups=function(){var t=this._model.getCellGroups();t.forEach(function(t){t.draw()})},sap.basetable.crosstab.Crosstab.prototype.redraw=function(t,e){var s=this._renderer.getScrollbarVisibility();if(t===this._crosstabScrollBarEventConstants.conditionalFormatEvent)this._renderer.redrawFromConditionalFormatting(),this._crosstabScrollBarController.updateScrollBars(t,e,s),this._addResizeListener();else if(t===this._crosstabScrollBarEventConstants.newPageEvent)this._renderer.redrawFromPageData(e),this._crosstabScrollBarController.updateScrollBars(t,e,s),this._addResizeListener();else if(t===this._crosstabElementResizedEventConstants.elementResizedEvent){var a=JSON.stringify(this._model.getResizedElements(0))+":"+JSON.stringify(this._model.getResizedElements(1));this._lastResizedElements&&this._lastResizedElements===a||(this.draw(this._size.height,this._size.width,!0),this._addResizeListener(),this._lastResizedElements=a)}},sap.basetable.crosstab.Crosstab.prototype.draw=function(t,e,s){this._updateSize(t,e),this._renderer.draw(t,e);var a=this._renderer.getScrollbarVisibility();this._crosstabScrollBarController.draw(s,a),this._crosstabScrollBarController.attachCrosstabTouchEvents(a),this.model().initializeAxesMetadata()},sap.basetable.crosstab.Crosstab.prototype.drawSection=function(t){var e=t.coordinates,s=this.model().getFullAxisLength(this.ROW_AXIS),a=this.model().getFullAxisLength(this.COLUMN_AXIS);if(e.endRowIndex>=s){e.endRowIndex=0===s?0:s-1;var r=e.endRowIndex-this.model().getPageSize()-1;e.startRowIndex=Math.max(r,0)}if(e.endColumnIndex>=a){e.endColumnIndex=0===a?0:a-1;var o=e.endColumnIndex-this.model().getPageSize()-1;e.startColumnIndex=Math.max(o,0)}this._renderer.drawSection(t);var i=this._renderer.getScrollbarVisibility();this._crosstabScrollBarController.updateScrollBars(this._crosstabScrollBarEventConstants.newSectionEvent,t,i),this._addResizeListener()},sap.basetable.crosstab.Crosstab.prototype.isHorizontallyScrollable=function(){return this._horizontallyScrollable},sap.basetable.crosstab.Crosstab.prototype.setHorizontallyScrollable=function(t){return"boolean"==typeof t&&this._horizontallyScrollable!==t?(this._horizontallyScrollable=t,!0):!1},sap.basetable.crosstab.Crosstab.prototype.isVerticallyScrollable=function(){return this._verticallyScrollable},sap.basetable.crosstab.Crosstab.prototype.setVerticallyScrollable=function(t){return"boolean"==typeof t&&this._verticallyScrollable!==t?(this._verticallyScrollable=t,!0):!1},sap.basetable.crosstab.Crosstab.prototype.getScaleFactor=function(){return this._scaleFactor},sap.basetable.crosstab.Crosstab.prototype.setScaleFactor=function(t){"number"==typeof t&&(this._scaleFactor=t)},sap.basetable.crosstab.Crosstab.prototype.updateAxesMetadata=function(t){this._model.updateAxesMetadata(t)},sap.basetable.crosstab.Crosstab.prototype.addPageData=function(t){this._model.addPageData(t)},sap.basetable.crosstab.Crosstab.prototype._addSelectionListener=function(){$(this._container).on("click",function(t){var e=$(t.target),s=this.getCrosstabScrollBarController().getAllFloatedHeaders(),a="",r=this._model.getMeasureMembers(),o=this.getRenderer().styleSelectedCells(e,s);if(r.length>0)if(o&&o.hasClass("crosstab-cell-selected")){var i=this.getRenderer().getPageCellIdMeasureMap();a=i[o.attr("id")]?i[o.attr("id")]:r[0].id}else a=r[0].id;sap.ui.getCore().getEventBus().publish("crosstab","sap.viz.ext.crosstab.CrosstabEvent.SELECTED",{"mergeKey":a})}.bind(this))},sap.basetable.crosstab.Crosstab.prototype._addResizeListener=function(){this._crosstabElementResizeHandler.addResizeListener()},sap.basetable.crosstab.Crosstab.prototype._updateSize=function(t,e){this._size.height=t,this._size.width=e},sap.basetable.crosstab.Crosstab.prototype.publishNextPageEvent=function(t){this._crosstabScrollBarEventMediator.publish(this._crosstabScrollBarEventConstants.nextPageEvent,t)},sap.basetable.crosstab.Crosstab.prototype.isMetaDataBorderPresent=function(t){var e=null;return t===this._crosstabConstants.Horizontal&&(e=this.model().getMeasureMembers().length>0||this.model().getDimensions(this._crosstabConstants.ROW_AXIS_INDEX).length>0),e},jQuery.sap.declare("sap.basetable.crosstab.CrosstabConstants"),sap.basetable.crosstab.CrosstabConstants=function(){var t={};return t.Both="Both",t.Horizontal="Horizontal",t.HORIZONTAL_SCROLL_WINDOW=50,t.Vertical="Vertical",t.VERTICAL_SCROLL_WINDOW=100,t.RowAxisHeader="RowAxisHeader",t.ROW_AXIS_INDEX=0,t.COLUMN_AXIS_INDEX=1,t.Row="row",t.Column="column",t.GreyBackground="#f7f7f8",t.PositionTop="top",t.PositionLeft="left",t.touchThreshold=20,t.IncreaseAxis="IncreaseAxis",t.DecreaseAxis="DecreaseAxis",t._METADATA_BORDER_HEIGHT=3,t._METADATA_BORDER_WIDTH=2,t._CROSSTAB_LAYOUT_BORDER_WIDTH=2,t._CROSSTAB_LAYOUT_BORDER_HEIGHT=2,t.ROW_CELL_WIDTH=128,t.CELL_WIDTH=96,t.CELL_HEIGHT=32,t.RowAxisHeaderContainerBorderWidth={"top":0,"right":2,"bottom":0,"left":0},t.LayoutBorderWidth={"top":1,"right":0,"bottom":0,"left":1},t.LeftDimensionHeadersBorderWidth={"top":0,"right":0,"bottom":3,"left":0},Object.freeze(t)},jQuery.sap.declare("sap.basetable.crosstab.CrosstabContainers"),sap.basetable.crosstab.CrosstabContainers=function(t){this._crosstab=t,this._crosstabConstants=new sap.basetable.crosstab.CrosstabConstants},sap.basetable.crosstab.CrosstabContainers.prototype={"_overallContainerHeight":null,"_overallContainerWidth":null,"_bodyHeight":null,"_headerHeight":null,"_scrollContainer":null,"_rowAxisHeaderContainer":null,"_rowAxisHeaderContent":null,"_rowAxisContentContainer":null,"_rowAxisContentContent":null,"_columnHeaderContainer":null,"_columnHeaderContent":null,"_leftAreaDimensionHeaderContainer":null,"_leftAreaDimensionHeaderOuterContainer":null,"_leftAreaDimensionHeaderContent":null,"_rowAxisFloatingHeaderContainer":null,"_oLayout":null,"_topSectionContainer":null,"_leftAreaContainerWidth":null,"_rightAreaContainerWidth":null},sap.basetable.crosstab.CrosstabContainers.scrollbarOutsideContainerAdjustment=20,sap.basetable.crosstab.CrosstabContainers.percentageOfLastCellShown=.5,sap.basetable.crosstab.CrosstabContainers.prototype.setOverallContainerHeight=function(t){var e=t?t:this._crosstab.getHeight();this._crosstab.isHorizontallyScrollable()&&(e-=sap.basetable.crosstab.CrosstabContainers.scrollbarOutsideContainerAdjustment),this._overallContainerHeight=e},sap.basetable.crosstab.CrosstabContainers.prototype.getOverallContainerHeight=function(){return this._overallContainerHeight},sap.basetable.crosstab.CrosstabContainers.prototype.setOverallContainerWidth=function(t){var e=t?t:this._crosstab.getWidth();e-=this._crosstab.isVerticallyScrollable()?sap.basetable.crosstab.CrosstabContainers.scrollbarOutsideContainerAdjustment:this._crosstabConstants._METADATA_BORDER_WIDTH+this._crosstabConstants._CROSSTAB_LAYOUT_BORDER_WIDTH,this._overallContainerWidth=e},sap.basetable.crosstab.CrosstabContainers.prototype.getOverallContainerWidth=function(){return this._overallContainerWidth},sap.basetable.crosstab.CrosstabContainers.prototype.setBodyHeight=function(t){this._bodyHeight=t},sap.basetable.crosstab.CrosstabContainers.prototype.setHeaderHeight=function(t){this._headerHeight=t},sap.basetable.crosstab.CrosstabContainers.prototype.getBodyHeight=function(){return this._bodyHeight},sap.basetable.crosstab.CrosstabContainers.prototype.getHeaderHeight=function(){return this._headerHeight},sap.basetable.crosstab.CrosstabContainers.prototype.setScrollContainer=function(t){this._scrollContainer=t},sap.basetable.crosstab.CrosstabContainers.prototype.getScrollContainer=function(){return this._scrollContainer},sap.basetable.crosstab.CrosstabContainers.prototype.setRowAxisHeaderContainer=function(t){this._rowAxisHeaderContainer=t},sap.basetable.crosstab.CrosstabContainers.prototype.getRowAxisHeaderContainer=function(){return this._rowAxisHeaderContainer},sap.basetable.crosstab.CrosstabContainers.prototype.setRowAxisHeaderContent=function(t){this._rowAxisHeaderContent=t},sap.basetable.crosstab.CrosstabContainers.prototype.getRowAxisHeaderContent=function(){return this._rowAxisHeaderContent},sap.basetable.crosstab.CrosstabContainers.prototype.setRowAxisContentContainer=function(t){this._rowAxisContentContainer=t},sap.basetable.crosstab.CrosstabContainers.prototype.getRowAxisContentContainer=function(){return this._rowAxisContentContainer},sap.basetable.crosstab.CrosstabContainers.prototype.setRowAxisContentContent=function(t){this._rowAxisContentContent=t},sap.basetable.crosstab.CrosstabContainers.prototype.getRowAxisContentContent=function(){return this._rowAxisContentContent},sap.basetable.crosstab.CrosstabContainers.prototype.setColumnHeaderContainer=function(t){this._columnHeaderContainer=t},sap.basetable.crosstab.CrosstabContainers.prototype.getColumnHeaderContainer=function(){return this._columnHeaderContainer},sap.basetable.crosstab.CrosstabContainers.prototype.setColumnHeaderContent=function(t){this._columnHeaderContent=t},sap.basetable.crosstab.CrosstabContainers.prototype.getColumnHeaderContent=function(){return this._columnHeaderContent},sap.basetable.crosstab.CrosstabContainers.prototype.setLeftAreaDimensionHeaderContainer=function(t){this._leftAreaDimensionHeaderContainer=t},sap.basetable.crosstab.CrosstabContainers.prototype.getLeftAreaDimensionHeaderContainer=function(){return this._leftAreaDimensionHeaderContainer},sap.basetable.crosstab.CrosstabContainers.prototype.setLeftAreaDimensionHeaderOuterContainer=function(t){this._leftAreaDimensionHeaderOuterContainer=t},sap.basetable.crosstab.CrosstabContainers.prototype.getLeftAreaDimensionHeaderOuterContainer=function(){return this._leftAreaDimensionHeaderOuterContainer},sap.basetable.crosstab.CrosstabContainers.prototype.setLeftAreaDimensionHeaderContent=function(t){this._leftAreaDimensionHeaderContent=t},sap.basetable.crosstab.CrosstabContainers.prototype.getLeftAreaDimensionHeaderContent=function(){return this._leftAreaDimensionHeaderContent},sap.basetable.crosstab.CrosstabContainers.prototype.setRowAxisFloatingHeaderContainer=function(t){this._rowAxisFloatingHeaderContainer=t},sap.basetable.crosstab.CrosstabContainers.prototype.getRowAxisFloatingHeaderContainer=function(){return this._rowAxisFloatingHeaderContainer},sap.basetable.crosstab.CrosstabContainers.prototype.setTopSectionContainer=function(t){this._topSectionContainer=t},sap.basetable.crosstab.CrosstabContainers.prototype.getTopSectionContainer=function(){return this._topSectionContainer},sap.basetable.crosstab.CrosstabContainers.prototype.setLayout=function(t){this._oLayout=t},sap.basetable.crosstab.CrosstabContainers.prototype.getLayout=function(){return this._oLayout},sap.basetable.crosstab.CrosstabContainers.prototype.setLeftAreaContainerWidth=function(t){this._leftAreaContainerWidth=t},sap.basetable.crosstab.CrosstabContainers.prototype.getLeftAreaContainerWidth=function(){return this._leftAreaContainerWidth},sap.basetable.crosstab.CrosstabContainers.prototype.setRightAreaContainerWidth=function(t){this._rightAreaContainerWidth=t},sap.basetable.crosstab.CrosstabContainers.prototype.getRightAreaContainerWidth=function(){return this._rightAreaContainerWidth},sap.basetable.crosstab.CrosstabContainers.prototype.getHorizontalScrollAreas=function(){var t={"bodyContainer":this._rowAxisContentContainer,"bodyContent":this._rowAxisContentContent,"headerContainer":this._columnHeaderContainer,"headerContent":this._columnHeaderContent,"floatingHeaders":null,"fullContainer":this._oLayout};return t},sap.basetable.crosstab.CrosstabContainers.prototype.getVerticalScrollAreas=function(){var t={"bodyContainer":this._rowAxisContentContainer,"bodyContent":this._rowAxisContentContent,"headerContainer":this._rowAxisHeaderContainer,"headerContent":this._rowAxisHeaderContent,"floatingHeaders":null,"fullContainer":this._oLayout};return t},sap.basetable.crosstab.CrosstabContainers.prototype.getRowAxisHeaderScrollAreas=function(){var t={"bodyContainer":this._rowAxisHeaderContainer,"bodyContent":this._rowAxisHeaderContent,"headerContainer":this._leftAreaDimensionHeaderContainer,"headerContent":this._leftAreaDimensionHeaderContent,"floatingHeaders":this._rowAxisFloatingHeaderContainer,"fullContainer":this._oLayout};return t},sap.basetable.crosstab.CrosstabContainers.prototype.replaceContainer=function(t,e){var s;if(e&&e[0]&&e[0].parentElement){var a=e[0].parentElement,r=e[0].nextSibling;e.detach(),s=t.replaceAll(e),r?a.insertBefore(s[0],r):a.appendChild(s[0])}else s=t.replaceAll(e);return s},jQuery.sap.declare("sap.basetable.crosstab.CrosstabDataProvider"),sap.basetable.crosstab.CrosstabDataProvider=function(t,e){this._dataChangeListeners=[],this._jsonData=t,this._feeding=t.feeding,this._consumptionModel=t.consumptionModel,this._measureMembers=[],this._dispatch=e;var s=this._jsonData.windowing?this._jsonData.windowing.pageSize:this._getPageSize();this._scrollPageManager=new sap.basetable.crosstab.ScrollPageManager(t,s,e,this),this._scrollPageManager.initialize(t),this._build()},sap.basetable.crosstab.CrosstabDataProvider.PATH_DELIMITER="|",sap.basetable.crosstab.CrosstabDataProvider.MEMBER_KEY_DELIMITER="&",sap.basetable.crosstab.CrosstabDataProvider.MINIMUM_PAGE_SIZE=100,sap.basetable.crosstab.CrosstabDataProvider.EXPORT_PAGE_SIZE=500,sap.basetable.crosstab.CrosstabDataProvider.prototype._getParameterValue=function(t){for(var e,s=window.location.search.split(/\?|\&/),a=0;s.length>a;++a){var r=s[a].split("=");if(r[0]===t){e=r[1];break}}return e},sap.basetable.crosstab.CrosstabDataProvider.prototype._getPageSize=function(){var t=this._getParameterValue("pageSize"),e=sap.basetable.crosstab.CrosstabDataProvider.MINIMUM_PAGE_SIZE;return t?e=Math.max(t,e):this._isExporting()&&(e=sap.basetable.crosstab.CrosstabDataProvider.EXPORT_PAGE_SIZE),e},sap.basetable.crosstab.CrosstabDataProvider.prototype._isExporting=function(){return this._getParameterValue("EXPORT_DIALOG_EXPORTING")||"true"===this._getParameterValue("export")},sap.basetable.crosstab.CrosstabDataProvider.prototype.addDataChangeListener=function(t){this._dataChangeListeners.push(t)},sap.basetable.crosstab.CrosstabDataProvider.prototype.updateData=function(){this._rebuild()},sap.basetable.crosstab.CrosstabDataProvider.prototype.getDimensions=function(){return this._dimensions},sap.basetable.crosstab.CrosstabDataProvider.prototype.getTupleTree=function(t){if(!this._tupleTree){var e={"rootnode":{"tuplePath":"","children":[]}};return e}return this._tupleTree[t]},sap.basetable.crosstab.CrosstabDataProvider.prototype.getPageSize=function(){return this._scrollPageManager.getPageSize()},sap.basetable.crosstab.CrosstabDataProvider.prototype.getFormatMap=function(){return this._formatMap},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildAxesValuesArray=function(t,e,s,a,r,o,i){var n,l,c,d,b,h;"row"===o?(n=t.dimAxes[a],l=e,c=a,d=t.dimAxes[r],b=s,h=r):"column"===o&&(n=t.dimAxes[r],l=s,c=r,d=t.dimAxes[a],b=e,h=a);for(var p=l?l.startIndexOffset:0,u=b?b.startIndexOffset:0,_=l?Math.max(0,l.endIndexOffset-(l.pageSize-n.values.length)):0,g=b?Math.max(0,b.endIndexOffset-(b.pageSize-d.values.length)):0,C=h?d.values.length-(u+g)-1:0,f=[],m=n?n.values.length-(p+_):1,v=0;m>v;++v)f[v]=[],f[v][C]=void 0;for(var x=t.valueAxes,S=0;x.length>S;++S){var y=x[S],P=y[i];if(P&&P.length>0){if(c&&(p>y[c]||y[c]>n.values.length-_-1)||h&&(u>y[h]||y[h]>d.values.length-g-1))continue;var T=c?y[c]-p:0,A=h?y[h]-u:0;f[T][A]=P}}return f},sap.basetable.crosstab.CrosstabDataProvider.prototype._getAppEntityNameByAttribute=function(t){var e="";if(this._jsonData.consumptionModel){var s=this._jsonData.consumptionModel.entities;s.forEach(function(s){if(s&&s.attributes)for(var a in s.attributes)t===a&&(e=s.caption)})}return e},sap.basetable.crosstab.CrosstabDataProvider.prototype._formatCalculationName=function(t,e){var s={"Running.Sum":"Running_Sum","Running.Min":"Running_Min","Running.Max":"Running_Max","Running.Count":"Running_Count","Running.Average":"Running_Avg","Moving.Average":"Moving_Avg","Percentage":"Percentage"},a=!1,r=s[t]||t;return e&&e.withEmpties&&(a="false"===e.withEmpties),a&&(r+="_NE"),r},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildMeasureAggregationTypeMap=function(t,e){var s={};if(t[e]&&t[e].components)for(var a=0;t[e].components.length>a;++a){var r=t[e].components[a];s[r.id]=r.aggregationType}else if(t.dataQuery&&t.dataQuery.dataSources)for(var o=0;t.dataQuery.dataSources.length>o;++o){var i=t.dataQuery.dataSources[o];if(i.entities)for(var n=0;i.entities.length>n;++n){var l=i.entities[n];"measure"===l.analyticType&&(s[l.refId]=l.aggregationType)}}return s},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildMeasuresInfo=function(t,e,s,a,r){var o={"members":[],"axisPosition":s,"containAggregationNone":!1},i=t.layout?t.layout:t;
if(e&&i[e]){var n=this._buildMeasureAggregationTypeMap(t,e),l=i[e].components;this._measureMembers=l;var c=0;l.forEach(function(t){var e={"id":t.id};if(a&&r)if("calculation"===t.analyticType)if(t.key&&t.key.calculation){var s=this._buildEntityIdCaptionMapFromConsumption(this._consumptionModel),i=s[t.key.calculation.measure];i===void 0&&(i=this._getAppEntityNameByAttribute(t.key.calculation.measure));var l=t.key.calculation.type,d=t.key.calculation.properties;e.caption=this._formatCalculationName(l,d)+": "+i}else e.caption=a[t.id],e.caption===void 0&&(e.caption=r[t.id]);else e.caption=a[t.id];o.containAggregationNone=o.containAggregationNone||"none"===n[t.id],"calculation"!==t.analyticType?(e.indexForSubTotal=c,c++):e.indexForSubTotal=-1,o.members.push(e)}.bind(this))}return o},sap.basetable.crosstab.CrosstabDataProvider.prototype.getMeasureMembers=function(){return this._measureMembers},sap.basetable.crosstab.CrosstabDataProvider.sanitizeMemberKey=function(t){var e;return e=void 0===t||null===t?"<<null>>":""===t?"<<empty>>":t},sap.basetable.crosstab.CrosstabDataProvider.sanitizeMemberValue=function(t){var e;return e=null===t?"":t},sap.basetable.crosstab.CrosstabDataProvider._buildMemberKey=function(t){var e=sap.basetable.crosstab.CrosstabDataProvider.sanitizeMemberKey(t.key);if(t.properties&&(t.properties.secondaryDistinctCount!==void 0&&(e+=sap.basetable.crosstab.CrosstabDataProvider.MEMBER_KEY_DELIMITER+(""+t.properties.secondaryDistinctCount)),t.properties.parentId!==void 0)){var s='"'+sap.basetable.crosstab.CrosstabDataProvider.sanitizeMemberKey(t.properties.parentId)+'"';e+=sap.basetable.crosstab.CrosstabDataProvider.MEMBER_KEY_DELIMITER+s}return e},sap.basetable.crosstab.CrosstabDataProvider.prototype._addChildNode=function(t,e,s,a,r,o){var i={"tuplePath":0===t.tuplePath.length?e:t.tuplePath+sap.basetable.crosstab.CrosstabDataProvider.PATH_DELIMITER+e,"member":{"id":s,"caption":a},"children":[]};return r&&(i.member.stackIndex=t.member?t.member.stackIndex+1:0),o&&(i.dataPoints=[]),t.children.push(i),i},sap.basetable.crosstab.CrosstabDataProvider.prototype._addChildMeasureNode=function(t,e,s,a,r,o){var i=this._addChildNode(t,e,s,a,r,o);return i.isMeasure=!0,i},sap.basetable.crosstab.CrosstabDataProvider.prototype._addEmptySubTotalNode=function(t,e,s){var a={"tuplePath":0===t.tuplePath.length?"":t.tuplePath+sap.basetable.crosstab.CrosstabDataProvider.PATH_DELIMITER+"","member":{"id":"","caption":""},"children":[],"isTotal":!0};return e&&(a.member.stackIndex=t.member?t.member.stackIndex+1:0),s&&(a.dataPoints=[]),t.children.push(a),a},sap.basetable.crosstab.CrosstabDataProvider.prototype._addSubTotalNode=function(t,e,s,a,r,o){var i=new sap.cvom.crosstabviewer.LanguageManager,n={"tuplePath":0===t.tuplePath.length?e:t.tuplePath+sap.basetable.crosstab.CrosstabDataProvider.PATH_DELIMITER+e,"member":{"id":e,"caption":i.get(this._getAggregationLabel(e)),"aggregationTarget":s},"children":[],"isTotal":!0};a&&(n.member.stackIndex=t.member?t.member.stackIndex+1:0),r&&(n.dataPoints=[]),t.children.push(n);for(var l=0;o>l;++l)n=this._addEmptySubTotalNode(n,a,r);return n},sap.basetable.crosstab.CrosstabDataProvider.prototype._addDataPoints=function(t,e,s,a,r,o,i){for(var n=t[i],l=0;n.length>l;++l){var c=n[l]?n[l][r]:"";e&&(this._addSubTotalValues(e,s,l,o,i),e.dataPoints.push(c),l===n.length-1&&this._addSubTotalValues(e,s,n.length,o,i)),a&&(a[l]||(a[l]=[]),a[l].push(c))}},sap.basetable.crosstab.CrosstabDataProvider.prototype._addSubTotalNodeDataPoints=function(t,e,s,a){for(var r=0;t.length>r;++r){var o=void 0===t[r]?"":t[r];e&&(this._addEmptySubTotalValues(e,s,r),e.dataPoints.push(o),r===t.length-1&&this._addEmptySubTotalValues(e,s,t.length)),a&&(a[r]||(a[r]=[]),a[r].push(o))}},sap.basetable.crosstab.CrosstabDataProvider.prototype._addFlattenSubTotalValues=function(t,e,s,a){for(var r in e)if(e.hasOwnProperty(r)){var o=e[r];for(var i in o)if(o.hasOwnProperty(i)){var n=o[i];for(var l in n)if(n.hasOwnProperty(l))for(var c=n[l].aggregations,d=0;c.length>d;++d){var b=c[d],h=t[l].aggregations[b.aggregation];0>s?h.push(""):h.push(b.values[s][a])}}}},sap.basetable.crosstab.CrosstabDataProvider.prototype._addEmptyFlattenSubTotalValues=function(t){for(var e in t)if(t.hasOwnProperty(e)){var s=t[e].aggregations;for(var a in s)s.hasOwnProperty(a)&&s[a].push("")}},sap.basetable.crosstab.CrosstabDataProvider.prototype._addSubTotalValues=function(t,e,s,a,r){var o=e[s];if(void 0!==o)for(var i=o.length-1;i>=0;--i){var n=o[i];if(void 0!==n)for(var l in n)if(n.hasOwnProperty(l))for(var c=n[l],d=0;c.aggregations.length>d;++d){var b="",h=c.aggregations[d].values[a];h&&void 0!==h[r]&&(b=h[r]),t.dataPoints.push(b)}}},sap.basetable.crosstab.CrosstabDataProvider.prototype._addEmptySubTotalValues=function(t,e,s){var a=e[s];if(void 0!==a)for(var r=a.length-1;r>=0;--r){var o=a[r];if(void 0!==o)for(var i in o)if(o.hasOwnProperty(i))for(var n=o[i],l=0;n.aggregations.length>l;++l)t.dataPoints.push("")}},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildAxisTupleTree=function(t,e,s,a,r,o,i,n,l,c){var d,b={"rootnode":{"tuplePath":"","children":[]}},h=b.rootnode;if(e){var p,u=t.dimAxes[e],_=[];if(n)for(d in n)if(n.hasOwnProperty(d)){var g=n[d];p=g.level;var C=_[p];void 0===C&&(C={},_[p]=C),C[d]=[h]}for(var f=l?l.startIndexOffset:0,m=l?Math.max(0,l.endIndexOffset-(l.pageSize-u.values.length)):0,v=f,x=u.values.length-m;x>v;++v){for(var S=h,y=u.values[v],P=y.length,T=0;P>T;++T){S.numOfLeafChildren=S.numOfLeafChildren?S.numOfLeafChildren+1:1;var A=S.children[S.children.length-1],I=T,R=y[I],w=sap.basetable.crosstab.CrosstabDataProvider._buildMemberKey(t.metadata.dictionary[e][I].value[R]);o&&o.containAggregationNone&&T==P-1&&(w=w+"_"+v);var H=sap.basetable.crosstab.CrosstabDataProvider.sanitizeMemberValue(t.metadata.dictionary[e][I].value[R].attributes.value[0]);if(A&&A.member.id===w&&A.member.caption===H)S=A;else{var E=sap.basetable.crosstab.CrosstabDataProvider._buildMemberKey(t.metadata.dictionary[e][I].value[R]);S=this._addChildNode(S,E,w,H,s,r)}if(n){var M=this._buildTuplePath(t,e,y,I);for(d in n)if(this._containsTuplePath(d,M)){p=n[d].level;var D=_[p][d];D[T+1]=S}}r&&i&&T===P-1&&(S.dataPoints=i[v-f])}if(n)for(var B=u.values[v+1],z=this._buildTuplePath(t,e,B),L=_.length-1;L>=0;--L){var O=_[L];if(void 0!==O)for(var N in O)if(O.hasOwnProperty(N)){p=n[N].level;var F=p+1;if(void 0!==O[N]&&O[N].length===F&&(null===z&&c||null!==z&&!this._containsTuplePath(z,N))){var W=O[N],U=W[W.length-1],V=n[N].aggregations;for(var q in V)if(V.hasOwnProperty(q)){for(var $=0;W.length>$;++$)W[$].numOfLeafChildren++;var k=t.metadata.dictionary[e].length-W.length,j=this._addSubTotalNode(U,q,null,s,r,k);r&&(j.dataPoints=n[N].aggregations[q])}O[N]=[h]}}}}}else r&&i&&(h.dataPoints=i[0]);return b},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildMeasureAxisTupleTree=function(t,e,s,a,r,o,i,n,l,c,d,b,h){var p={"rootnode":{"tuplePath":"","children":[]}},u=p.rootnode;if(e){var _,g=t.dimAxes[e],C=b?b.measureStartIndex:0,f=b?b.measureEndIndex:o.members.length-1,m=d?d.startIndexOffset:0,v=null,x=[];for(var S in l)if(l.hasOwnProperty(S)){var y=l[S];_=y.level;var P=x[_];void 0===P&&(P={},x[_]=P),P[S]=[u]}for(var T=d?d.startIndexOffset:0,A=d?Math.max(0,d.endIndexOffset-(d.pageSize-g.values.length)):0,I=T,R=g.values.length-A;R>I;){var w=u,H=g.values[I],E=H.length+1,M=-1;o.members&&o.members.length>C&&(M=o.members[C].indexForSubTotal);for(var D,B=0;E>B;++B){D=w;var z=w.children[w.children.length-1],L=o.axisPosition===B&&o.members.length>0,O=B>=o.axisPosition?B-1:B,N=H[O],F=L?o.members[C].id:sap.basetable.crosstab.CrosstabDataProvider._buildMemberKey(t.metadata.dictionary[e][O].value[N]);o.containAggregationNone&&B==E-1&&(F=F+"_"+I);var W=L?o.members[C].caption:sap.basetable.crosstab.CrosstabDataProvider.sanitizeMemberValue(t.metadata.dictionary[e][O].value[N].attributes.value[0]);if(z&&z.member.id===F&&z.member.caption===W)w=z;else{L&&(v=w);var U=L?o.members[C].caption:sap.basetable.crosstab.CrosstabDataProvider._buildMemberKey(t.metadata.dictionary[e][O].value[N]);w=L?this._addChildMeasureNode(w,U,F,W,s,r):this._addChildNode(w,U,F,W,s,r)}D.numOfLeafChildren=D.numOfLeafChildren?D.numOfLeafChildren+1:1;var V=this._buildTuplePath(t,e,H,O);if(M>=0)for(var q in l)if(this._containsTuplePath(q,V)){_=l[q].level;var $=o.axisPosition>_?_:_+1;if($>B){var k=x[_][q];k[B+1]=w}}(r||i)&&B===E-1&&this._addDataPoints(a,r?w:null,c,i,C,M,I-T)}n&&this._addFlattenSubTotalValues(n,c,M,I-T);for(var j,G,X,Y,Q,K,Z,J,te,ee=g.values[I+1],se=this._buildTuplePath(t,e,ee),ae=x.length-1;ae>=0;--ae){var re=x[ae];if(void 0!==re)for(var oe in re)if(re.hasOwnProperty(oe)){_=l[oe].level;var ie=_>=o.axisPosition?_+2:_+1;if(void 0!==re[oe]&&re[oe].length===ie&&(null===se&&h||null!==se&&!this._containsTuplePath(se,oe)))if(o.axisPosition>_){if(C===o.members.length-1){for(j=l[oe].aggregations,X=0;j.length>X;++X){G=j[X],K=re[oe];for(var ne=0;o.members.length>ne;++ne){var le=o.members[ne].indexForSubTotal;if(le>=0&&(Q=G.values[le],Y=o.members[ne],Q)){for(Z=0;K.length>Z;++Z)K[Z].numOfLeafChildren++;D=K[K.length-1],J=t.metadata.dictionary[e].length-K.length+1,te=this._addSubTotalNode(D,G.aggregation,Y,s,r,J),(r||i)&&this._addSubTotalNodeDataPoints(Q,r?te:null,c,i),n&&this._addEmptyFlattenSubTotalValues(n)}}}re[oe]=[u]}}else if(M>=0){for(j=l[oe].aggregations,X=0;j.length>X;++X)if(G=j[X],Y=o.members[C],K=re[oe],Q=G.values[M]){for(Z=0;K.length>Z;++Z)K[Z].numOfLeafChildren++;D=K[K.length-1],J=t.metadata.dictionary[e].length-K.length+1,te=this._addSubTotalNode(D,G.aggregation,Y,s,r,J),(r||i)&&this._addSubTotalNodeDataPoints(Q,r?te:null,c,i),n&&this._addEmptyFlattenSubTotalValues(n)}re[oe]=[u]}}}if(ee){for(var ce=o.axisPosition-1,de=!0,be=0;ce>=be;++be)if(H[be]!==ee[be]){de=!1;break}if(!de){if(C!==o.members.length-1){C++,I=m;continue}C=0,m=I+1}}else if(f&&f>C){C++,I=m;continue}I++}}else{for(var he=0;o.members.length>he;++he){var pe=o.members[he],ue=this._addChildMeasureNode(u,pe.caption,pe.id,pe.caption,s,r);(r||i)&&this._addDataPoints(a,r?ue:null,c,i,he,pe.indexForSubTotal,0),n&&this._addFlattenSubTotalValues(n,c,pe.indexForSubTotal,0)}u.numOfLeafChildren=o.members.length}return p},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildFlattenSubtotalValues=function(t,e){var s=e?e:{};for(var a in t)if(t.hasOwnProperty(a)){var r=t[a];if(r)for(var o=0;r.length>o;++o){var i=r[o];if(i)for(var n in i)if(i.hasOwnProperty(n)){s[n]={"level":o,"aggregations":{}};for(var l=i[n].aggregations,c=0;l.length>c;++c){var d=l[c];s[n].aggregations[d.aggregation]=[]}}}}return s},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildTupleTrees=function(t,e,s,a,r,o,i,n,l,c,d,b,h,p){var u,_,g,C=c?c[r]:null,f=c?c[o]:null,m=b?b[r]:null,v=b?b[o]:null;if("row"===i||"column"===i){var x=this._buildAxesValuesArray(e,C,f,r,o,i,n),S=this._buildMeasuresInfo(t,n,l,s,a),y="row"===i?r:o,P="row"===i?o:r,T=c?c[y]:null,A=c?c[P]:null,I="row"===i?h:p,R=this._buildMeasureAxisSubTotalTuples(t,e,y,A,P,n),w=b?b[P]:null,H="row"===i?p:h,E=this._buildAxisSubTotalTuples(t,e,A,w,P,T,y,n,H);if(g=this._buildFlattenSubtotalValues(E),"row"===i)u=this._buildMeasureAxisTupleTree(e,r,!1,x,!0,S,null,g,R,E,C,d,I),_=this._buildAxisTupleTree(e,o,!0,null,!1,S,null,g,f,H);else{var M=[];_=this._buildMeasureAxisTupleTree(e,o,!0,x,!1,S,M,g,R,E,f,d,I),u=this._buildAxisTupleTree(e,r,!1,null,!0,S,M,g,C,H)}}else{var D=this._buildAxisSubTotalTuples(t,e,C,m,r,f,o,n,h);g=this._buildFlattenSubtotalValues(D),u=this._buildAxisTupleTree(e,r,!1,null,!0,null,null,g,C,h);var B=this._buildAxisSubTotalTuples(t,e,f,v,o,C,r,n,p);g=this._buildFlattenSubtotalValues(B),_=this._buildAxisTupleTree(e,o,!0,null,!1,null,null,g,f,p)}return[u,_]},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildAxisDimensions=function(t,e,s,a){for(var r=new sap.cvom.crosstabviewer.LanguageManager,o={"dimensions":[]},i=t.metadata.dictionary[s],n=0;i&&i.length>n;++n){var l=i[n].id,c={"id":l,"caption":e[l]};o.dimensions.push(c)}if(null!==a){var d={"id":"MeasureNamesDimension","caption":r.get("XTAB_MEASURE_AXIS_TITLE")};o.dimensions.splice(a,0,d)}return o},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildAxesDimensions=function(t,e,s,a,r,o){var i="row"===r?o:null,n=this._buildAxisDimensions(t,e,s,i),l="column"===r?o:null,c=this._buildAxisDimensions(t,e,a,l);return[n,c]},sap.basetable.crosstab.CrosstabDataProvider.prototype._findAxisName=function(t,e){var s=null;if(e.length>0){var a=t.dimAxes;for(var r in a)if(a.hasOwnProperty(r)){for(var o=t.metadata.dictionary[r],i=[],n=0;o.length>n;++n)i.push(o[n].id);if(e.length===i.length){s=r;for(var l=0;e.length>l;++l)if(-1===i.indexOf(e[l])){s=null;break}}if(null!==s)break}}return s},sap.basetable.crosstab.CrosstabDataProvider.prototype._findMeasureGroupName=function(t){var e=null;if(t){var s=t.layout?t.layout:t;for(var a in s)if(s.hasOwnProperty(a)&&"numerical"===s[a].axisType){e=a;break}}return e},sap.basetable.crosstab.CrosstabDataProvider.prototype._getAggregationTypes=function(t,e,s){for(var a=[],r=t.layout?t.layout:t,o=r[e].calculations,i=0;o.length>i;++i)if(o[i].id===s){for(var n=0;o[i].definitions.length>n;++n)a.push(o[i].definitions[n].aggregationType);break}return a},sap.basetable.crosstab.CrosstabDataProvider.prototype._getAggregationLabel=function(t){var e=null;switch(t.toLowerCase()){case"default":e="XTAB_SUBTOTAL_LABEL_TOTAL";break;case"sum":e="XTAB_SUBTOTAL_LABEL_SUM";break;case"count":e="XTAB_SUBTOTAL_LABEL_COUNT";break;case"average":e="XTAB_SUBTOTAL_LABEL_AVERAGE";break;case"min":e="XTAB_SUBTOTAL_LABEL_MIN";break;case"max":e="XTAB_SUBTOTAL_LABEL_MAX";break;default:}return e},sap.basetable.crosstab.CrosstabDataProvider.prototype._getMeasureIndices=function(t,e,s,a){var r=[],o=[],i=t.layout?t.layout:t;if(a&&i[a]){var n=i[a].components;n.forEach(function(t){var e=t.analyticType;"calculation"!==e&&o.push(t.id)})}for(var l=t.layout?t.layout:t,c=l[e].calculations,d=0;c.length>d;++d)if(c[d].id===s){for(var b=0;c[d].target.length>b;++b){var h=c[d].target[b].id,p=o.indexOf(h);r.push(p)}break}return r},sap.basetable.crosstab.CrosstabDataProvider.prototype._coordsStartsWith=function(t,e){for(var s=!0,a=0;e.length>a;++a)if(t[a]!==e[a]){s=!1;break}return s},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildTuplePath=function(t,e,s,a){var r=null;if(s){r="";for(var o=void 0===a?s.length:a+1,i=0;o>i;++i){var n=s[i];r.length>0&&(r+=sap.basetable.crosstab.CrosstabDataProvider.PATH_DELIMITER),r+=sap.basetable.crosstab.CrosstabDataProvider._buildMemberKey(t.metadata.dictionary[e][i].value[n])}}return r},sap.basetable.crosstab.CrosstabDataProvider.prototype._containsTuplePath=function(t,e){if(void 0!==t&&void 0!==e){if(t===e||0===e.length)return!0;if(0!==t.indexOf(e))return!1;var s=t.split(sap.basetable.crosstab.CrosstabDataProvider.PATH_DELIMITER),a=e.split(sap.basetable.crosstab.CrosstabDataProvider.PATH_DELIMITER);if(s.length>=a.length){for(var r=0;a.length>r;r++)if(a[r]!==s[r])return!1;return!0}}return!1},sap.basetable.crosstab.CrosstabDataProvider.prototype._findSubtotalAxisIndex=function(t,e,s,a,r,o,i){var n=null,l=t.dimAxes[a].values.length;if(void 0===r||0===r.length)o?null===e||null===s?n=l:(e.page+1)*e.pageSize-e.endIndexOffset>=s&&(n=l):null===e||null===s?n=0:0===e.page+e.startIndexOffset&&(n=0);else if(o)for(var c=0,d=e?e.startIndexOffset:0,b=e?Math.max(0,e.endIndexOffset-(e.pageSize-l)):0,h=d;l-b>h;++h){var p=t.dimAxes[a].values[h],u=t.dimAxes[a].values[h+1];if(this._coordsStartsWith(p,r)&&(void 0===u&&i||void 0!==u&&!this._coordsStartsWith(u,r))){n=c+1;break}c++}return n},sap.basetable.crosstab.CrosstabDataProvider.prototype._coordsEqual=function(t,e){var s=!0;if(t.length===e.length){for(var a=0;t.length>a;++a)if(t[a]!==e[a]){s=!1;break}}else s=!1;return s},sap.basetable.crosstab.CrosstabDataProvider.prototype._addAggregationValues=function(t,e,s,a,r,o,i){for(var n=0;o.length>n;++n){for(var l=o[n],c=null,d=0;e.length>d;++d)if(e[d].aggregation===l){c=e[d];break}null===c&&(c={"aggregation":l,"values":[]},e.push(c));for(var b=a?a.startIndexOffset:0,h=a?Math.max(0,a.endIndexOffset-(a.pageSize-t.dimAxes[r].values.length)):0,p=0;i.length>p;++p){var u=i[p],_=c.values[u];if(void 0===_){_=[];var g;g=null===r?1:t.dimAxes[r].values.length-(b+h),_[g-1]=void 0,c.values[u]=_}if(null===r)_[0]=s.values[n][u];else for(var C=s.window[r],f=t.dimAxes[r].values,m=0,v=b;f.length-h>v;++v){if(this._coordsEqual(f[v],C)){(void 0===_[m]||null===_[m])&&(_[m]=s.values[n][u]);break}m++}}}return e},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildAxisSubTotalTuples=function(t,e,s,a,r,o,i,n,l){var c=[],d=e.calculations;if(d){var b=d[r];if(b)for(var h=0;b.length>h;++h)for(var p=b[h],u=this._getAggregationTypes(t,r,p.id),_=this._getMeasureIndices(t,r,p.id,n),g=0;p.values.length>g;++g){var C=p.values[g],f=C.window[r]?C.window[r]:[],m=this._findSubtotalAxisIndex(e,s,a,r,f,!0,l);if(null!==m){var v=c[m];void 0===v&&(v=[],c[m]=v);var x=f.length,S=v[x];void 0===S&&(S={},v[x]=S);var y=this._buildTuplePath(e,r,f),P=S[y];void 0===P&&(P={"aggregations":[]},S[y]=P),this._addAggregationValues(e,P.aggregations,C,o,i,u,_)}}}return c},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildMeasureAxisSubTotalTuples=function(t,e,s,a,r,o){var i={},n=e.calculations;if(n){var l=n[s];if(l)for(var c=0;l.length>c;++c)for(var d=l[c],b=this._getAggregationTypes(t,s,d.id),h=this._getMeasureIndices(t,s,d.id,o),p=0;d.values.length>p;++p){var u=d.values[p],_=u.window[s]?u.window[s]:[],g=i,C=this._buildTuplePath(e,s,_),f=g[C];void 0===f&&(f={"level":_.length,"aggregations":[]},g[C]=f),this._addAggregationValues(e,f.aggregations,u,a,r,b,h)}}return i},sap.basetable.crosstab.CrosstabDataProvider.prototype._processAxisFeeding=function(t){for(var e=null,s=0,a=[],r=0,o=0;t.length>o;++o){var i=t[o];if("dimension"===i.type)a.push(i.id);else if("hierarchy"===i.type){for(var n=0;i.levels.length>n;n++){var l=i.levels[n];if(a.push(l.id),r++,l.selected)break}r-=1}else"measure"===i.type&&(s++,null===e&&(e=o+r))}var c={"measureAxisPosition":e,"numMeasures":s,"dimensionIdArray":a};return c},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildEntityIdCaptionMapFromConsumption=function(t){var e={};if(t){for(var s=0;t.entities.length>s;++s){var a=t.entities[s];e[a.id]=a.caption}if(t.userHierarchies)for(var r=0;t.userHierarchies.length>r;++r)if(t.userHierarchies[r].levels)for(var o=0;t.userHierarchies[r].levels.length>o;++o){var i=t.userHierarchies[r].levels[o];e[i.id]=i.caption}}return e},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildEntityIdCaptionMap=function(t){var e={};if(t){var s=function(t){e[t.id]=t.name,"hierarchy"===t.type&&t.levels&&t.levels.forEach(function(t){e[t.id]=t.name}.bind(this))}.bind(this);t.cols.forEach(s),t.rows.forEach(s),t.values.forEach(s)}return e},sap.basetable.crosstab.CrosstabDataProvider.prototype.buildMeasureIdCaptionMap=function(t){var e={};if(t)for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s].name);return e},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildFormatMap=function(){var t={};if(this._measureMembers&&this._measureMembers.length>0){var e=this._jsonData.formatArr,s=sap.basetable.crosstab.utils.FormatUtils.createFormatArray(e);if(s&&s.length>0)for(var a=0,r=0;this._measureMembers.length>r;r++){var o=this._measureMembers[r];t[o.id]=s[a],a++}}return t},sap.basetable.crosstab.CrosstabDataProvider.prototype._build=function(){var t=null,e=null,s=this._processAxisFeeding(this._feeding.cols),a=s.dimensionIdArray;null!==s.measureAxisPosition&&(t="column",e=s.measureAxisPosition),s=this._processAxisFeeding(this._feeding.rows);var r=s.dimensionIdArray;null===t&&null!==s.measureAxisPosition&&(t="row",e=s.measureAxisPosition);var o=this._jsonData.queryResponse[0],i=this._findAxisName(o,a),n=this._findAxisName(o,r),l=this._buildEntityIdCaptionMap(this._jsonData.feeding),c=this._scrollPageManager.getPageSize(),d=this._jsonData.windowing?this._jsonData.windowing.pages[0].rowPageIndex:0,b=this._jsonData.windowing?this._jsonData.windowing.pages[0].columnPageIndex:0,h={"startRowIndex":d*c,"startColumnIndex":b*c};h.endRowIndex=h.startRowIndex+(c-1),h.endColumnIndex=h.startColumnIndex+(c-1),this._scrollPageManager.fetchViewPage(h,this),this._dimensions=this._buildAxesDimensions(o,l,n,i,t,e),this._formatMap=this._buildFormatMap(t),this._rowHeadersDirty=!0,this._columnHeadersDirty=!0,this._cellsDirty=!0},sap.basetable.crosstab.CrosstabDataProvider.prototype._rebuild=function(){this._rowHeadersDirty=!0,this._columnHeadersDirty=!0,this._cellsDirty=!0,this._notifyDataChangeListeners()},sap.basetable.crosstab.CrosstabDataProvider.prototype._notifyDataChangeListeners=function(){this._dataChangeListeners.forEach(function(t){t.dataChanged(this)})},sap.basetable.crosstab.CrosstabDataProvider.prototype.setTupleTrees=function(t,e){this._tupleTree=e},sap.basetable.crosstab.CrosstabDataProvider.prototype.initializeAxesMetadata=function(){this._scrollPageManager.initializeAxesMetadata()},sap.basetable.crosstab.CrosstabDataProvider.prototype.updateAxesMetadata=function(t,e){this._scrollPageManager.updateAxesMetadata(t,e)},sap.basetable.crosstab.CrosstabDataProvider.prototype._addPage=function(t,e,s){this._scrollPageManager.addPage(t,e,s)},sap.basetable.crosstab.CrosstabDataProvider.prototype._fetchViewPage=function(t,e){this._scrollPageManager.fetchViewPage(t,e)},sap.basetable.crosstab.CrosstabDataProvider.prototype.getFullAxisLength=function(t){return this._scrollPageManager.getFullAxisLength(t)},sap.basetable.crosstab.CrosstabDataProvider.prototype.elementsResized=function(t){this._dispatch.crosstableElementsResized({"crosstab":{"resizedElements":t}}),this._dispatch.initialized()},jQuery.sap.declare("sap.basetable.crosstab.CrosstabElementResizedEventConstants"),sap.basetable.crosstab.CrosstabElementResizedEventConstants=function(){var t={};return t.elementResizedEvent="elementResizedEvent",t.columnDimensionWidth="COLUMN_DIMENSION_WIDTH",t.rowDimensionWidth="ROW_DIMENSION_WIDTH",t.emptyColumnDimension="__:__",Object.freeze(t)},jQuery.sap.declare("sap.basetable.crosstab.CrosstabElementResizeHandler"),sap.basetable.crosstab.CrosstabElementResizeHandler=function(t,e,s,a){this._crosstab=t,this._model=e,this._renderer=s,this._crosstabElementResizedEventConstants=a},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype={"_inResizingState":!1},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype.getResizedState=function(){return this._inResizingState},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype.addResizeListener=function(){var t=this._crosstab.container().closest(".sapUI5Crosstab");t.unbind("mousedown"),t.mousedown(this._startResize.bind(this)),t.unbind("mouseup"),t.mouseup(this._stopResize.bind(this)),window.TouchEvent&&!sap.ui.Device.browser.internet_explorer&&this._setResizeListenerToTouch(t),sap.ui.Device.browser.internet_explorer&&window.navigator.msPointerEnabled&&this._setResizeListenerToPointer(t)},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype._setResizeListenerToTouch=function(t){t.unbind("touchstart touchmove touchend contextmenu"),t.bind("touchstart touchmove touchend contextmenu",this._handleResizeTouch.bind(this))},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype._setResizeListenerToPointer=function(t){t.unbind("pointerdown pointerup pointermove contextmenu"),t.bind("pointerdown pointerup pointermove contextmenu",this._handleResizeTouch.bind(this))},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype._handleResizeTouch=function(t){var e=$(t.target);if(e.hasClass("crosstab-resizable")){t.preventDefault(),t.stopPropagation();var s;switch(t.type){case"contextmenu":return;case"touchstart":case"pointerdown":s="mousedown";break;case"touchmove":case"pointermove":s="mousemove";break;case"touchend":case"pointerup":s="mouseup";break;default:return}var a=document.createEvent("MouseEvent");if(sap.ui.Device.browser.internet_explorer)a.initMouseEvent(s,!0,!0,window,1,t.originalEvent.screenX,t.originalEvent.screenY,t.originalEvent.clientX,t.originalEvent.clientY,!1,!1,!1,!1,0,null);else{var r=t.changedTouches[0];a.initMouseEvent(s,!0,!0,window,1,r.screenX,r.screenY,r.clientX,r.clientY,!1,!1,!1,!1,0,null),e=r.target}e.dispatchEvent(a)}},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype._startResize=function(t){var e=$(t.target);if(e.hasClass("crosstab-resizable")){this._inResizingState=!0;var s=e.parent(),a=t.clientX,r=s.attr("id"),o=r.split("_");this._columnResizingData={"originalStartPoint":a,"target":s,"treePathToCell":o},this._createVisualLineForResize(a,s)}},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype._handleResize=function(t,e){e.preventDefault(),e.stopPropagation();var s=$("#crosstab-resizable-line");s.css("left",(e.pageX-t)/this._crosstab.getScaleFactor())},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype._stopResize=function(t){var e=$("#crosstab-resizable-line");if(e.length&&(e.remove(),$(".sapUI5Crosstab").unbind("mousemove")),this._columnResizingData){var s,a=t.clientX,r=this._columnResizingData.originalStartPoint&&a?a-this._columnResizingData.originalStartPoint:"",o=this._columnResizingData.target.width()+r,i=this._crosstab.container();if(Math.abs(r)>2&&i&&i.has(this._columnResizingData.target).length&&(o=Math.floor(Math.max(this._renderer.MINIMUM_RESIZED_CELL_WIDTH,o)),s=this._createTreePathToCell(this._columnResizingData.treePathToCell,o),this._model.elementsResized(s)),this._columnResizingData=null,sap.ui.Device.browser.internet_explorer){var n=i.find(".crosstab-resizable");n.removeClass("crosstab-resizable"),setTimeout(function(){n.addClass("crosstab-resizable")},100)}this._inResizingState=!1}},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype._createVisualLineForResize=function(t,e){var s=e.closest(".sapUI5Crosstab"),a="crosstab-resizable-line",r=this._setParametersForVisualLine(e,s,t),o=$(document.createElement("div"));jQuery("#crosstab-resizable-line").remove(),o.attr("id",a),o.css({"height":r.height+"px","line-height":r.height+"px","left":r.left+"px","top":r.top+"px"}),s.append(o),s.mousemove(this._handleResize.bind(this,r.offsetLeft))},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype._setParametersForVisualLine=function(t,e,s){var a,r=e.find("#crosstabLayout"),o=e.find("#crosstabScrollContainer"),i=Math.max(r.height(),o.height()),n=parseInt(o.css("border-top-width"),10),l=i+n,c=n,d=e.offset().left,b=this._crosstab.getScaleFactor();return(t.closest("#rowAxisContent-Container").length||t.closest("#columnHeader-Container").length)&&(a=e.find("#colDimRow"),a.length&&(c=(a.offset().top-e.offset().top)/b)),l-=c,{"top":c,"height":l,"offsetLeft":d,"left":(s-d)/b}},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype._createTreePathToCell=function(t,e){var s;if(t.length)switch(s=this._treePathToCellHelper(t[0])){case"RowAxisheaderCell":return{"type":this._crosstabElementResizedEventConstants.rowDimensionWidth,"index":t.length-2,"width":e};case"dataCell":return{"type":this._crosstabElementResizedEventConstants.columnDimensionWidth,"index":parseInt(t[t.length-1]),"width":e};case"ColumnMemberHeaderCell":return{"type":this._crosstabElementResizedEventConstants.columnDimensionWidth,"tupleIndex":t.slice(1,t.length),"width":e};default:return{"type":this._crosstabElementResizedEventConstants.rowDimensionWidth,"dimensionId":s+this._createTreePathId(t),"width":e}}},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype._createTreePathId=function(t){for(var e="",s=1;t.length>s;s++)e=e+"_"+t[s];return e},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype._treePathToCellHelper=function(t){var e=t.replace("#","");return-1!==e.indexOf("ui5crosstab")||-1!==e.indexOf("Crosstab")?(e=e.split("-"),e[1]):e},jQuery.sap.declare("sap.basetable.crosstab.CrosstabDataModel"),sap.basetable.crosstab.CrosstabModel=function(t,e,s,a,r){this._crosstab=e,this._crosstabScrollBarEventMediator=s,this._crosstabScrollBarEventConstants=a,this._crosstabElementResizedEventConstants=r,this._rowAxisLength=null,this._columnAxisLength=null,this._currentVerticalPosition=0,this._currentHorizontalPosition=0,this._recentPageData={"redrawRowAxisHeader":null,"redrawRowAxisContent":null,"redrawColumnHeader":null,"coordinates":{"startRowIndex":0,"startColumnIndex":0,"endRowIndex":0,"endColumnIndex":0}},this._cellGroup=[],this._dimensionHeaderTemplates=[],this._tupleTrees=[],this._tupleMap=[],this._resizedElements=[{},{}],this._measuresPosition={"axis":null,"level":null},t.dataProvider&&(this._dataProvider=t.dataProvider,this._tupleTrees[0]=this._dataProvider.getTupleTree(0),this._tupleTrees[1]=this._dataProvider.getTupleTree(1),this._buildTupleMap(),this._currentCoordinates=[{"rowAxisIndex":0,"columnAxisIndex":0},{"rowAxisIndex":this.getPageSize(),"columnAxisIndex":this.getPageSize()}]),this._isCellJustResized=!1,this._crosstabConstants=new sap.basetable.crosstab.CrosstabConstants},sap.basetable.crosstab.CrosstabModel.prototype._initializeRecentPageData=function(){this._recentPageData.coordinates.endRowIndex=this.getPageSize()-1,this._recentPageData.coordinates.endColumnIndex=this.getPageSize()-1},sap.basetable.crosstab.CrosstabModel.prototype.getDimensions=function(t){return this._dataProvider.getDimensions()[t].dimensions},sap.basetable.crosstab.CrosstabModel.prototype.getTupleTree=function(t){return this._tupleTrees[t]},sap.basetable.crosstab.CrosstabModel.prototype.getResizedElements=function(t){return this._resizedElements.length>t?this._resizedElements[t]:void 0},sap.basetable.crosstab.CrosstabModel.prototype.setResizedElements=function(t){t&&2===t.length&&"object"==typeof t[0]&&"object"==typeof t[1]||(t=[{},{}]),this._resizedElements=t},sap.basetable.crosstab.CrosstabModel.prototype.elementsResized=function(t){if(t&&t.type){switch(t.type){case this._crosstabElementResizedEventConstants.columnDimensionWidth:var e=null;if("tupleIndex"in t){for(var s=this._tupleTrees[1].rootnode,a=0;t.tupleIndex.length>a;a++){var r=t.tupleIndex[a];s=s.children[r]}e=""+s.tuplePath}else if("index"in t){var o=this._dataProvider.getDimensions()[1].dimensions.length;if(0===o)e=this._crosstabElementResizedEventConstants.emptyColumnDimension;else for(var i in this._tupleMap[1])if(2===this._tupleMap[1][i].length&&this._tupleMap[1][i][0]===t.index&&this._tupleMap[1][i][1]===t.index+1&&this.getTupleDepth(i)===o&&":"!==i){e=i;break}}e&&(this._resizedElements[0][e]=t.width);break;case this._crosstabElementResizedEventConstants.rowDimensionWidth:var n;if("dimensionId"in t)n=t.dimensionId;else{var l=this.getDimensions(0);n=l[t.index].id}this._resizedElements[1][n]=t.width;break;default:throw Error("Event type "+t.type+" not supported!")}this._isCellJustResized=!0,this._dataProvider.elementsResized(this._resizedElements)}},sap.basetable.crosstab.CrosstabModel.prototype.getTupleDepth=function(t){var e=!1,s=0;if(t){for(var a=0;t.length>=a;a++){var r=t.charAt(a);if('"'===r)e=!e;else if("|"!==r||e){if("\\"===r){a++;continue}}else s++}return s+1}},sap.basetable.crosstab.CrosstabModel.prototype.getDataCells=function(t,e,s){return this._dataProvider.getDataCells(t,e,s)},sap.basetable.crosstab.CrosstabModel.prototype.getCellGroups=function(){return this._cellGroup},sap.basetable.crosstab.CrosstabModel.prototype.getMeasuresPosition=function(){if(!$.isEmptyObject(this._measuresPosition)){for(var t=this.getDimensions(0),e=this.getDimensions(1),s=0;e.length>s;s++)if("MeasureNamesDimension"===e[s].id){this._measuresPosition.axis="column",this._measuresPosition.level=s;break}if("column"!==this._measuresPosition.axis)for(var a=0;t.length>a;a++)if("MeasureNamesDimension"===t[a].id){this._measuresPosition.axis="row",this._measuresPosition.level=a;break}}return this._measuresPosition},sap.basetable.crosstab.CrosstabModel.prototype.select=function(t,e,s){var a=this._cellGroup.length,r=new sap.basetable.crosstab.CellGroup(this,a,t,e,s);return this._cellGroup.push(r),r},sap.basetable.crosstab.CrosstabModel.prototype.setDataProvider=function(t){this._dataProvider=t,this._initializeRecentPageData(),this._rebuild()
},sap.basetable.crosstab.CrosstabModel.prototype.getMeasureMembers=function(){return this._dataProvider.getMeasureMembers()},sap.basetable.crosstab.CrosstabModel.prototype.createDimensionHeaderTemplate=function(t){var e=this._dimensionHeaderTemplates.length;t.id=e;var s=new sap.basetable.crosstab.DimensionHeaderTemplate(t);this._dimensionHeaderTemplates.push(s)},sap.basetable.crosstab.CrosstabModel.prototype.getDimensionHeaderTemplate=function(t){return this._dimensionHeaderTemplates.forEach(function(e){return t===e.dimensionId||""===t?e.cellTemplate:void 0}),null},sap.basetable.crosstab.CrosstabModel.prototype.getTupleIndex=function(t,e){return this._tupleMap[t][e]},sap.basetable.crosstab.CrosstabModel.prototype.getNumberOfTuples=function(t){return this._tupleTrees[t].rootnode.numOfLeafChildren},sap.basetable.crosstab.CrosstabModel.prototype.addTuplePath=function(t,e,s){for(var a=0;e.children.length>a;a++){var r=e.children[a],o=r.tuplePath,i=r.numOfLeafChildren?r.numOfLeafChildren:1;this._tupleMap[t][o]=[s,s+i],r.children.length>0?s=this.addTuplePath(t,r,s):s++}return s},sap.basetable.crosstab.CrosstabModel.prototype._buildTupleMap=function(){this._tupleTrees.forEach(function(t,e){var s=0,a=t.rootnode,r=a.numOfLeafChildren?a.numOfLeafChildren:1;this._tupleMap[e]=[],this._tupleMap[e][":"]=[0,r],this.addTuplePath(e,a,s)}.bind(this))},sap.basetable.crosstab.CrosstabModel.prototype._rebuild=function(){this._tupleTrees[0]=this._dataProvider.getTupleTree(0),this._tupleTrees[1]=this._dataProvider.getTupleTree(1),this._tupleMap=[],this._buildTupleMap(),this._numberFormat_Map=this._dataProvider.getFormatMap()},sap.basetable.crosstab.CrosstabModel.prototype.fetchPage=function(t){var e=this._currentHorizontalPosition,s=this._currentVerticalPosition;this.updateRowAxisLength(),this.updateColumnAxisLength();var a=this._calculatePageAxisCoordinates(this._rowAxisLength,s,this._crosstabConstants.VERTICAL_SCROLL_WINDOW);t.coordinates.startRowIndex=a.startAxisIndex,t.coordinates.endRowIndex=a.endAxisIndex;var r=this._calculatePageAxisCoordinates(this._columnAxisLength,e,this._crosstabConstants.HORIZONTAL_SCROLL_WINDOW);t.coordinates.startColumnIndex=r.startAxisIndex,t.coordinates.endColumnIndex=r.endAxisIndex,-1===t.coordinates.endColumnIndex&&(t.coordinates.endColumnIndex=0),-1===t.coordinates.endRowIndex&&(t.coordinates.endRowIndex=0),this.fetchPageDirectly(t)},sap.basetable.crosstab.CrosstabModel.prototype._calculatePageAxisCoordinates=function(t,e,s){var a,r;if(s>=t)a=0,r=t-1;else{var o=t-1;r=this._calculateEndAxisIndex(e,s),a=this._calculateStartAxisIndex(e,s),r>o?(r=o,a=t-s):0>=a?(a=0,r=s-1):r-=1}return{"startAxisIndex":a,"endAxisIndex":r}},sap.basetable.crosstab.CrosstabModel.prototype._calculateStartAxisIndex=function(t,e){var s=t-e/2;return Math.floor(s)},sap.basetable.crosstab.CrosstabModel.prototype._calculateEndAxisIndex=function(t,e){var s=t+e/2;return Math.floor(s)},sap.basetable.crosstab.CrosstabModel.prototype.fetchPageDirectly=function(t){this._recentPageData=t,this._dataProvider._fetchViewPage(t.coordinates,this)},sap.basetable.crosstab.CrosstabModel.prototype.getRecentPageData=function(){return this._recentPageData},sap.basetable.crosstab.CrosstabModel.prototype.setTupleTrees=function(t,e){if(this._recentPageData.coordinates===t)if(this._dataProvider.setTupleTrees(t,e),this._rebuild(),this._crosstab.isHorizontallyScrollable()&&this._crosstab.isVerticallyScrollable())this._crosstab.redraw(this._crosstabScrollBarEventConstants.newPageEvent,this._recentPageData);else{var s=this.getSectionData(t);this._crosstab.drawSection(s,!1)}},sap.basetable.crosstab.CrosstabModel.prototype.getSectionData=function(t){var e,s=this.getPageSize(),a=s-1>=t.endRowIndex;e=this._crosstab.isHorizontallyScrollable()?!0:s-1>=t.endColumnIndex;var r=0,o=0;t.startRowIndex>0&&(r=t.startRowIndex*this._crosstab.getCellHeight()),this._crosstab.isHorizontallyScrollable()||t.startColumnIndex>0&&(o=t.startColumnIndex*this._crosstab.getCellWidth());var i=this._crosstab.model().getDimensions(0),n=this._crosstab.model().getDimensions(1),l={"redrawRowAxisHeader":0!==i.length,"redrawRowAxisContent":!0,"redrawColumnHeader":0!==n.length,"coordinates":t,"showRowAxisHeaders":e,"showColumnAxisHeaders":a,"topBuffer":r,"leftBuffer":o};return l},sap.basetable.crosstab.CrosstabModel.prototype.setFullAxisLength=function(t,e){var s={"axisIndex":t,"length":e};this._crosstabScrollBarEventMediator.publish(this._crosstabScrollBarEventConstants.updateAxisLength,s)},sap.basetable.crosstab.CrosstabModel.prototype.updateRowAxisLength=function(){this._rowAxisLength=this.getFullAxisLength(this._crosstab.ROW_AXIS)},sap.basetable.crosstab.CrosstabModel.prototype.updateColumnAxisLength=function(){this._columnAxisLength=this.getFullAxisLength(this._crosstab.COLUMN_AXIS)},sap.basetable.crosstab.CrosstabModel.prototype.getFullAxisLength=function(t){return this._dataProvider.getFullAxisLength(t)},sap.basetable.crosstab.CrosstabModel.prototype.initializeAxesMetadata=function(){this._dataProvider.initializeAxesMetadata()},sap.basetable.crosstab.CrosstabModel.prototype.updateAxesMetadata=function(t){this._dataProvider.updateAxesMetadata(t,this)},sap.basetable.crosstab.CrosstabModel.prototype.addPageData=function(t){this._dataProvider._addPage(t.page,t.windowIndex,t)},sap.basetable.crosstab.CrosstabModel.prototype.getFormat=function(t){return void 0===this._numberFormat_Map?this._numberFormat_Map:this._numberFormat_Map[t]},sap.basetable.crosstab.CrosstabModel.prototype.getPageSize=function(){return this._dataProvider.getPageSize()},sap.basetable.crosstab.CrosstabModel.prototype.setVerticalScrollPosition=function(t){this._currentVerticalPosition=t},sap.basetable.crosstab.CrosstabModel.prototype.setHorizontalScrollPosition=function(t){this._currentHorizontalPosition=t},sap.basetable.crosstab.CrosstabModel.prototype.getStartColumnIndex=function(){var t=0;return $.isNumeric(this._recentPageData.coordinates.startColumnIndex)&&(t=this._recentPageData.coordinates.startColumnIndex),t},sap.basetable.crosstab.CrosstabModel.prototype.getStartRowIndex=function(){var t=0;return $.isNumeric(this._recentPageData.coordinates.startRowIndex)&&(t=this._recentPageData.coordinates.startRowIndex),t},sap.basetable.crosstab.CrosstabModel.prototype.getStartColumnIndex=function(){var t=0;return $.isNumeric(this._recentPageData.coordinates.startColumnIndex)&&(t=this._recentPageData.coordinates.startColumnIndex),t},sap.basetable.crosstab.CrosstabModel.prototype.getEndRowIndex=function(){var t=Math.min(this.getFullAxisLength(this._crosstab.ROW_AXIS),this.getPageSize());return $.isNumeric(this._recentPageData.coordinates.endColumnIndex)&&(t=this._recentPageData.coordinates.endRowIndex),t},sap.basetable.crosstab.CrosstabModel.prototype.getEndColumnIndex=function(){var t=Math.min(this.getFullAxisLength(this._crosstab.COLUMN_AXIS),this.getPageSize());return $.isNumeric(this._recentPageData.coordinates.endColumnIndex)&&(t=this._recentPageData.coordinates.endColumnIndex),t},sap.basetable.crosstab.CrosstabModel.prototype.isCellJustResized=function(){return this._isCellJustResized},jQuery.sap.declare("sap.basetable.crosstab.CrosstabRenderer"),sap.basetable.crosstab.CrosstabRenderer=function(t,e){this._crosstab=t,this._crosstabContainers=this._crosstab.crosstabContainers(),this.oConditionalCellFormatter=new sap.basetable.crosstab.ConditionalCellFormatter,this._crosstabScrollBarEventMediator=e,this._crosstabConstants=new sap.basetable.crosstab.CrosstabConstants,this._crosstabElementResizedEventConstants=new sap.basetable.crosstab.CrosstabElementResizedEventConstants,this._columnSubtotals=[],this._measuresMap=[],this._pageCellIdMeasureMap={}},sap.basetable.crosstab.CrosstabRenderer.prototype={"_oLayout":null,"_leftAreaContainerMaxSizeOfWindow":.3,"_horizontalScrollBarVisible":!1,"_verticalScrollBarVisible":!1,"_rowAxisHeaderScrollBarVisible":!1,"_isContentWidthGreaterThanContainerWidth":!1,"_isLeftAreaGreaterThanThirtyPercentOfContainerWidth":!1,"_isContentHeightGreaterThanContainerHeight":!1,"_isLoading":!1,"_CELL_CORRECTION_PIXEL_OFFSET":1,"_FIRST_COLUMN_DIMENSION_CELL":"crosstab-ColumnDimensionCell-first","MINIMUM_RESIZED_CELL_WIDTH":32,"_HIDE_SECTION":"crosstab-hideSection","_MEASURES_SPAN":"Crosstab-MeasuresSpan","_MEASURES_ICON_CONTAINER_WIDTH":24},sap.basetable.crosstab.CrosstabRenderer.prototype.getMeasuresMap=function(t){return"number"==typeof t?this._measuresMap[t]:this._measuresMap},sap.basetable.crosstab.CrosstabRenderer.prototype.createContentSpan=function(t,e,s,a,r){var o=$(document.createElement("span"));return e=null===e?"":e,o[0].innerHTML=e,void 0!==r&&o[0].setAttribute("title",r),o[0].className+=s?" crosstab-Total":" crosstab-CellContent",$.isEmptyObject(a)||o[0].setAttribute("style",a),o},sap.basetable.crosstab.CrosstabRenderer.prototype.createContentCell=function(t,e,s,a,r,o,i,n){var l,c;$.isEmptyObject(o)||(l=sap.basetable.crosstab.utils.RenderUtils.styleClasstoString(o),c=o["background-color"]);var d=this.createContentSpan(t,e,s,l,i),b=0===t.indexOf("dataCell_0"),h=sap.basetable.crosstab.utils.RenderUtils.createContentCell(t,this._crosstab.getCellWidth(),this.getUpdatedCellHeight(b),this._crosstab.getBorderWidth(),d,a,r,"crosstab-Cell",!1,n);return c&&c.length>0&&h.css({"background-color":c}),h},sap.basetable.crosstab.CrosstabRenderer.prototype.createHeaderCell=function(t,e,s,a,r,o,i,n,l,c,d,b,h,p){var u;if(o&&o.length>0){u=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell(t+"-children");for(var _=0;o.length>_;_++)u.append(o[_]);u.addClass("crosstab-ChildrenCell")}var g=this.createContentSpan(t,e,s),C=n?this._crosstab.getCellHeight():this._crosstab.getCellHeight()-1;g.css({"line-height":C+"px","min-height":C+"px"});var f,m=n?"crosstab-Cell-Top":"crosstab-Cell";return f=b?sap.basetable.crosstab.utils.RenderUtils.createHeaderCell(t,this._crosstab.getRowCellWidth(),this._crosstab.getRowCellHeight(),this._crosstab.getBorderWidth(),g,u,a,r,m,l,e,h,!1):sap.basetable.crosstab.utils.RenderUtils.createHeaderCell(t,this._crosstab.getCellWidth(),this._crosstab.getCellHeight(),this._crosstab.getBorderWidth(),g,u,a,r,m,l,e,h,p),i&&f.addClass(i),d&&(this._pageCellIdMeasureMap[t]=c),f},sap.basetable.crosstab.CrosstabRenderer.prototype.createDimensionHeaderCell=function(t,e,s,a,r,o){var i=$(document.createElement("span")),n=r?!1:!0;i.text(e),i.attr("title",e),i.addClass("crosstab-CellContent"),o=a?o+1:o;var l;0>t.indexOf("MeasureNamesDimension")?l="Crosstab-"+t:(l=t,i.attr("id",this._MEASURES_SPAN));var c=sap.basetable.crosstab.utils.RenderUtils.createHeaderCell(l,o,this._crosstab.getCellHeight(),this._crosstab.getBorderWidth(),i,void 0,void 0,void 0,void 0,void 0,void 0,void 0,n);return c.addClass("crosstab-DimensionCell"),s&&c.addClass(s),c},sap.basetable.crosstab.CrosstabRenderer.prototype._hasDataPoints=function(t){for(var e=0;t.children.length>e;e++){var s=t.children[e];if(s.dataPoints&&s.dataPoints.length>0)return!0;if(s.children&&s.children.length>0&&this._hasDataPoints(s)===!0)return!0}return t.children&&0>=t.children.length&&t.dataPoints&&t.dataPoints.length>0?!0:!1},sap.basetable.crosstab.CrosstabRenderer.prototype.draw=function(t,e){this._crosstab.container().html("");var s=this._crosstab.model().getDimensions(0),a=this._crosstab.model().getDimensions(1),r=this._crosstab.model().getTupleTree(0).rootnode,o=this._crosstab.model().getTupleTree(1).rootnode,i=this.calculateLeftAreaWidth(),n=this.calculateRightAreaWidth(),l=(a.length+1)*this._crosstab.getCellHeight(),c=r.numOfLeafChildren?r.numOfLeafChildren*this._crosstab.getCellHeight():0;this._crosstabContainers.setHeaderHeight(l),this._crosstabContainers.setBodyHeight(c),0===this._crosstabContainers.getBodyHeight()&&this._hasDataPoints(r)&&this._crosstabContainers.setBodyHeight(this._crosstab.getCellHeight());var d=i+n,b=this._crosstabContainers.getHeaderHeight()+this._crosstabContainers.getBodyHeight(),h={"layoutTotalWidth":d,"layoutTotalHeight":b,"rowDimensions":s,"columnDimensions":a,"rowTupleRootNode":r,"columnTupleRootNode":o};this._setOverallContainerSizes(t,e);var p=this.createLayout(h);if(this.createTopSection(p.layoutObject,i,n,s,a,r,o),this.createBottomSection(p.layoutObject,i,n,s,r),this.createScrollContainer(p.layoutObject),this._setContainerSizes(i,n),this._createLoadingIndicator(p),!this._crosstab.isHorizontallyScrollable()||!this._crosstab.isVerticallyScrollable()){var u=this._crosstab.model().getRecentPageData().coordinates,_=this._crosstab.model().getSectionData(u);this._drawPostProcessing(_)}},sap.basetable.crosstab.CrosstabRenderer.prototype._drawPostProcessing=function(t){this._addBuffer(t),this._determineSectionsToHide(t)},sap.basetable.crosstab.CrosstabRenderer.prototype._setOverallContainerSizes=function(t,e){this._crosstabContainers.setOverallContainerHeight(t),this._crosstabContainers.setOverallContainerWidth(e)},sap.basetable.crosstab.CrosstabRenderer.prototype.getScrollbarVisibility=function(){var t={"horizontalScrollBar":this._horizontalScrollBarVisible&&this._isHeaderHeightLessThanContainerHeight(),"verticalScrollBar":this._verticalScrollBarVisible&&this._isHeaderHeightLessThanContainerHeight(),"rowAxisHeaderScrollBar":this._rowAxisHeaderScrollBarVisible&&this._isHeaderHeightLessThanContainerHeight(),"isVerticallyScrollable":this._crosstab.isVerticallyScrollable()};return t},sap.basetable.crosstab.CrosstabRenderer.prototype._isHeaderHeightLessThanContainerHeight=function(){return this._crosstabContainers._headerHeight<this._crosstabContainers._overallContainerHeight},sap.basetable.crosstab.CrosstabRenderer.prototype.createScrollContainer=function(t){var e=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell("crosstabScrollContainer");if(e.addClass("crosstab-Scroll-Container"),!this._crosstab.isVerticallyScrollable()){var s=this._crosstab.getTotalHeight();e.css({"height":s})}if(!this._crosstab.isHorizontallyScrollable()){var a=this._crosstab.getTotalWidth();e.css({"width":a})}this._crosstabContainers.setScrollContainer(e),this._crosstab.container().append(e),e.append(t)},sap.basetable.crosstab.CrosstabRenderer.prototype.createLayout=function(t){var e=[],s=this._getCrosstabLayoutSize(t);t.layoutTotalWidth<=s.width&&e.push("borderRightWidth"),t.layoutTotalHeight<=s.height&&e.push("borderBottomWidth");var a=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayout("crosstabLayout",s.width,s.height);a.addClass("crosstab-Layout"),0===t.rowDimensions.length&&0===t.columnDimensions.length&&a.addClass("noBorder");for(var r=0;e.length>r;r++)a.addClass(e[r]);return this._crosstab.isVerticallyScrollable()&&this._crosstab.isHorizontallyScrollable()||a.css({"position":"relative"}),this._crosstabContainers.setLayout(a),{"layoutObject":a,"layoutSize":s}},sap.basetable.crosstab.CrosstabRenderer.prototype._setContainerSizes=function(t,e){this._setContainerBoundaries(t,e),this._resetScrollBarVisibleFlags(),this.intializeScrollContainers(t,e),this._rowAxisHeaderScrollBarVisible&&!this._horizontalScrollBarVisible&&this.updateContainerWidths()},sap.basetable.crosstab.CrosstabRenderer.prototype._createLoadingIndicator=function(t){this._loadingIndicator=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell("crosstabLoadingIndicator"),this._loadingIndicator.addClass("crosstab-loadingIndicator crosstab-loadingHidden");var e=Math.round(t.layoutSize.height/2),s=Math.round(t.layoutSize.width/2);this._loadingIndicator.css({"top":e,"left":s}),t.layoutObject.append(this._loadingIndicator)},sap.basetable.crosstab.CrosstabRenderer.prototype._getCrosstabLayoutSize=function(t){var e=this._crosstabContainers.getOverallContainerHeight(),s=this._crosstabContainers.getOverallContainerWidth();return s>=t.layoutTotalWidth&&(s=t.layoutTotalWidth),e>=t.layoutTotalHeight&&(e=t.layoutTotalHeight),t.rowDimensions.length>0&&(this._hasDataPoints(t.rowTupleRootNode)||t.columnTupleRootNode.numOfLeafChildren)&&(s+=this._crosstabConstants._METADATA_BORDER_WIDTH),this._crosstab.isMetaDataBorderPresent(this._crosstabConstants.Horizontal)&&(e+=this._crosstabConstants._METADATA_BORDER_HEIGHT),{"height":e,"width":s}},sap.basetable.crosstab.CrosstabRenderer.prototype._resetScrollBarVisibleFlags=function(){this._rowAxisHeaderScrollBarVisible=!1,this._horizontalScrollBarVisible=!1,this._verticalScrollBarVisible=!1},sap.basetable.crosstab.CrosstabRenderer.prototype._setContainerBoundaries=function(t,e){this._setIsContentWidthGreaterThanContainerWidth(t,e),this._setIsLeftAreaGreaterThanThirtyPercentOfContainerWidth(t),this._setIsContentHeightGreaterThanContainerHeight()},sap.basetable.crosstab.CrosstabRenderer.prototype._setIsContentWidthGreaterThanContainerWidth=function(t,e){this._isContentWidthGreaterThanContainerWidth=t+e>this._crosstabContainers.getOverallContainerWidth()?!0:!1},sap.basetable.crosstab.CrosstabRenderer.prototype._setIsLeftAreaGreaterThanThirtyPercentOfContainerWidth=function(t){this._isLeftAreaGreaterThanThirtyPercentOfContainerWidth=t>this._crosstabContainers.getOverallContainerWidth()*this._leftAreaContainerMaxSizeOfWindow?!0:!1},sap.basetable.crosstab.CrosstabRenderer.prototype._setIsContentHeightGreaterThanContainerHeight=function(){this._isContentHeightGreaterThanContainerHeight=this._crosstabContainers.getHeaderHeight()+this._crosstabContainers.getBodyHeight()>this._crosstabContainers.getOverallContainerHeight()?!0:!1},sap.basetable.crosstab.CrosstabRenderer.prototype.updateContainerWidths=function(){var t=this._crosstabContainers.getLeftAreaContainerWidth(),e=this._crosstabContainers.getRightAreaContainerWidth(),s=this._crosstabContainers.getLayout();$(s).css({"width":t+e+this._crosstabConstants._METADATA_BORDER_WIDTH}),$(s).addClass("borderRightWidth")},sap.basetable.crosstab.CrosstabRenderer.prototype.intializeScrollContainers=function(t,e){this._crosstab.isHorizontallyScrollable()&&(this._setLeftAreaContainerWidth(t,e),this._setHorizontalScrollBarVisible()),this._crosstab.isVerticallyScrollable()&&this._setVerticalScrollBarVisible(),this._setContainers(t,e)},sap.basetable.crosstab.CrosstabRenderer.prototype._setLeftAreaContainerWidth=function(t,e){if(this._isContentWidthGreaterThanContainerWidth&&this._isLeftAreaGreaterThanThirtyPercentOfContainerWidth){this._rowAxisHeaderScrollBarVisible=!0;var s=this._crosstabContainers.getOverallContainerWidth(),a=Math.floor(s*this._leftAreaContainerMaxSizeOfWindow);if(s>a+e){var r=s-e;this._crosstabContainers.setLeftAreaContainerWidth(r)}else this._crosstabContainers.setLeftAreaContainerWidth(a)}else this._crosstabContainers.setLeftAreaContainerWidth(t);this._setIsContentWidthGreaterThanContainerWidth(this._crosstabContainers.getLeftAreaContainerWidth(),e)},sap.basetable.crosstab.CrosstabRenderer.prototype._setHorizontalScrollBarVisible=function(){this._isContentWidthGreaterThanContainerWidth&&(this._horizontalScrollBarVisible=!0)},sap.basetable.crosstab.CrosstabRenderer.prototype._setVerticalScrollBarVisible=function(){this._isContentHeightGreaterThanContainerHeight&&(this._verticalScrollBarVisible=!0)},sap.basetable.crosstab.CrosstabRenderer.prototype._setContainers=function(t,e){this._isContentHeightGreaterThanContainerHeight&&this._isContentWidthGreaterThanContainerWidth?(this.setRightAreaContainerWidth(e),this.setRowHeaderContainerSize(!0),this.setColumnHeaderContainerSize(),this.setBodyContainerSize(!0,this._crosstabConstants.Both)):this._isContentHeightGreaterThanContainerHeight?(this.setRightAreaContainerWidth(e),this.setRowHeaderContainerSize(!0),this.setBodyContainerSize(!0,this._crosstabConstants.Vertical)):this._isContentWidthGreaterThanContainerWidth&&(this.setRightAreaContainerWidth(e),this.setColumnHeaderContainerSize(),this.setBodyContainerSize(!0,this._crosstabConstants.Horizontal)),this._rowAxisHeaderScrollBarVisible&&(this._horizontalScrollBarVisible||this._verticalScrollBarVisible?this._horizontalScrollBarVisible&&!this._verticalScrollBarVisible?(this.setRowHeaderContainerSize(!1),this.setLeftAreaDimensionHeaderContainer()):this.setLeftAreaDimensionHeaderContainer():(this.setRightAreaContainerWidth(e),this.setLeftAreaDimensionHeaderContainer(),this.setRowHeaderContainerSize(!1),this.setColumnHeaderContainerSize(),this.setBodyContainerSize(!1)))},sap.basetable.crosstab.CrosstabRenderer.prototype.setLeftAreaDimensionHeaderContainer=function(){$(this._crosstabContainers.getLeftAreaDimensionHeaderContainer()).css({"height":this._crosstabContainers.getHeaderHeight(),"width":this._crosstabContainers.getLeftAreaContainerWidth()+this._CELL_CORRECTION_PIXEL_OFFSET}),$(this._crosstabContainers.getLeftAreaDimensionHeaderOuterContainer()).css({"height":this._crosstabContainers.getHeaderHeight(),"width":this._crosstabContainers.getLeftAreaContainerWidth()+this._crosstabContainers.getRightAreaContainerWidth()+this._crosstabConstants._METADATA_BORDER_WIDTH})},sap.basetable.crosstab.CrosstabRenderer.prototype.setRightAreaContainerWidth=function(t){this._isContentWidthGreaterThanContainerWidth?this._crosstabContainers.setRightAreaContainerWidth(this._crosstabContainers.getOverallContainerWidth()-this._crosstabContainers.getLeftAreaContainerWidth()):this._crosstabContainers.setRightAreaContainerWidth(t)},sap.basetable.crosstab.CrosstabRenderer.prototype.setBodyContainerSize=function(t,e){var s=this._crosstabContainers.getBodyHeight(),a=e===this._crosstabConstants.Vertical||e===this._crosstabConstants.Both,r=t&&a;r&&(s=this._crosstabContainers.getOverallContainerHeight()-this._crosstabContainers.getHeaderHeight()),$(this._crosstabContainers.getRowAxisContentContainer()).css({"height":s,"width":this._crosstabContainers.getRightAreaContainerWidth()})},sap.basetable.crosstab.CrosstabRenderer.prototype.setRowHeaderContainerSize=function(t){var e,s=this._crosstabContainers.getRowAxisHeaderContainer(),a=this._crosstabContainers.getLeftAreaContainerWidth();if(t){e=this._crosstabContainers.getHeaderHeight();var r=this._crosstabContainers.getOverallContainerHeight()-e;$(s).css({"height":r,"width":a})}else e=this._crosstabContainers.getBodyHeight(),$(s).css({"height":e,"width":a})},sap.basetable.crosstab.CrosstabRenderer.prototype._incrementWidthIfHorizontalScrollbarVisible=function(t){var e=t,s=this._crosstab.model().getDimensions(0);return this._horizontalScrollBarVisible&&s.length>0?e+this._CELL_CORRECTION_PIXEL_OFFSET:e},sap.basetable.crosstab.CrosstabRenderer.prototype.setColumnHeaderContainerSize=function(){var t=this._crosstabContainers.getColumnHeaderContainer(),e=this._incrementWidthIfHorizontalScrollbarVisible(this._crosstabContainers.getRightAreaContainerWidth());$(t).css({"height":this._crosstabContainers.getHeaderHeight(),"width":e})},sap.basetable.crosstab.CrosstabRenderer.prototype.createRowDimensionHeader=function(t,e,s,a){var r,o=!0,i=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell("leftAreaDimensionHeader-Container");i.addClass("crosstab-LeftDimensionHeaders"),this._crosstabContainers.setLeftAreaDimensionHeaderContainer(i),this._hasDataPoints(s)||!(e.length>0)&&a.numOfLeafChildren||(t-=1);var n=t;if(this._hasDataPoints(s)&&!a.numOfLeafChildren){var l=this._crosstab.model().getResizedElements(0),c=this._crosstabElementResizedEventConstants.emptyColumnDimension,d=l[c]?l[c]:this._crosstab.getCellWidth();t=t+d+this._crosstabConstants._METADATA_BORDER_WIDTH,t>this._crosstabContainers.getOverallContainerWidth()&&(t=this._crosstabContainers.getOverallContainerWidth()+this._crosstabConstants._METADATA_BORDER_WIDTH),r=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell("leftAreaDimensionHeader-ScrollbarContainer"),this._crosstabContainers.setLeftAreaDimensionHeaderContainer(r),this._crosstabContainers.setLeftAreaDimensionHeaderOuterContainer(i)}var b=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayout("leftAreaDimensionHeader-Content",t);b.addClass("crosstab-Layout-Column");var h;a.numOfLeafChildren||(h=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayout("leftAreaDimensionHeader-Content-inner",n)),this._hasDataPoints(s)||a.numOfLeafChildren?a.numOfLeafChildren&&b.addClass("leftArea"):b.addClass("noDataPoints"),this._crosstabContainers.setLeftAreaDimensionHeaderContent(b);var p=this._crosstabContainers.getHeaderHeight();b.css({"height":p-1+"px"});var u=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("leftAreaDimensionHeaderCellRow",p);void 0!==h?(h.append(u),b.append(h)):b.append(u);var _=this._crosstab.model().getResizedElements(1);return e.forEach(function(t){var s=_[t.id];s||(s=this._crosstab.getRowCellWidth());var r=e.length>0&&a.numOfLeafChildren,i=this.createDimensionHeaderCell(t.id,t.caption,"crosstab-RowDimensionCell",r,o,s);if(i.find(".crosstab-resizable").css("height",p),"MeasureNamesDimension"===t.id){var n=$(document.createElement("div")).attr("id","Crosstab-MeasuresIconContainer").addClass("icon-Crosstab-Measures-Rows"),l=i.find("#"+this._MEASURES_SPAN);l.css("width",i.children().width()-this._MEASURES_ICON_CONTAINER_WIDTH),i.children().prepend(n)}i.attr("valign","bottom"),u.append(i)}.bind(this)),r?(r.append(b),i.append(r)):i.append(b),i},sap.basetable.crosstab.CrosstabRenderer.prototype._isAdditionalBorderVisible=function(t,e){if(t.length>0&&e.length>0)return!1;for(var s=0;t.length>s;s++)if("MeasureNamesDimension"===t[s].id)return!1;return!0},sap.basetable.crosstab.CrosstabRenderer.prototype.createColumnHeaderContainer=function(t,e,s,a,r,o){var i=this._crosstab.getCellHeight(),n=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell("columnHeader-Container");this._isAdditionalBorderVisible(s,e)?n.addClass("crosstab-ColumnHeaderContainer-blueBarsRemoved"):n.addClass("crosstab-ColumnHeaderContainer"),this._crosstabContainers.setColumnHeaderContainer(n);var l=t;e.length>0&&this._hasDataPoints(a)&&(l+=1);var c=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayout("columnHeaderCell-Content",l,this._crosstabContainers.getHeaderHeight());c.addClass("crosstab-Layout-Column");var d=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("columnDimensionHeaderRow",i,null,"crosstab-columnDimensionHeaderRow"),b=this.createColumnDimensionHeaderCell(t,s,e.length>0);d.append(b),c.append(d);var h=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("columnMemberHeaderRow",this._crosstabContainers.getHeaderHeight()-this._crosstab.getCellHeight()),p=this.createColumnMemberHeaderCell(t,this._crosstabContainers.getHeaderHeight()-i,s,r,o,e.length>0);return p.addClass("crosstab-columnMemberHeaderRow"),this._crosstabContainers.setColumnHeaderContent(p),h.append(p),c.append(h),n.append(c),n},sap.basetable.crosstab.CrosstabRenderer.prototype.createColumnDimensionHeaderCell=function(t,e,s){var a=this._crosstab.getCellHeight();t=s&&e.length>0?t+this._CELL_CORRECTION_PIXEL_OFFSET:t;var r=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell("rightAreaDimensionHeaderCell",t,a);r.addClass("crosstab-rightAreaDimensionHeader");var o=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayout("rightAreaDimensionHeaderCellLayout",t,a),i=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("rightAreaDimensionHeaderCellRow",a);return o.append(i),e.forEach(function(t,e){var a=0===e?this._FIRST_COLUMN_DIMENSION_CELL:"crosstab-ColumnDimensionCell",r=this.createDimensionHeaderCell(t.id,t.caption,a,s,!1,this._crosstab.getCellWidth());if("MeasureNamesDimension"===t.id){var o=$(document.createElement("div")).attr("id","Crosstab-MeasuresIconContainer").addClass("icon-Crosstab-Measures-Columns");r.children().prepend(o)}i.append(r)}.bind(this)),r.append(o),r},sap.basetable.crosstab.CrosstabRenderer.prototype.addColumnMemberHeader=function(t,e,s,a,r){for(var o=[],i=!1,n=0,l=this._crosstab.model().getResizedElements(0),c=!0,d=0;t.children.length>d;d++){var b=t.children[d],h=[],p=0,u=b.numOfLeafChildren?b.numOfLeafChildren:1;if(b.isTotal&&this._columnSubtotals.push(e),b.children.length>0){i=!1;var _=this.addColumnMemberHeader(b,e,s+1,a+"_"+d,r);e=_.index,h=_.nodes,p=_.width,n+=p}else{i=!0;var g=l[b.tuplePath];p=g?g:this._crosstab.getCellWidth(),n+=p,e++,c=!1}var C=!1;r&&0===d&&(-1===a.lastIndexOf("_")||this._isHeaderCellInFirstColumn(a))&&(C=!0);var f=this.createHeaderCell(a+"_"+d,b.member.caption,b.isTotal,1,u,h,"crosstab-ColumnHeaderCell",0===s,C,b.member.id,b.isMeasure,!1,p,c);i&&f.addClass(this._crosstab.getId()+"-ColumnHeader-LeafChild"+e),o.push(f)}var m=this._crosstab.model().getMeasuresPosition();if("column"===m.axis&&s===m.level)for(var v=0,x=0;t.children.length>x;x++){var S,y=t.children[x];if(y.numOfLeafChildren>0){S=0===v?e-t.numOfLeafChildren:v;for(var P=0;y.numOfLeafChildren>P;P++)this._measuresMap[S+P]=y.member.id,v=S+P+1}else S=e-t.numOfLeafChildren+x,this._measuresMap[S]=y.member.id}return{"index":e,"nodes":o,"width":n}},sap.basetable.crosstab.CrosstabRenderer.prototype._isHeaderCellInFirstColumn=function(t){return/ColumnMemberHeaderCell(_0)+$/i.test(t)},sap.basetable.crosstab.CrosstabRenderer.prototype.createColumnMemberHeaderCell=function(t,e,s,a,r,o){var i=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell("rightAreaMemberHeaderCell"),n=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayout("rightAreaMembersHeaderCellLayout",t,e),l=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("colDimRow",this._crosstab.getCellHeight());n.append(l);for(var c=this.addColumnMemberHeader(a,r,0,this._crosstab.getId()+"-ColumnMemberHeaderCell",o),d=0;c.nodes.length>d;d++)l.append(c.nodes[d]);return i.append(n),i},sap.basetable.crosstab.CrosstabRenderer.prototype.createTopSection=function(t,e,s,a,r,o,i){var n=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("topSection",this._crosstabContainers.getHeaderHeight(),null,"crosstab-TopSection"),l=this._crosstab.model().getStartColumnIndex();if(a.length>0){var c=this.createRowDimensionHeader(e,a,o,i);n.append(c)}if(r.length>0){for(var d=this.createColumnHeaderContainer(s,a,r,o,i,l),b=0;r.length-1>b;b++){var h=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell(this._crosstab.getId()+"-ColumnAxisFloatingHeader"+b);h.css({"height":this._crosstab.getCellHeight()+"px","line-height":this._crosstab.getCellHeight()-this._crosstab.getBorderWidth()+"px","width":this._crosstab.getCellWidth()+"px","left":"0px","top":(b+1)*this._crosstab.getCellHeight()+"px","z-index":"100"}),h.addClass("crosstab-FloatingCell crosstab-CellContent"),d.append(h)}n.append(d)}this._crosstabContainers.setTopSectionContainer(n),t.append(n)},sap.basetable.crosstab.CrosstabRenderer.prototype.addDataPointsCellsToRow=function(t,e,s,a,r){if(e.dataPoints&&e.dataPoints.length>0)e.dataPoints.forEach(function(a,o){var i,n,l,c=this._crosstab.model(),d=c.getMeasuresPosition();"column"===d.axis?l=o+c.getStartColumnIndex():"row"===d.axis&&(l=s),i=this.getMeasuresMap(l),n=c.getFormat(i);var b=a;a||0===a||(b=null);var h,p=e.isTotal?e.isTotal:$.inArray(o,this._columnSubtotals)>=0;p||null===this._crosstab.conditionalFormat()||void 0===this._crosstab.conditionalFormat()||(h=this.oConditionalCellFormatter.generateCellCallback(this._crosstab.conditionalFormat(),b,i)),n&&void 0!==n&&r&&(b=sap.basetable.crosstab.utils.FormatUtils.applyFormats(a,n));var u,_=this._crosstab.model().getResizedElements(0),g=this._crosstab.model().getDimensions(1).length;for(var C in _){var f=this._crosstab.model().getTupleIndex(1,C);if(f&&o===f[1]-1&&g===this._crosstab.model().getTupleDepth(C)||0===g&&C===this._crosstabElementResizedEventConstants.emptyColumnDimension){u=_[C];break}}var m;m=$.isEmptyObject(h)?this.createContentCell("dataCell_"+s+"_"+o,b,p,null,null,null,a,u):this.createContentCell("dataCell_"+s+"_"+o,b,p,null,null,h,a,u);var v=0===o?"crosstab-DataCell-first":"crosstab-DataCell";m.addClass(v),$.isEmptyObject(h)||"transparent"===h["background-color"]||m.css({"border-top-color":h["background-color"]}),t[s].append(m)}.bind(this));else for(var o=0;a>o;o++){var i=this.createContentCell("dataCell_"+s+"_"+o,"",e.isTotal,null,null,null,null,null);i.addClass("crosstab-DataCell"),t[s].append(i)}},sap.basetable.crosstab.CrosstabRenderer.prototype.addCellsToRow=function(t,e,s,a,r,o,i,n,l,c){var d,b=!0,h=[],p=this._crosstab.model().getMeasuresPosition();
if(s.isTotal&&!c){var u=s.member.aggregationTarget;void 0!==u&&null!==u&&(c=u.id)}if("row"===p.axis&&o===p.level&&void 0!==p.level)for(var _=a,g=0;s.children.length>g;g++){var C=s.children[g];if(d=C.numOfLeafChildren?C.numOfLeafChildren:1,c&&s.isTotal||(c=C.member.id),d>1)for(var f=0;C.numOfLeafChildren>f;f++)this._measuresMap[_]=c,_++;else this._measuresMap[_]=c,_++}for(var m=function(t,e){return e!==P&&t.tuplePath.length>0&&I.tuplePath===t.tuplePath},v=this._crosstab.model().getDimensions(0),x=this._crosstab.model().getResizedElements(1),S=x[v[o].id],y=S?S:this._crosstab.getRowCellWidth(),P=0;s.children.length>P;P++){var T,A,I=s.children[P],R=[];if(d=I.numOfLeafChildren?I.numOfLeafChildren:1,I.children.length>0){T=!i||I.isTotal&&"count"===I.member.id?!1:!0;var w=this.addCellsToRow(t,e,I,a,r,o+1,T,n+"_"+P,0===a,c);a=w.iRowIndex,R=w.nodes,A=!1}else 0===I.children.length&&(T=!i||I.isTotal&&"count"===I.member.id?!1:!0,this.addDataPointsCellsToRow(e,I,a,r,T),A=!0),a++;var H,E=!1,M=null;if(I.isTotal===!0&&(H=jQuery.grep(s.children,m),H.length>0)){var D=I.member.caption+" ("+I.member.aggregationTarget.caption+")";M=this.createHeaderCell(n+"_"+P,D,I.isTotal,d,null,R,"crosstab-dimensionHeaderCell",null,null,I.member.id,I.isMeasure,b,y),A&&M.addClass(this._crosstab.getId()+"-RowAxisHeader-LeafChild"+a),E=!0}E===!1&&(M=this.createHeaderCell(n+"_"+P,I.member.caption,I.isTotal,d,null,R,"crosstab-dimensionHeaderCell",l,null,I.member.id,I.isMeasure,b,y),A&&M.addClass(this._crosstab.getId()+"-RowAxisHeader-LeafChild"+a)),M&&(h.push(M),l=!1)}return{"iRowIndex":a,"nodes":h}},sap.basetable.crosstab.CrosstabRenderer.prototype.createBottomSection=function(t,e,s,a,r){var o=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell("rowAxisContent-Container");o.addClass("crosstab-LeftDimensionHeaders"),this._crosstabContainers.setRowAxisContentContainer(o);var i=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayout("rowAxisContent-Content",s,this._crosstabContainers.getBodyHeight());i.addClass("crosstab-DataArea"),this._crosstabContainers.setRowAxisContentContent(i);var n=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("bottomRow",this._crosstabContainers.getBodyHeight());n.addClass("crosstab-BottomSection");var l,c=r.numOfLeafChildren?r.numOfLeafChildren:0,d=[],b=this._crosstab.model().getStartRowIndex(),h=this._crosstab.model().getNumberOfTuples(1);if(0===c&&r.dataPoints&&r.dataPoints.length>0)l=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("row0",this._crosstab.getCellHeight()),i.append(l),d[0]=l,this.addDataPointsCellsToRow(d,r,b,h,!0),o.append(i),n.append(o);else if(0!==c){c=b+c;for(var p=b;c>p;p++)l=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("row"+p,this.getUpdatedCellHeight(0===p)),i.append(l),d[p]=l;var u=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("row"+p,this._crosstab.getCellHeight()),_=this.addCellsToRow(u,d,r,b,h,0,!0,this._crosstab.getId()+"-RowAxisheaderCell",!0),g=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell("rowAxisHeader-Container");this._hasDataPoints(r)||0!==s?g.addClass("crosstab-RowAxisheaderContainer"):g.addClass("crosstab-RowAxisheaderContainer-noDataPoints"),(s>0&&e>0||this._hasDataPoints(r))&&g.addClass("crosstab-RowAxisheaderContainer-blueBars"),this._crosstabContainers.setRowAxisFloatingHeaderContainer(sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell("rowAxisHeader-FloatingHeadersContainer"));var C=this._crosstabContainers.getRowAxisFloatingHeaderContainer();C.addClass("crosstab-RowAxisFloatingHeadersContainer");for(var f=this._crosstab.model().getResizedElements(1),m=0,v=0;a.length-1>v;v++){var x=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell(this._crosstab.getId()+"-RowAxisFloatingHeader"+v),S=this._crosstab.getRowCellWidth(),y=f[a[v].id];S=y?y:S,x.css({"height":this._crosstab.getCellHeight()-this._crosstab.getBorderWidth()+"px","line-height":this._crosstab.getCellHeight()-this._crosstab.getBorderWidth()+"px","width":S+"px","top":"0px","left":m+"px"}),m+=S,x.addClass("crosstab-FloatingCell crosstab-CellContent"),C.append(x)}g.append(C),this._crosstabContainers.setRowAxisHeaderContainer(g);var P=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayout("rowAxisHeader-Content",e,this._crosstabContainers.getBodyHeight());P.addClass("crosstab-RowAxisHeaderContent"),this._crosstabContainers.setRowAxisHeaderContent(P);for(var T=0;_.nodes.length>T;T++)P.append(_.nodes[T]);g.append(P),n.append(g),this._hasDataPoints(r)&&(o.append(i),n.append(o))}t.append(n)},sap.basetable.crosstab.CrosstabRenderer.prototype._addBuffer=function(t){var e=t.topBuffer,s=t.leftBuffer;0===e?this._crosstabContainers.getLayout().css({"top":""}):this._crosstabContainers.getLayout().css({"top":e+"px"}),0===s?this._crosstabContainers.getLayout().css({"left":""}):this._crosstabContainers.getLayout().css({"left":s+"px"})},sap.basetable.crosstab.CrosstabRenderer.prototype._determineSectionsToHide=function(t){var e,s,a,r,o,i=this._crosstabContainers.getLeftAreaDimensionHeaderContainer(),n=this._crosstabContainers.getRowAxisHeaderContainer(),l=this._crosstabContainers.getTopSectionContainer(),c=this._crosstabContainers.getLayout();n&&(t.showRowAxisHeaders===!1&&n.is(":visible")?(s=parseInt(n.css("width")),a=parseInt(c.css("width"))-s,c.css({"width":a}),n.addClass(this._HIDE_SECTION),e=!1):t.showRowAxisHeaders!==!0||n.is(":visible")||(n.removeClass(this._HIDE_SECTION),s=parseInt(n.css("width")),a=parseInt(c.css("width"))+s,c.css({"width":a}),e=!0)),t.showColumnAxisHeaders===!1&&l.is(":visible")?(r=parseInt(l.css("height")),o=parseInt(c.css("height"))-r,c.css({"height":o}),l.addClass(this._HIDE_SECTION),e=!1):t.showColumnAxisHeaders!==!0||l.is(":visible")||(this._crosstabContainers.getTopSectionContainer().removeClass(this._HIDE_SECTION),r=parseInt(l.css("height")),o=parseInt(c.css("height"))+r,c.css({"height":o}),e=!0),i&&(e===!1&&i.is(":visible")?i.addClass(this._HIDE_SECTION):e!==!0||i.is(":visible")||i.removeClass(this._HIDE_SECTION))},sap.basetable.crosstab.CrosstabRenderer.prototype.drawSection=function(t){this._drawPostProcessing(t),this.redrawFromPageData(t),this._crosstab.isVerticallyScrollable()||this._crosstab.isHorizontallyScrollable()||this._crosstabContainers.getRowAxisContentContent().addClass("crosstab-DataArea-PositionAbsolute ")},sap.basetable.crosstab.CrosstabRenderer.prototype.redrawFromPageData=function(t){var e,s=0;t.redrawRowAxisContent&&(t.redrawColumnHeader&&(this.redrawColumnHeaderContent(),this._crosstab.isHorizontallyScrollable()||(s=this.calculateRightAreaWidth()+this._CELL_CORRECTION_PIXEL_OFFSET)),e=this.redrawRowAxisContentContent(),t.redrawRowAxisHeader&&this.redrawRowAxisHeaderContent(e)),s>0&&this.updateCrosstabLayoutWidth(s)},sap.basetable.crosstab.CrosstabRenderer.prototype.redrawRowAxisContentContent=function(){var t=this._crosstab.model().getTupleTree(0).rootnode,e=this.calculateRightAreaWidth();this._crosstabContainers.setBodyHeight(t.numOfLeafChildren?t.numOfLeafChildren*this._crosstab.getCellHeight():0);var s=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayout("rowAxisContent-Content",e,this._crosstabContainers.getBodyHeight());s.addClass("crosstab-DataArea");var a,r,o=t.numOfLeafChildren?t.numOfLeafChildren:0,i=[],n=this._crosstab.model().getNumberOfTuples(1),l=this._crosstab.model().getStartRowIndex();if(0===o&&t.dataPoints&&t.dataPoints.length>0)a=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("row0",this._crosstab.getCellHeight()),s.append(a),i[0]=a,this.addDataPointsCellsToRow(i,t,l,n,!0);else if(0!==o){o=l+o;for(var c=l;o>c;c++)a=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("row"+c,this.getUpdatedCellHeight(0===c)),s.append(a),i[c]=a;var d=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("row"+c,this._crosstab.getCellHeight());r=this.addCellsToRow(d,i,t,l,n,0,!0,this._crosstab.getId()+"-RowAxisheaderCell",0===l)}var b=this._crosstabContainers.replaceContainer(s,this._crosstabContainers.getRowAxisContentContent());return this._crosstabContainers.setRowAxisContentContent(b),r},sap.basetable.crosstab.CrosstabRenderer.prototype.redrawRowAxisHeaderContent=function(t){var e=this.calculateLeftAreaWidth(),s=this._crosstab.model().getTupleTree(0).rootnode;this._crosstabContainers.setBodyHeight(s.numOfLeafChildren?s.numOfLeafChildren*this._crosstab.getCellHeight():0);var a=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayout("rowAxisHeader-Content",e,this._crosstabContainers.getBodyHeight());a.addClass("crosstab-RowAxisHeaderContent");for(var r=0;t.nodes.length>r;r++)a.append(t.nodes[r]);var o=this._crosstabContainers.replaceContainer(a,this._crosstabContainers.getRowAxisHeaderContent());this._crosstabContainers.setRowAxisHeaderContent(o)},sap.basetable.crosstab.CrosstabRenderer.prototype.redrawColumnHeaderContent=function(){var t=this._crosstab.model().getDimensions(0),e=this._crosstab.model().getDimensions(1),s=this._crosstab.model().getTupleTree(1).rootnode,a=this._crosstab.getCellHeight()-1;this._crosstabContainers.setHeaderHeight((e.length+1)*this._crosstab.getCellHeight());var r=this._incrementWidthIfHorizontalScrollbarVisible(this.calculateRightAreaWidth()),o=this._crosstab.model().getStartColumnIndex(),i=this.createColumnMemberHeaderCell(r,this._crosstabContainers.getHeaderHeight()-a,e,s,o,t.length>0);i.addClass("crosstab-columnMemberHeaderRow");var n=this._crosstabContainers.replaceContainer(i,this._crosstabContainers.getColumnHeaderContent());this._crosstabContainers.setColumnHeaderContent(n)},sap.basetable.crosstab.CrosstabRenderer.prototype.calculateRightAreaWidth=function(t){var e=0,s=this._crosstab.model().getDimensions(1),a=this._crosstab.model().getTupleTree(1).rootnode,r=this._crosstab.model().getResizedElements(0);if(a.numOfLeafChildren){var o=0;for(var i in r)this._crosstab.model().getTupleIndex(1,i)&&this._crosstab.model().getTupleDepth(i)===s.length&&(e+=r[i],o++);var n;n=void 0!==typeof t&&t===!0?this._crosstab.model().getFullAxisLength(this._crosstab.COLUMN_AXIS):a.numOfLeafChildren,e+=(n-o)*this._crosstab.getCellWidth()}else{var l=this._crosstab.model().getTupleTree(0).rootnode;if(this._hasDataPoints(l)){var c=this._crosstabElementResizedEventConstants.emptyColumnDimension;e=r[c]?r[c]:this._crosstab.getCellWidth()}}return e},sap.basetable.crosstab.CrosstabRenderer.prototype.calculateLeftAreaWidth=function(){for(var t=this._crosstab.model().getDimensions(0),e=this._crosstab.model().getResizedElements(1),s=0,a=0,r=0;t.length>r;r++)t[r].id in e&&(a+=e[t[r].id],s++);return(t.length-s)*this._crosstab.getRowCellWidth()+a},sap.basetable.crosstab.CrosstabRenderer.prototype.updateContainerBordersEvent=function(t){var e=this._crosstabContainers.getLayout();t?$(e).hasClass("borderBottomWidth")?e.removeClass("borderBottomWidth"):e.addClass("borderBottomWidth"):$(e).hasClass("borderRightWidth")?e.removeClass("borderRightWidth"):e.addClass("borderRightWidth")},sap.basetable.crosstab.CrosstabRenderer.prototype.redrawFromConditionalFormatting=function(){this.redrawRowAxisContentContent()},sap.basetable.crosstab.CrosstabRenderer.prototype.showLoadingIndicator=function(){this._isLoading===!1&&(this._isLoading=!0,setTimeout(function(){this._isLoading===!0&&this._loadingIndicator.is(":hidden")&&(this._loadingIndicator.addClass("crosstab-loadingVisible"),this._loadingIndicator.removeClass("crosstab-loadingHidden"))}.bind(this),3e3))},sap.basetable.crosstab.CrosstabRenderer.prototype.hideLoadingIndicator=function(){this._isLoading=!1,this._loadingIndicator.is(":visible")&&(this._loadingIndicator.addClass("crosstab-loadingHidden"),this._loadingIndicator.removeClass("crosstab-loadingVisible"))},sap.basetable.crosstab.CrosstabRenderer.prototype.styleSelectedCells=function(t,e){var s=sap.basetable.crosstab.utils.RenderUtils.styleSelectedCells(t,e);return s},sap.basetable.crosstab.CrosstabRenderer.prototype.getPageCellIdMeasureMap=function(){return this._pageCellIdMeasureMap},sap.basetable.crosstab.CrosstabRenderer.prototype.getCellWidth=function(t){var e;return e=t?this._crosstab.getRowCellWidth():this._crosstab.getCellWidth()},sap.basetable.crosstab.CrosstabRenderer.prototype.getUpdatedCellHeight=function(t){var e=this._crosstab.getCellHeight();return t&&(e=this._crosstab.getCellHeight()-1),e},sap.basetable.crosstab.CrosstabRenderer.prototype.updateCrosstabLayoutWidth=function(t){var e=this._crosstab.container().closest(".sapUI5Crosstab"),s=0,a=this._crosstabContainers.getLeftAreaDimensionHeaderContainer();a&&!a.hasClass(this._HIDE_SECTION)&&(s=this.calculateLeftAreaWidth()+this._crosstabConstants._METADATA_BORDER_WIDTH);var r=s+t;e&&r>0&&(e.find("#crosstabLayout").width(r),e.find("#columnHeaderCell-Content").width(t),e.find("#rightAreaDimensionHeaderCellLayout").width(t))},jQuery.sap.declare("sap.basetable.crosstab.CrosstabScrollBar"),sap.basetable.crosstab.CrosstabScrollBar=function(t,e,s,a,r){this._scrollBarType=e,this._crosstabScrollBarEventMediator=s,this._scrollableCellAmount=a,this._crosstabScrollBarEventConstants=new sap.basetable.crosstab.CrosstabScrollBarEventConstants,this._crosstabConstants=new sap.basetable.crosstab.CrosstabConstants,this._crosstab=t,this._floatedHeaders=r,this._isHorizontalScrolling=this._scrollBarType===this._crosstabConstants.Horizontal,this._isVerticalScrolling=this._scrollBarType===this._crosstabConstants.Vertical,this._isPageable=this._scrollBarType!==this._crosstabConstants.RowAxisHeader,this._crosstabElementResizedEventConstants=new sap.basetable.crosstab.CrosstabElementResizedEventConstants,this._positionMap=[],this._bodyScrollableProps={"width":0}},sap.basetable.crosstab.CrosstabScrollBar.prototype={"_ScrollBarContainer":null,"_ScrollBarContainerSpan":null,"_ScrollBarTrack":null,"_ScrollBarTrackPiece":null,"_bodyContainer":null,"_bodyScrollable":null,"_headerContainer":null,"_headerScrollable":null,"_floatingHeadersScrollable":null,"_parentContainerSize":null,"_scrollableContentSize":null,"_scrollBarSize":null,"_pagingRequestLimit":null,"_nextPageEventFired":!1,"_axisIndex":0,"_scrollbarStepAmount":0,"_totalScrollBarSteps":null,"_scrollableContent":null,"_fullAxisLength":null,"_fullAxisLengthPixels":null,"_pageSize":null,"_pageSizeInPixels":null,"_startPageIndex":null,"_endPageIndex":null,"_previousPosition":null,"_currentStartIndex":null,"_atLastPage":!1,"_atFirstPage":!1,"_scrollBarMinSize":15,"_showEnd":!1,"_touchScrollData":{"startX":null,"startY":null,"endX":null,"endY":null},"_hideFloatingHeader":!1,"_isNewIdCellEntirelyVisible":!1,"_firstVisibleCell":null,"_floatedHeaderPositionChanged":!1,"_HIDE_HEADER":"crosstab-Cell-Under-Floating-Header","_MINIMUM_FLOATING_HEADER_WIDTH":16,"_MINUMUM_VISIBILITY":1.5},sap.basetable.crosstab.CrosstabScrollBar.prototype.initializeScrollBar=function(t,e,s,a,r,o){this._isPageable&&(this._setFullAxisLength(s),this._setFullAxisLengthPixels(),this._setPageSize(a),this._setPageSizeInPixels()),this._setBodyScrollable(t.bodyContent),this._setBodyScrollableProps(t.bodyContent),this._setBodyContainer(t.bodyContainer),this._setHeaderScrollable(t.headerContent),this._setHeaderContainer(t.headerContainer),t.floatingHeaders&&this.setScrollableFloatingHeaders(t.floatingHeaders),this._setScrollableContent(),this._setupScrollBar(e.Top,e.Left),this._setPositions(r),this._calculatePositionMap(),null!==o.eventData?(this._setShowEnd(o.eventData.showEnd),this.updateFromExternalEvent(o)):this._isPageable&&(this._setEndPageIndex(),this._setStartPageIndex(),this._setCurrentStartIndex()),this._setMouseWheelEvent($(t.bodyContainer).add(t.headerContainer).add(this._ScrollBarContainer)),this._setScrollBarTouchEvents(),this._updateFloatedHeaders(),this._registerCrosstabTouchEvent()},sap.basetable.crosstab.CrosstabScrollBar.prototype._registerCrosstabTouchEvent=function(){var t;switch(this._scrollBarType){case this._crosstabConstants.Horizontal:t=this._crosstabScrollBarEventConstants.touchCrosstabHorizontalScrollBarEvent;break;case this._crosstabConstants.Vertical:t=this._crosstabScrollBarEventConstants.touchCrosstabVerticalScrollBarEvent;break;case this._crosstabConstants.RowAxisHeader:t=this._crosstabScrollBarEventConstants.touchCrosstabRowAxisScrollBarEvent;break;default:throw"Invalid Crosstab Touch Event Type"}this._crosstabScrollBarEventMediator.subscribe(t,this._doTouchScroll.bind(this))},sap.basetable.crosstab.CrosstabScrollBar.prototype._doTouchScroll=function(t){this._crosstab.getCrosstabElementResizeHandler().getResizedState()||(this._atLastPage=this._isLastPage(),this._atFirstPage=this._isFirstPage(),this._adjustIndexUpOrDown(t.scrollBarAction===this._crosstabConstants.DecreaseAxis),t.direction===this._crosstabConstants.Vertical?this._updateScrollPositionAndContent(this._crosstabConstants.PositionTop):this._updateScrollPositionAndContent(this._crosstabConstants.PositionLeft),this._isRowScrollScroll?this._doHorizontalPaging():this._isVerticalScrolling&&this._doVerticalPaging())},sap.basetable.crosstab.CrosstabScrollBar.prototype._setScrollBarTouchEvents=function(){window.TouchEvent&&$(this._ScrollBarTrackPiece).bind("touchstart touchmove touchend",function(t){this._handleScrollBarTouch(t)}.bind(this))},sap.basetable.crosstab.CrosstabScrollBar.prototype._handleScrollBarTouch=function(t){var e,s=t.changedTouches[0];switch(t.type){case"touchstart":e="mousedown";break;case"touchmove":e="mousemove";break;case"touchend":e="mouseup"}var a=document.createEvent("MouseEvent");a.initMouseEvent(e,!0,!0,window,1,s.screenX,s.screenY,s.clientX,s.clientY,!1,!1,!1,!1,0,null),s.target.dispatchEvent(a)},sap.basetable.crosstab.CrosstabScrollBar.prototype._setFullAxisLength=function(t){this._fullAxisLength=t},sap.basetable.crosstab.CrosstabScrollBar.prototype._setFullAxisLengthPixels=function(){if(this._isHorizontalScrolling){var t=this._crosstab.model().getResizedElements(0),e=this._crosstab.model().getDimensions(1),s=0,a=0,r=0;for(var o in t){var i=this._crosstab.model().getTupleIndex(1,o);(i&&e.length===this._crosstab.model().getTupleDepth(o)||0===e.length&&o===this._crosstabElementResizedEventConstants.emptyColumnDimension)&&(a=t[o],r+=a?a:0,s++)}this._fullAxisLengthPixels=(this._fullAxisLength-s)*this._scrollableCellAmount+r}else this._fullAxisLengthPixels=this._fullAxisLength*this._scrollableCellAmount},sap.basetable.crosstab.CrosstabScrollBar.prototype._setPageSize=function(t){this._pageSize=t},sap.basetable.crosstab.CrosstabScrollBar.prototype._setPageSizeInPixels=function(){this._pageSizeInPixels=this._pageSize*this._scrollableCellAmount},sap.basetable.crosstab.CrosstabScrollBar.prototype._setBodyScrollable=function(t){this._bodyScrollable=t,$(t).addClass("crosstab-scrollableContent")},sap.basetable.crosstab.CrosstabScrollBar.prototype._setBodyScrollableProps=function(t){this._bodyScrollableProps.width=parseInt(t[0].style.width,10)},sap.basetable.crosstab.CrosstabScrollBar.prototype._setBodyContainer=function(t){this._bodyContainer=t,$(t).addClass("crosstab-scrollableContainer")},sap.basetable.crosstab.CrosstabScrollBar.prototype._setHeaderScrollable=function(t){this._headerScrollable=t,$(t).addClass("crosstab-scrollableContent")},sap.basetable.crosstab.CrosstabScrollBar.prototype._setHeaderContainer=function(t){this._headerContainer=t,$(t).addClass("crosstab-scrollableContainer")},sap.basetable.crosstab.CrosstabScrollBar.prototype.setScrollableFloatingHeaders=function(t){this._floatingHeadersScrollable=t},sap.basetable.crosstab.CrosstabScrollBar.prototype._setScrollableContent=function(){this._scrollableContent=$(this._bodyScrollable).add(this._headerScrollable),this._floatingHeadersScrollable&&(this._scrollableContent=this._scrollableContent.add(this._floatingHeadersScrollable))},sap.basetable.crosstab.CrosstabScrollBar.prototype._setPositions=function(t){this._setCSSForScrollableContent(t),this.setCSSForTrackPiece(t),this.setCSSForFloatingHeaders(),this.setCSSForContainers()},sap.basetable.crosstab.CrosstabScrollBar.prototype._setCSSForScrollableContent=function(t){$(this._scrollableContent).css({"position":"absolute"});var e;t===!0?e=0:t===!1?(this._setShowEnd(!0),e=this._scrollableContentSize-this._parentContainerSize):e=this._getScrollableContentPosition(),this._isVerticalScrolling?$(this._scrollableContent).css({"top":-e}):$(this._scrollableContent).css({"left":-e})},sap.basetable.crosstab.CrosstabScrollBar.prototype._setShowEnd=function(t){this._showEnd!==t&&this._isPageable&&this._crosstabScrollBarEventMediator.publish(this._crosstabScrollBarEventConstants.borderEvent,this._isVerticalScrolling),this._showEnd=t},sap.basetable.crosstab.CrosstabScrollBar.prototype.getShowEnd=function(){return this._showEnd},sap.basetable.crosstab.CrosstabScrollBar.prototype.setCSSForFloatingHeaders=function(){this._floatingHeadersScrollable&&$(this._floatingHeadersScrollable).css({"top":0})},sap.basetable.crosstab.CrosstabScrollBar.prototype.setCSSForContainers=function(){$(this._headerContainer).css({"position":"relative","overflow":"hidden"}),$(this._bodyContainer).css({"position":"relative","overflow":"hidden"})},sap.basetable.crosstab.CrosstabScrollBar.prototype.setCSSForTrackPiece=function(t){var e=t?0:this._parentContainerSize-this._scrollBarSize;this._isVerticalScrolling?$(this._ScrollBarTrackPiece).css({"top":e}):$(this._ScrollBarTrackPiece).css({"left":e})},sap.basetable.crosstab.CrosstabScrollBar.prototype._setupScrollBar=function(t,e){this.setupContainer(),this.setScrollBarSizeRelativeToContent(),this.setupTrack(t,e),this.setupTrackPiece(),this._ScrollBarTrack.append(this._ScrollBarTrackPiece),this._ScrollBarContainerSpan.append(this._ScrollBarTrack)},sap.basetable.crosstab.CrosstabScrollBar.prototype.setupContainer=function(){this._ScrollBarContainer=$(document.createElement("div")),this._ScrollBarContainerSpan=$(document.createElement("span")),this._ScrollBarContainer.append(this._ScrollBarContainerSpan),this._ScrollBarContainer.addClass("crosstab-scroll")},sap.basetable.crosstab.CrosstabScrollBar.prototype.setupTrack=function(t,e){this._ScrollBarTrack=$(document.createElement("div"));var s="top: "+t+"px; left: "+e+"px;",a=this._parentContainerSize+"px";this._isVerticalScrolling?(s+="position: absolute; border-radius: 2.5px; width: 20px;height: "+a,$(this._ScrollBarTrack).addClass("vertical-Scroll-Bar-Track")):(s+="position: absolute; border-radius: 2.5px; height: 20px;width: "+a,$(this._ScrollBarTrack).addClass("horizontal-Scroll-Bar-Track")),this._ScrollBarTrack.attr("style",s),$(this._ScrollBarTrack).click(function(t){if(!$(this._bodyScrollable).is(":animated")&&!$(this._ScrollBarTrackPiece).is(":animated")&&!$(this._headerScrollable).is(":animated")){var e=this._ScrollBarTrack.context,s=this._ScrollBarTrackPiece.context,a=s.offsetTop,r=s.offsetLeft;t.target===e&&(this._isVerticalScrolling&&(a>t.offsetY||t.offsetY>s.offsetHeight+a)?this._doVerticalClickScroll(t,s.offsetTop,s.offsetHeight):!this._isVerticalScrolling&&(r>t.offsetX||t.offsetX>s.offsetWidth+r)&&this._doHorizontalClickScroll(t,s.offsetWidth,s.offsetLeft))}}.bind(this))},sap.basetable.crosstab.CrosstabScrollBar.prototype.enforceMinScrollbarHeight=function(){var t=0;return this._scrollBarSize<this._scrollBarMinSize&&(t=this._scrollBarMinSize-this._scrollBarSize,this._scrollBarSize=this._scrollBarMinSize),t},sap.basetable.crosstab.CrosstabScrollBar.prototype.setScrollBarSizeRelativeToContent=function(){var t=0;this._isVerticalScrolling?(this._scrollableContentSize=this._isPageable?this._fullAxisLengthPixels:$(this._bodyScrollable).outerHeight(!0),this._parentContainerSize=$(this._bodyContainer).innerHeight(),this._scrollBarSize=this._parentContainerSize/(this._scrollableContentSize/this._parentContainerSize),t=this.enforceMinScrollbarHeight()):(this._scrollableContentSize=this._isPageable?this._fullAxisLengthPixels:$(this._bodyScrollable).outerWidth(!0),this._parentContainerSize=$(this._bodyContainer).innerWidth(),this._scrollBarSize=this._parentContainerSize/(this._scrollableContentSize/this._parentContainerSize),t=this.enforceMinScrollbarHeight()),this._setScrollBarStepAmount(t),this._setScrollBarTotalSteps()},sap.basetable.crosstab.CrosstabScrollBar.prototype._setScrollBarStepAmount=function(t){this._scrollBarStepAmount=this._scrollableCellAmount/(this._scrollableContentSize/(this._parentContainerSize-t))},sap.basetable.crosstab.CrosstabScrollBar.prototype._setScrollBarTotalSteps=function(){var t=this._scrollableContentSize-this._parentContainerSize;this._totalScrollBarSteps=Math.floor(t/this._scrollableCellAmount)},sap.basetable.crosstab.CrosstabScrollBar.prototype._setEndPageIndex=function(t){var e=Math.floor(this._parentContainerSize/this._scrollableCellAmount);t?(this._endPageIndex=t-e,this._fullAxisLength<this._pageSize?this._endPageIndex=this._totalScrollBarSteps+1:this._endPageIndex>=this._totalScrollBarSteps&&!this._atLastPage?this._endPageIndex=this._totalScrollBarSteps:this._endPageIndex>=this._totalScrollBarSteps&&this._atLastPage&&(this._endPageIndex=this._totalScrollBarSteps+1)):this._fullAxisLength>this._pageSize?(t=this._pageSize-e,this._endPageIndex=Math.min(t,this._totalScrollBarSteps)):this._endPageIndex=this._totalScrollBarSteps+1},sap.basetable.crosstab.CrosstabScrollBar.prototype._setStartPageIndex=function(t){t?(this._startPageIndex=t,this._fullAxisLength<this._pageSize?this._startPageIndex=-1:0>=this._startPageIndex&&!this._atFirstPage?this._startPageIndex=0:0>=this._startPageIndex&&this._atFirstPage&&(this._startPageIndex=-1)):this._startPageIndex=-1},sap.basetable.crosstab.CrosstabScrollBar.prototype.getContainer=function(){return this._ScrollBarContainer},sap.basetable.crosstab.CrosstabScrollBar.prototype.setupTrackPiece=function(){this._ScrollBarTrackPiece=$(document.createElement("div"));var t="";this._isVerticalScrolling?(t+="background: #9d9c9c; position: absolute !important; border-radius: 2.5px; top: 0px; right: 5px; width: 7px;",t+="height: "+this._scrollBarSize+"px;",$(this._ScrollBarTrackPiece).addClass("vertical-Scroll-Bar-Track-Piece"),$(this._ScrollBarTrackPiece).draggable({"axis":"y","containment":"parent","drag":this._doVerticalStepScroll.bind(this),"stop":this._doVerticalStepScroll.bind(this)})):(t+="background: #9d9c9c; border-radius: 2.5px; position: absolute !important; left: 0px; bottom: 5px; height: 7px;",t+="width: "+this._scrollBarSize+"px;",$(this._ScrollBarTrackPiece).addClass("horizontal-Scroll-Bar-Track-Piece"),$(this._ScrollBarTrackPiece).draggable({"axis":"x","containment":"parent","drag":this._doHorizontalStepScroll.bind(this),"stop":this._doHorizontalStepScroll.bind(this)})),this._ScrollBarTrackPiece.attr("style",t)},sap.basetable.crosstab.CrosstabScrollBar.prototype._setMouseWheelEvent=function(t){$(t).bind("wheel",function(t){var e=this._isWheelScrollVertical(t);this._atLastPage=this._isLastPage(),this._atFirstPage=this._isFirstPage(),this._isVerticalScrolling&&e?(this._adjustIndexUpOrDown(0>t.originalEvent.deltaY),this._updateScrollPositionAndContent(this._crosstabConstants.PositionTop)):this._isVerticalScrolling||e||(this._adjustIndexUpOrDown(0>t.originalEvent.deltaX),this._updateScrollPositionAndContent(this._crosstabConstants.PositionLeft)),this._isPageable&&this._isVerticalScrolling&&e?this._doVerticalPaging():!this._isPageable||this._isVerticalScrolling||e||this._doHorizontalPaging()}.bind(this))},sap.basetable.crosstab.CrosstabScrollBar.prototype._isWheelScrollVertical=function(t){return Math.abs(t.originalEvent.deltaX)<Math.abs(t.originalEvent.deltaY)},sap.basetable.crosstab.CrosstabScrollBar.prototype._adjustIndexUpOrDown=function(t){t?(this._setAxisIndex(this._axisIndex-1),this._setShowEnd(!1)):(this._checkShowEnd(),this._setAxisIndex(this._axisIndex+1))},sap.basetable.crosstab.CrosstabScrollBar.prototype._updateScrollPositionAndContent=function(t){this._updateScrollBarTrackPiecePosition(t),this._updateScrollableContentPosition(t)},sap.basetable.crosstab.CrosstabScrollBar.prototype._doVerticalStepScroll=function(){var t=$(this._ScrollBarTrackPiece).position().top/this._crosstab.getScaleFactor(),e=Math.round(t+$(this._ScrollBarTrackPiece).outerHeight(!0));e===this._parentContainerSize?this._setShowEnd(!0):this._setShowEnd(!1);var s=Math.round(t/this._scrollBarStepAmount);this._setAxisIndex(s),this._atLastPage=this._isLastPage(),this._atFirstPage=this._isFirstPage(),this._updateScrollableContentPosition(this._crosstabConstants.PositionTop),this._doVerticalPaging()},sap.basetable.crosstab.CrosstabScrollBar.prototype._doHorizontalStepScroll=function(){var t=$(this._ScrollBarTrackPiece).position().left/this._crosstab.getScaleFactor(),e=Math.round(t+$(this._ScrollBarTrackPiece).outerWidth(!0));e===this._parentContainerSize?this._setShowEnd(!0):this._setShowEnd(!1);var s=Math.round(t/this._scrollBarStepAmount);this._setAxisIndex(s),this._atLastPage=this._isLastPage(),this._atFirstPage=this._isFirstPage(),this._updateScrollableContentPosition(this._crosstabConstants.PositionLeft),this._doHorizontalPaging()},sap.basetable.crosstab.CrosstabScrollBar.prototype._doVerticalClickScroll=function(t,e,s){e>t.offsetY?(this._setAxisIndex(this._axisIndex-1),this._setShowEnd(!1)):t.offsetY>e+s&&(this._checkShowEnd(),this._setAxisIndex(this._axisIndex+1)),this._atLastPage=this._isLastPage(),this._atFirstPage=this._isFirstPage(),this._doScrollAnimation(this._crosstabConstants.PositionTop),this._doVerticalPaging()},sap.basetable.crosstab.CrosstabScrollBar.prototype._doHorizontalClickScroll=function(t,e,s){s>t.offsetX?(this._setAxisIndex(this._axisIndex-1),this._setShowEnd(!1)):t.offsetX>e+s&&(this._checkShowEnd(),this._setAxisIndex(this._axisIndex+1)),this._atLastPage=this._isLastPage(),this._atFirstPage=this._isFirstPage(),this._doScrollAnimation(this._crosstabConstants.PositionLeft),this._doHorizontalPaging()},sap.basetable.crosstab.CrosstabScrollBar.prototype._checkShowEnd=function(){this._axisIndex===this._totalScrollBarSteps&&this._setShowEnd(!0)},sap.basetable.crosstab.CrosstabScrollBar.prototype._doScrollAnimation=function(t){var e={},s={},a=this._getScrollBarPosition(),r=this._getScrollableContentPosition();e[t]=-r,s[t]=a,$(this._scrollableContent).animate(e,"fast"),$(this._ScrollBarTrackPiece).animate(s,"fast"),this._floatedHeaders.length>0&&this._updateFloatedHeaders()},sap.basetable.crosstab.CrosstabScrollBar.prototype._updateScrollableContentPosition=function(t){var e=this._getScrollableContentPosition(),s={};s[t]=-e,$(this._scrollableContent).css(s),this._floatedHeaders.length>0&&this._updateFloatedHeaders()},sap.basetable.crosstab.CrosstabScrollBar.prototype._updateScrollBarTrackPiecePosition=function(t){var e,s={};e=this._getScrollBarPosition(),s[t]=e,$(this._ScrollBarTrackPiece).css(s)},sap.basetable.crosstab.CrosstabScrollBar.prototype._getScrollableContentPosition=function(){return this._showEnd?this._isVerticalScrolling?parseInt(this._bodyScrollable[0].style.height,10)-this._parentContainerSize:parseInt(this._bodyScrollable[0].style.width,10)-this._parentContainerSize:this._isPageable?this._isHorizontalScrolling?this._getScrollableContentPositionFromAxisIndex():(this._axisIndex-this._currentStartIndex)*this._scrollableCellAmount:this._getScrollableContentPositionFromAxisIndex()},sap.basetable.crosstab.CrosstabScrollBar.prototype._getScrollableContentPositionFromAxisIndex=function(){var t=this._positionMap[this._axisIndex];return Math.min(t,this._bodyScrollableProps.width-this._parentContainerSize-1)},sap.basetable.crosstab.CrosstabScrollBar.prototype._getScrollBarPosition=function(){return this._showEnd?this._parentContainerSize-this._scrollBarSize:this._axisIndex*this._scrollBarStepAmount},sap.basetable.crosstab.CrosstabScrollBar.prototype._doVerticalPaging=function(){this._isPageable&&(this._crosstab.model().setVerticalScrollPosition(this._axisIndex),(this._axisIndex>=this._endPageIndex||this._axisIndex<=this._startPageIndex)&&this._crosstabScrollBarEventMediator.publish(this._crosstabScrollBarEventConstants.nextPageEvent,this._getPageData()))},sap.basetable.crosstab.CrosstabScrollBar.prototype._doHorizontalPaging=function(){this._isPageable&&(this._crosstab.model().setHorizontalScrollPosition(this._axisIndex),(this._axisIndex>=this._endPageIndex||this._axisIndex<=this._startPageIndex)&&this._crosstabScrollBarEventMediator.publish(this._crosstabScrollBarEventConstants.nextPageEvent,this._getPageData()))
},sap.basetable.crosstab.CrosstabScrollBar.prototype._isLastPage=function(){return this._axisIndex>=this._totalScrollBarSteps?!0:!1},sap.basetable.crosstab.CrosstabScrollBar.prototype._isFirstPage=function(){return 0===this._axisIndex?!0:!1},sap.basetable.crosstab.CrosstabScrollBar.prototype._clearFloatedHeader=function(t){this._floatedHeaders[t].$headerDom.text(""),this._floatedHeaders[t].$headerDom.attr("title",""),this._floatedHeaders[t].referenceId=null,this._floatedHeaders[t].lastCellParsed&&$(this._floatedHeaders[t].lastCellParsed[0].childNodes[0]).css({"opacity":"1"}),this._floatedHeaders[t].lastCellParsed=null},sap.basetable.crosstab.CrosstabScrollBar.prototype._updateFloatedHeaders=function(){var t,e,s,a;if(this._floatedHeaders.length>0){var r=this._getHeaderTupleIds();if(void 0!==r.tupleIndex){this._showEnd&&(t=this._crosstab.container().closest(".sapUI5Crosstab"),this._isHorizontalScrolling?(e="columnHeaderCell-Content",s=t.find("div#"+e).offset().left):(e="rowAxisHeader-Content",s=t.find("#bottomRow").offset().top));for(var o=r.tupleIndex.length-1;o>=0;o--){for(var i=r.prefix,n=0;o>=n;n++)i=i+"_"+r.tupleIndex[n];if(this._showEnd){a=t.find("#"+i);var l=this._crosstab.getScaleFactor();this._setFloatingHeaderPosition(a,o,s,l),this._hideFloatingHeader=this._isHorizontalScrolling&&a.cellSize*a.visibility<=this._MINIMUM_FLOATING_HEADER_WIDTH}var c=!0;if(this._floatedHeaders[o].lastCellParsed&&(c=this._floatedHeaders[o].lastCellParsed.is(":visible")),this._floatedHeaders[o].referenceId===i&&c&&(!this._showEnd||this._isNewIdCellEntirelyVisible))break;this._resetFloatingHeader(o,i)}if(!this._showEnd&&this._floatedHeaderPositionChanged){for(o=r.tupleIndex.length-1;o>=0;o--)this._resetFloatingHeaderPosition(o);this._floatedHeaderPositionChanged=!1}}}this._showEnd||this._updateFloatedHeadersSize()},sap.basetable.crosstab.CrosstabScrollBar.prototype._setCellProperties=function(t,e,s){this._isHorizontalScrolling?(t.position=t.offset().left,t.cellSize=t.width()*s):(t.position=t.offset().top,t.cellSize=t.height()*s),t.visibility=1-(e-t.position)/t.cellSize},sap.basetable.crosstab.CrosstabScrollBar.prototype._setFloatingHeaderPosition=function(t,e,s,a){if(this._isHorizontalScrolling)this._setCellProperties(t,s,a),this._floatedHeaders[e].$headerDom.css({"width":t.cellSize*t.visibility});else if(t.height()*a-(s-t.offset().top)<this._crosstab.getRowCellHeight()*a){this._setCellProperties(this._firstVisibleCell,s,a);var r=this._firstVisibleCell.cellSize-this._firstVisibleCell.cellSize*this._firstVisibleCell.visibility;this._floatedHeaders[e].$headerDom.css({"top":-r+"px"}),this._floatedHeaderPositionChanged=!0}else this._floatedHeaders[e].$headerDom.css({"top":"0px"})},sap.basetable.crosstab.CrosstabScrollBar.prototype._resetFloatingHeaderPosition=function(t){this._isHorizontalScrolling?this._floatedHeaders[t].$headerDom.css({"left":"0px"}):this._floatedHeaders[t].$headerDom.css({"top":"0px"})},sap.basetable.crosstab.CrosstabScrollBar.prototype._updateFloatedHeadersSize=function(){if(this._isHorizontalScrolling&&this._floatedHeaders.length>0){var t=this._getHeaderTupleIds();if(void 0!==t.tupleIndex)for(var e=t.prefix,s=t.prefix.split("-")[0]+"-ColumnHeader-LeafChild",a=t.tupleIndex.length-1,r=0;a>=r;r++){e=e+"_"+t.tupleIndex[r];for(var o=e,i=0;a-r>=i;i++)o+="_0";for(var n=$("#"+o+"-div")[0],l=0,c=0;n.classList.length-1>=c;c++)if(n.classList[c].indexOf(s)>=0){l=n.classList[c].split(s)[1]-1;break}var d=this._positionMap[this.getAxisIndex()],b=d-this._positionMap[l],h=parseInt($("#"+e)[0].style.width)-b;this._floatedHeaders[r].$headerDom.css({"width":h})}}},sap.basetable.crosstab.CrosstabScrollBar.prototype.getFloatedHeaders=function(){return this._floatedHeaders},sap.basetable.crosstab.CrosstabScrollBar.prototype._getHeaderTupleIds=function(){var t,e,s,a;return t=this._isVerticalScrolling?"."+this._crosstab.getId()+"-RowAxisHeader-LeafChild":"."+this._crosstab.getId()+"-ColumnHeader-LeafChild",a=this._showEnd?this._findCurrentLeaf(t):$(t+(this._axisIndex+1)),a.length>0&&(s=a[0].id.split("_"),e=s[0],s.splice(0,1),s.splice(-1,1)),{"prefix":e,"tupleIndex":s}},sap.basetable.crosstab.CrosstabScrollBar.prototype._findCurrentLeaf=function(t){var e,s,a,r=this._crosstab.container().closest(".sapUI5Crosstab");this._isVerticalScrolling?(e=r.find(".crosstab-dimensionHeaderCell").last(),s=r.find("#bottomRow").offset().top):(e=r.find(".crosstab-ColumnHeaderCell").last(),s=r.find("#columnHeaderCell-Content").offset().left,0===s&&(s=r.find("#rowAxisContent-Container").offset().left));for(var o,i=0;e[0].classList.length>i;i++)if(e[0].classList[i].indexOf("LeafChild")>-1){o=parseInt(e[0].classList[i].split("LeafChild")[1]);break}for(i=o;i>=0&&(a=$(t+i),!(this._isVerticalScrolling&&s>a.offset().top||this._isHorizontalScrolling&&s>a.offset().left));i--);this._firstVisibleCell=a;var n;return n=this._isVerticalScrolling?a.offset().top:a.offset().left,this._isNewIdCellEntirelyVisible=this._MINUMUM_VISIBILITY>s-n,a},sap.basetable.crosstab.CrosstabScrollBar.prototype._resetFloatingHeader=function(t,e){this._floatedHeaders[t].referenceId=e;var s=$("#"+e),a=$(s[0].childNodes[0]);a.removeClass(this._HIDE_HEADER);var r=a.attr("class");a.addClass(this._HIDE_HEADER);var o=s.text();if(this._floatedHeaders[t].$headerDom.text(o),this._floatedHeaders[t].$headerDom.attr("class","crosstab-FloatingCell "+r),this._floatedHeaders[t].$headerDom.attr("title",o),this._floatedHeaders[t].lastCellParsed&&!this._showEnd){var i=this._floatedHeaders[t].lastCellParsed.attr("id"),n=$("#"+i);n.length>0&&$(n[0].childNodes[0]).removeClass(this._HIDE_HEADER)}this._hideFloatingHeader&&this._floatedHeaders[t].$headerDom.addClass(this._HIDE_HEADER),this._floatedHeaders[t].lastCellParsed=s},sap.basetable.crosstab.CrosstabScrollBar.prototype.resetCellOpacityUnderFloatingHeader=function(){for(var t=0;this._floatedHeaders.length>=t;t++){var e=this._floatedHeaders[t];if(void 0!==e&&void 0!==e.referenceId){var s=$("#"+e.referenceId);if(void 0!==s[0]&&!this._showEnd){$(s[0].childNodes[0]).addClass("crosstab-Cell-Under-Floating-Header");var a=s.text();e.$headerDom.text(a),e.$headerDom.attr("title",a)}}}},sap.basetable.crosstab.CrosstabScrollBar.prototype._calculatePositionMap=function(){if(this._positionMap=[],this._cumulativePosition=0,this._isPageable){var t=this._crosstab.model().getTupleTree(1).rootnode,e=this._crosstab.model().getStartColumnIndex();this._calculatePositionMapFromTuple(t,e)}else this._calculatePositionMapFromDimensions()},sap.basetable.crosstab.CrosstabScrollBar.prototype._calculatePositionMapFromTuple=function(t,e){for(var s=this._crosstab.model().getResizedElements(0),a=0;t.children.length>a;a++){var r=t.children[a];r.children.length>0?e=this._calculatePositionMapFromTuple(r,e):(e++,this._positionMap[e-1]=this._cumulativePosition,this._cumulativePosition+=s[r.tuplePath]?s[r.tuplePath]:this._crosstab.getCellWidth())}return e},sap.basetable.crosstab.CrosstabScrollBar.prototype._calculatePositionMapFromDimensions=function(){for(var t=this._crosstab.model().getDimensions(0),e=this._crosstab.model().getResizedElements(1),s=0;t.length>s;s++){this._positionMap[s]=this._cumulativePosition;var a=t[s].id;this._cumulativePosition+=e[a]?e[a]:this._crosstab.getRowCellWidth()}},sap.basetable.crosstab.CrosstabScrollBar.prototype.updateFromExternalEvent=function(t){var e=this._getUpdateHandler(t.type);e.apply(this,[t])},sap.basetable.crosstab.CrosstabScrollBar.prototype._getUpdateHandler=function(t){var e;return t===this._crosstabScrollBarEventConstants.updateAxisLength?e=this._updateAxisLengthEvent:t===this._crosstabScrollBarEventConstants.conditionalFormatEvent?e=this._conditionalFormatEvent:t===this._crosstabScrollBarEventConstants.newPageEvent?e=this._newPageEvent:t===this._crosstabScrollBarEventConstants.windowResize?e=this._windowResizeEvent:t===this._crosstabScrollBarEventConstants.newSectionEvent&&(e=this._newSectionEvent),e},sap.basetable.crosstab.CrosstabScrollBar.prototype._newPageEvent=function(t){if(this._updateScrollableAreas(t),this._isPageable){var e,s,a;this._isVerticalScrolling?(a=t.eventData.coordinates.startRowIndex,e=t.eventData.coordinates.endRowIndex,s=t.eventData.coordinates.startRowIndex):(a=t.eventData.coordinates.startColumnIndex,e=t.eventData.coordinates.endColumnIndex,s=t.eventData.coordinates.startColumnIndex),this._setEndPageIndex(e),this._setStartPageIndex(s),this._setCurrentStartIndex(a)}this._calculatePositionMap(),this._setScrollableContent(),this._setCSSForScrollableContent(),this._floatedHeaders.length>0&&this._updateFloatedHeaders()},sap.basetable.crosstab.CrosstabScrollBar.prototype._conditionalFormatEvent=function(t){this._setBodyScrollable(t.containers.rowAxisContentContent),this._setScrollableContent(),this._setCSSForScrollableContent(),this._floatedHeaders.length>0&&this._updateFloatedHeaders()},sap.basetable.crosstab.CrosstabScrollBar.prototype._newSectionEvent=function(t){this._updateScrollableAreas(t),this._isPageable&&this._isHorizontalScrolling&&this._crosstab.isHorizontallyScrollable()&&(this._setEndPageIndex(t.eventData.coordinates.endColumnIndex),this._setStartPageIndex(t.eventData.coordinates.startColumnIndex),this._setCurrentStartIndex(t.eventData.coordinates.startColumnIndex)),this._calculatePositionMap(),this._setScrollableContent(),this._setCSSForScrollableContent(),this._floatedHeaders.length>0&&this._updateFloatedHeaders()},sap.basetable.crosstab.CrosstabScrollBar.prototype._windowResizeEvent=function(t){this._setAxisIndex(t.eventData.currentPosition),this._isPageable&&(this._setCurrentStartIndex(t.eventData.currentStartIndex),this._setEndPageIndex(t.eventData.endPageIndex),this._setStartPageIndex(t.eventData.startPageIndex));var e;e=this._isVerticalScrolling?this._crosstabConstants.PositionTop:this._crosstabConstants.PositionLeft,this._updateScrollPositionAndContent(e)},sap.basetable.crosstab.CrosstabScrollBar.prototype._updateAxisLengthEvent=function(t){var e;this._setFullAxisLength(t.eventData.length),this._setFullAxisLengthPixels(),this.setScrollBarSizeRelativeToContent(),this._updateScrollBarSize(),e=this._isVerticalScrolling?this._crosstabConstants.PositionTop:this._crosstabConstants.PositionLeft,this._updateScrollPositionAndContent(e),this._floatedHeaders.length>0&&this._updateFloatedHeaders()},sap.basetable.crosstab.CrosstabScrollBar.prototype._updateScrollableAreas=function(t){this._isVerticalScrolling?(this._setHeaderScrollable(t.containers.rowAxisHeaderContent),this._setBodyScrollable(t.containers.rowAxisContentContent)):!this._isVerticalScrolling&&this._isPageable?(this._setHeaderScrollable(t.containers.columnHeaderContent),this._setBodyScrollable(t.containers.rowAxisContentContent)):this._isVerticalScrolling||this._isPageable||this._setBodyScrollable(t.containers.rowAxisHeaderContent)},sap.basetable.crosstab.CrosstabScrollBar.prototype._updateScrollBarSize=function(){this._isVerticalScrolling?$(this._ScrollBarTrackPiece).height(this._scrollBarSize):$(this._ScrollBarTrackPiece).width(this._scrollBarSize)},sap.basetable.crosstab.CrosstabScrollBar.prototype._setCurrentStartIndex=function(t){this._currentStartIndex=t?t:0},sap.basetable.crosstab.CrosstabScrollBar.prototype._getPageData=function(){var t={"redrawRowAxisHeader":null,"redrawRowAxisContent":null,"redrawColumnHeader":null,"coordinates":{"startRowIndex":null,"startColumnIndex":null,"endRowIndex":null,"endColumnIndex":null}};return this._isVerticalScrolling?(t.redrawRowAxisHeader=!0,t.redrawRowAxisContent=!0,t.redrawColumnHeader=!1):(t.redrawRowAxisHeader=!1,t.redrawRowAxisContent=!0,t.redrawColumnHeader=!0),t},sap.basetable.crosstab.CrosstabScrollBar.prototype.getAxisIndex=function(){return this._axisIndex},sap.basetable.crosstab.CrosstabScrollBar.prototype._setAxisIndex=function(t){t>this._totalScrollBarSteps?this._axisIndex=this._totalScrollBarSteps:t>=0&&(this._axisIndex=t)},sap.basetable.crosstab.CrosstabScrollBar.prototype.getCurrentStartIndex=function(){return this._currentStartIndex},sap.basetable.crosstab.CrosstabScrollBar.prototype.getEndPageIndex=function(){return this._endPageIndex},sap.basetable.crosstab.CrosstabScrollBar.prototype.getStartPageIndex=function(){return this._startPageIndex},sap.basetable.crosstab.CrosstabScrollBar.prototype.getIsPageable=function(){return this._isPageable},jQuery.sap.declare("sap.basetable.crosstab.CrosstabScrollBarController"),sap.basetable.crosstab.CrosstabScrollBarController=function(t,e,s){this._crosstab=t,this._crosstabContainers=this._crosstab.crosstabContainers(),this._crosstabScrollBarEventMediator=e,this._crosstabScrollBarEventConstants=s,this._crosstabConstants=new sap.basetable.crosstab.CrosstabConstants},sap.basetable.crosstab.CrosstabScrollBarController.prototype={"_horizontalScrollBar":null,"_verticalScrollBar":null,"_rowAxisHeaderScrollBar":null,"_touchScrollData":{"startX":null,"startY":null,"endX":null,"endY":null}},sap.basetable.crosstab.CrosstabScrollBarController.prototype.draw=function(t,e){var s;if(e.horizontalScrollBar){var a=this._getScrollData(t,this._horizontalScrollBar);s=this.getScrollBarUpdateData(this._crosstabScrollBarEventConstants.windowResize,a),this.addHorizontalScrollBar(e.isVerticallyScrollable,s)}else this._horizontalScrollBar=null;if(e.verticalScrollBar){var r=this._getScrollData(t,this._verticalScrollBar);s=this.getScrollBarUpdateData(this._crosstabScrollBarEventConstants.windowResize,r),this.addVerticalScrollBar(e.horizontalScrollBar,s)}else this._verticalScrollBar=null;if(e.rowAxisHeaderScrollBar){var o=this._getScrollData(t,this._rowAxisHeaderScrollBar);s=this.getScrollBarUpdateData(this._crosstabScrollBarEventConstants.windowResize,o),this.addRowAxisHeaderScrollBar(e.isVerticallyScrollable,s)}else this._rowAxisHeaderScrollBar=null},sap.basetable.crosstab.CrosstabScrollBarController.prototype.attachCrosstabTouchEvents=function(t){t.horizontalScrollBar&&this._setCrosstabTouchEvents($(this._crosstabContainers.getRowAxisContentContainer(),this._crosstabContainers.getColumnHeaderContainer())),t.verticalScrollBar&&this._setCrosstabTouchEvents($(this._crosstabContainers.getRowAxisContentContainer(),this._crosstabContainers.getRowAxisHeaderContainer())),t.rowAxisHeaderScrollBar&&this._setCrosstabTouchEvents($(this._crosstabContainers.getRowAxisHeaderContainer(),this._crosstabContainers.getLeftAreaDimensionHeaderContainer()))},sap.basetable.crosstab.CrosstabScrollBarController.prototype._setCrosstabTouchEvents=function(t){window.PointerEvent?$(t).bind("pointerdown pointermove pointerup",function(t){"touch"===t.originalEvent.pointerType&&this._handleTouch(t)}.bind(this)):window.TouchEvent&&$(t).bind("touchstart touchmove touchend",function(t){this._handleTouch(t)}.bind(this))},sap.basetable.crosstab.CrosstabScrollBarController.prototype._handleTouch=function(t){var e;e=window.PointerEvent?t.originalEvent:t.changedTouches[0];var s;switch(t.type){case"pointerdown":case"touchstart":this._touchScrollData.startX=e.pageX,this._touchScrollData.startY=e.pageY;break;case"pointermove":case"touchmove":s="mousemove",this._touchScrollData.endX=this._touchScrollData.startX-e.pageX,this._touchScrollData.endY=this._touchScrollData.startY-e.pageY;var a,r=Math.abs(this._touchScrollData.endY),o=Math.abs(this._touchScrollData.endX);(r>this._crosstabConstants.touchThreshold||o>this._crosstabConstants.touchThreshold)&&(r>o?a=this._crosstabConstants.Vertical:o>r&&(a=this._crosstabConstants.Horizontal))}if("mousemove"===s&&a){var i,n;n=a===this._crosstabConstants.Vertical?0>this._touchScrollData.endY?this._crosstabConstants.DecreaseAxis:this._crosstabConstants.IncreaseAxis:0>this._touchScrollData.endX?this._crosstabConstants.DecreaseAxis:this._crosstabConstants.IncreaseAxis,i={"isTouch":!0,"direction":a,"scrollBarAction":n},this._touchScrollData.startX=e.pageX,this._touchScrollData.startY=e.pageY;var l=null,c=t.currentTarget;$(c).is($(this._crosstabContainers.getRowAxisContentContainer()))?l=a===this._crosstabConstants.Vertical?this._crosstabScrollBarEventConstants.touchCrosstabVerticalScrollBarEvent:this._crosstabScrollBarEventConstants.touchCrosstabHorizontalScrollBarEvent:$(c).is($(this._crosstabContainers.getRowAxisHeaderContainer()))?l=a===this._crosstabConstants.Vertical?this._crosstabScrollBarEventConstants.touchCrosstabVerticalScrollBarEvent:this._crosstabScrollBarEventConstants.touchCrosstabRowAxisScrollBarEvent:$(c).is($(this._crosstabContainers.getColumnHeaderContainer()))?a===this._crosstabConstants.Horizontal&&(l=this._crosstabScrollBarEventConstants.touchCrosstabHorizontalScrollBarEvent):$(c).is($(this._crosstabContainers.getLeftAreaDimensionHeaderContainer()))&&a===this._crosstabConstants.Horizontal&&(l=this._crosstabScrollBarEventConstants.touchCrosstabRowAxisScrollBarEvent),null!==l&&this._crosstabScrollBarEventMediator.publish(l,i)}t.preventDefault()},sap.basetable.crosstab.CrosstabScrollBarController.prototype.addHorizontalScrollBar=function(t,e){var s=!1,a=this._floatedHeadersforScrollBar(s,this._crosstab.model().getDimensions(1).length);this._horizontalScrollBar=new sap.basetable.crosstab.CrosstabScrollBar(this._crosstab,this._crosstabConstants.Horizontal,this._crosstabScrollBarEventMediator,this._crosstab.getCellWidth(),a);var r=this._getOffsetProperties(this._crosstabConstants.Horizontal,!0,t);this._horizontalScrollBar.initializeScrollBar(this._crosstabContainers.getHorizontalScrollAreas(),r,this._crosstab.model().getFullAxisLength(this._crosstabConstants.COLUMN_AXIS_INDEX),this._crosstabConstants.HORIZONTAL_SCROLL_WINDOW,!0,e),this._crosstabContainers.getScrollContainer().append(this._horizontalScrollBar.getContainer())},sap.basetable.crosstab.CrosstabScrollBarController.prototype.addVerticalScrollBar=function(t,e){var s=!0,a=this._floatedHeadersforScrollBar(s,this._crosstab.model().getDimensions(0).length);this._verticalScrollBar=new sap.basetable.crosstab.CrosstabScrollBar(this._crosstab,this._crosstabConstants.Vertical,this._crosstabScrollBarEventMediator,this._crosstab.getCellHeight(),a);var r=this._getOffsetProperties(this._crosstabConstants.Vertical,t);this._verticalScrollBar.initializeScrollBar(this._crosstabContainers.getVerticalScrollAreas(),r,this._crosstab.model().getFullAxisLength(this._crosstabConstants.ROW_AXIS_INDEX),this._crosstabConstants.VERTICAL_SCROLL_WINDOW,!0,e),this._crosstabContainers.getScrollContainer().append(this._verticalScrollBar.getContainer())},sap.basetable.crosstab.CrosstabScrollBarController.prototype.addRowAxisHeaderScrollBar=function(t,e){var s=[];this._rowAxisHeaderScrollBar=new sap.basetable.crosstab.CrosstabScrollBar(this._crosstab,this._crosstabConstants.RowAxisHeader,this._crosstabScrollBarEventMediator,this._crosstab.getCellWidth(),s);var a=this._getOffsetProperties(this._crosstabConstants.RowAxisHeader,!0,t);this._rowAxisHeaderScrollBar.initializeScrollBar(this._crosstabContainers.getRowAxisHeaderScrollAreas(),a,null,null,!1,e),this._crosstabContainers.getScrollContainer().append(this._rowAxisHeaderScrollBar.getContainer())},sap.basetable.crosstab.CrosstabScrollBarController.prototype.updateScrollBars=function(t,e,s){var a=this.getScrollBarUpdateData(t,e),r=this._getUpdateHandler(t);r.apply(this,[s,a])},sap.basetable.crosstab.CrosstabScrollBarController.prototype._getUpdateHandler=function(t){var e;return t===this._crosstabScrollBarEventConstants.updateAxisLength?e=this._updateAxisLengthEvent:t===this._crosstabScrollBarEventConstants.conditionalFormatEvent?e=this._conditionalFormatEvent:t===this._crosstabScrollBarEventConstants.newPageEvent?e=this._newPageEvent:t===this._crosstabScrollBarEventConstants.newSectionEvent&&(e=this._newSectionEvent),e},sap.basetable.crosstab.CrosstabScrollBarController.prototype._newPageEvent=function(t,e){t.horizontalScrollBar&&(this._horizontalScrollBar.updateFromExternalEvent(e),this._horizontalScrollBar.resetCellOpacityUnderFloatingHeader()),t.verticalScrollBar&&(this._verticalScrollBar.updateFromExternalEvent(e),this._verticalScrollBar.resetCellOpacityUnderFloatingHeader()),t.rowAxisHeaderScrollBar&&this._rowAxisHeaderScrollBar.updateFromExternalEvent(e)},sap.basetable.crosstab.CrosstabScrollBarController.prototype._newSectionEvent=function(t,e){t.horizontalScrollBar&&this._horizontalScrollBar.updateFromExternalEvent(e),t.verticalScrollBar&&this._verticalScrollBar.updateFromExternalEvent(e),t.rowAxisHeaderScrollBar&&this._rowAxisHeaderScrollBar.updateFromExternalEvent(e)},sap.basetable.crosstab.CrosstabScrollBarController.prototype._conditionalFormatEvent=function(t,e){t.horizontalScrollBar&&(this._horizontalScrollBar.updateFromExternalEvent(e),this._horizontalScrollBar.resetCellOpacityUnderFloatingHeader()),t.verticalScrollBar&&(this._verticalScrollBar.updateFromExternalEvent(e),this._verticalScrollBar.resetCellOpacityUnderFloatingHeader())},sap.basetable.crosstab.CrosstabScrollBarController.prototype._updateAxisLengthEvent=function(t,e){0===e.eventData.axisIndex?t.verticalScrollBar&&this._verticalScrollBar.updateFromExternalEvent(e):t.horizontalScrollBar&&this._horizontalScrollBar.updateFromExternalEvent(e)},sap.basetable.crosstab.CrosstabScrollBarController.prototype.getScrollBarUpdateData=function(t,e){var s={"type":t,"eventData":e,"containers":{"rowAxisContentContent":this._crosstabContainers.getRowAxisContentContent(),"columnHeaderContent":this._crosstabContainers.getColumnHeaderContent(),"rowAxisHeaderContent":this._crosstabContainers.getRowAxisHeaderContent()}};return s},sap.basetable.crosstab.CrosstabScrollBarController.prototype._getScrollData=function(t,e){if(t&&e){var s={"currentPosition":null,"currentStartIndex":null,"endPageIndex":null,"startPageIndex":null,"showEnd":!1};return s.currentPosition=e.getAxisIndex(),s.showEnd=e.getShowEnd(),e.getIsPageable()&&(s.currentStartIndex=e.getCurrentStartIndex(),s.endPageIndex=e.getEndPageIndex(),s.startPageIndex=e.getStartPageIndex()),s}return null},sap.basetable.crosstab.CrosstabScrollBarController.prototype._floatedHeadersforScrollBar=function(t,e){var s,a=[];s=t?"#"+this._crosstab.getId()+"-RowAxisFloatingHeader":"#"+this._crosstab.getId()+"-ColumnAxisFloatingHeader";for(var r=0;e>r;r++)a.push({"referenceId":void 0,"$headerDom":$(s+r),"lastCellParsed":void 0});return a},sap.basetable.crosstab.CrosstabScrollBarController.prototype.getFloatedHeadersforScrollBar=function(t){var e;return t?this._verticalScrollBar&&(e=this._verticalScrollBar.getFloatedHeaders()):this._horizontalScrollBar&&(e=this._horizontalScrollBar.getFloatedHeaders()),e},sap.basetable.crosstab.CrosstabScrollBarController.prototype.getAllFloatedHeaders=function(){var t=this.getFloatedHeadersforScrollBar(!1),e=this.getFloatedHeadersforScrollBar(!0),s=[];return t&&(s=s.concat(t)),e&&(s=s.concat(e)),s},sap.basetable.crosstab.CrosstabScrollBarController.prototype._getOffsetProperties=function(t,e,s){var a={"Top":null,"Left":null},r=0,o=0;return t===this._crosstabConstants.Vertical?(o+=this._crosstabConstants.LeftDimensionHeadersBorderWidth.bottom,o+=this._crosstabConstants.LayoutBorderWidth.top,a.Top=this._crosstabContainers.getHeaderHeight()+o,a.Left=this._crosstabContainers.getLeftAreaContainerWidth()+this._crosstabContainers.getRightAreaContainerWidth(),0===this._crosstabContainers.getLeftAreaContainerWidth()||e||(a.Left+=this._crosstabConstants._METADATA_BORDER_WIDTH+this._crosstabConstants._CROSSTAB_LAYOUT_BORDER_WIDTH)):(t===this._crosstabConstants.Horizontal||t===this._crosstabConstants.RowAxisHeader)&&(r+=this._crosstabConstants.LayoutBorderWidth.left,t===this._crosstabConstants.Horizontal&&0!==this._crosstabContainers.getLeftAreaContainerWidth()?(r+=this._crosstabConstants.RowAxisHeaderContainerBorderWidth.right,a.Left=this._crosstabContainers.getLeftAreaContainerWidth()+r):a.Left=r,a.Top=s?this._crosstabContainers.getBodyHeight()+this._crosstabContainers.getHeaderHeight():this._crosstab.getTotalHeight(),a.Top>this._crosstabContainers.getOverallContainerHeight()&&(a.Top=this._crosstabContainers.getOverallContainerHeight()),a.Top+=this._getAdditionalBorderHeight()),a},sap.basetable.crosstab.CrosstabScrollBarController.prototype._getAdditionalBorderHeight=function(){var t=0;if(this._crosstab.isVerticallyScrollable())t+=this._crosstabConstants._CROSSTAB_LAYOUT_BORDER_HEIGHT,this._crosstab.isMetaDataBorderPresent(this._crosstabConstants.Horizontal)&&(t+=this._crosstabConstants._METADATA_BORDER_HEIGHT);else{var e=this._crosstab.model().getFullAxisLength(this._crosstabConstants.ROW_AXIS_INDEX);t+=this._crosstabConstants._CROSSTAB_LAYOUT_BORDER_HEIGHT,this._crosstabConstants.VERTICAL_SCROLL_WINDOW>e&&this._crosstab.isMetaDataBorderPresent(this._crosstabConstants.Horizontal)&&(t+=this._crosstabConstants._METADATA_BORDER_HEIGHT)}return t},jQuery.sap.declare("sap.basetable.crosstab.CrosstabScrollBarEventConstants"),sap.basetable.crosstab.CrosstabScrollBarEventConstants=function(){var t={};return t.nextPageEvent="nextPageEvent",t.borderEvent="borderEvent",t.updateAxisLength="updateAxisLength",t.conditionalFormatEvent="conditionalFormatEvent",t.newPageEvent="newPageEvent",t.newSectionEvent="newSectionEvent",t.windowResize="windowResize",t.touchCrosstabRowAxisScrollBarEvent="touchCrosstabRowAxisScrollBarEvent",t.touchCrosstabVerticalScrollBarEvent="touchCrosstabVerticalScrollBarEvent",t.touchCrosstabHorizontalScrollBarEvent="touchCrosstabHorizontalScrollBarEvent",Object.freeze(t)},jQuery.sap.declare("sap.basetable.crosstab.CrosstabScrollBarEventMediator"),sap.basetable.crosstab.CrosstabScrollBarEventMediator=function(){this._participants={}},sap.basetable.crosstab.CrosstabScrollBarEventMediator.prototype.subscribe=function(t,e){return this._participants.hasOwnProperty(t)||(this._participants[t]=[]),this._participants[t].push(e),!0},sap.basetable.crosstab.CrosstabScrollBarEventMediator.prototype.publish=function(t,e){if(!this._participants.hasOwnProperty(t))return!1;for(var s=0,a=this._participants[t].length;a>s;s++)this._participants[t][s].call(void 0,e);return!0},jQuery.sap.declare("sap.basetable.crosstab.ExternalScrollHandler"),sap.basetable.crosstab.ExternalScrollHandler=function(t){this._UI5Crostab=t,this._crosstab=this._UI5Crostab.getCrosstab(),this._pageSize=this._crosstab.model().getPageSize()},sap.basetable.crosstab.ExternalScrollHandler.prototype={"_data":null,"_currentRow":0,"_currentCol":0,"_direction":Object.freeze({"horizontal":"horizontal","vertical":"vertical","undetermined":"undetermined"})},sap.basetable.crosstab.ExternalScrollHandler.prototype.getUI5Crosstab=function(){return this._UI5Crostab},sap.basetable.crosstab.ExternalScrollHandler.prototype.doScroll=function(t){var e=this._determineDirection(t);this._data=t,e===this._direction.vertical?this._handleVerticalScroll():e===this._direction.horizontal&&this._handleHorizontalScroll()},sap.basetable.crosstab.ExternalScrollHandler.prototype._handleVerticalScroll=function(){var t=this._getMultiplePagesExist(this._direction.vertical);if(t){var e=this._data.containerScrollTop,s=this._data.containerOffsetTop,a=this._data.containerHeight,r=e+a,o=$("#"+this._UI5Crostab.sId);if(this._getUI5CrosstabValid(o)){var i=o.offset().top/this.getUI5Crosstab().getScaleFactor()-s,n=o.height()*this.getUI5Crosstab().getScaleFactor(),l=this._getAtBeginning(i,r),c=-1;if(l?c=0:(i=Math.abs(i),n>i&&(c=i)),c>=0){var d=this._crosstab.getCellHeight(),b=this._getDimensionCount(this._crosstab.COLUMN_AXIS)*d,h=(c-b)/d;h=Math.ceil(h),0>h&&(h=0),this._crosstab.model().setVerticalScrollPosition(h);var p=this._crosstab.model().getRecentPageData(),u=Math.ceil(a/d),_=p.coordinates.startRowIndex>h,g=h+u>=p.coordinates.endRowIndex;if(_||g)return this._crosstab.publishNextPageEvent(this._getEmptyPageData()),void 0}}}},sap.basetable.crosstab.ExternalScrollHandler.prototype._getEmptyPageData=function(){var t={"redrawRowAxisHeader":null,"redrawRowAxisContent":null,"redrawColumnHeader":null,"coordinates":{"startRowIndex":null,"startColumnIndex":null,"endRowIndex":null,"endColumnIndex":null}};return t},sap.basetable.crosstab.ExternalScrollHandler.prototype._handleHorizontalScroll=function(){var t=this._getMultiplePagesExist(this._direction.horizontal);if(t){var e=this._data.containerScrollLeft,s=this._data.containerOffsetLeft,a=this._data.containerWidth,r=e+a,o=$("#"+this._UI5Crostab.sId);if(this._getUI5CrosstabValid(o)){var i=o.offset().left/this.getUI5Crosstab().getScaleFactor()-s,n=o.width()*this.getUI5Crosstab().getScaleFactor(),l=this._getAtBeginning(i,r),c=-1;if(l?c=0:(i=Math.abs(i),n>i&&(c=i)),c>=0){var d=this._crosstab.getCellWidth(),b=this._getDimensionCount(this._crosstab.ROW_AXIS)*d,h=(c-b)/d;h=Math.ceil(h),0>h&&(h=0),this._crosstab.model().setHorizontalScrollPosition(h);var p=this._crosstab.model().getRecentPageData(),u=Math.ceil(a/d),_=p.coordinates.startColumnIndex>h,g=h+u>=p.coordinates.endColumnIndex;(_||g)&&this._crosstab.publishNextPageEvent(this._getEmptyPageData())}}}},sap.basetable.crosstab.ExternalScrollHandler.prototype._getUI5CrosstabValid=function(t){return t?"function"!=typeof t.offset||null===t.offset()?!1:"function"!=typeof t.height||"function"!=typeof t.width?!1:!0:!1},sap.basetable.crosstab.ExternalScrollHandler.prototype._getAtBeginning=function(t,e){return t>=0&&e>=t},sap.basetable.crosstab.ExternalScrollHandler.prototype._getMultiplePagesExist=function(t){var e;return e=t===this._direction.vertical?this._crosstab.ROW_AXIS:this._crosstab.COLUMN_AXIS,this._crosstab.model().getFullAxisLength(e)>this._pageSize-1},sap.basetable.crosstab.ExternalScrollHandler.prototype._determineDirection=function(t){var e=t.containerScrollTop,s=t.containerScrollLeft;return this._data&&(e-=this._data.containerScrollTop,s-=this._data.containerScrollLeft),this._getDirection(e,s)},sap.basetable.crosstab.ExternalScrollHandler.prototype._getDirection=function(t,e){var s=this._direction.undetermined;return 0!==t&&0===e?s=this._direction.vertical:0!==e&&0===t&&(s=this._direction.horizontal),s},sap.basetable.crosstab.ExternalScrollHandler.prototype._getDimensionCount=function(t){var e=this._crosstab.model().getDimensions(t).length;return t===this._crosstab.COLUMN_AXIS&&(e+=1),e},jQuery.sap.declare("sap.basetable.crosstab.Format"),sap.basetable.crosstab.Format=function(){this._type,this.body},sap.basetable.crosstab.Format.TYPE_STYLE="style",sap.basetable.crosstab.Format.TYPE_SIMPLE="simple",sap.basetable.crosstab.Format.TYPE_CONDITIONS="conditions",sap.basetable.crosstab.Format.prototype.type=function(){},sap.basetable.crosstab.Format.prototype.body=function(){},jQuery.sap.declare("sap.basetable.crosstab.library"),jQuery.sap.require("sap.ui.core.Core"),jQuery.sap.require("sap.ui.core.library"),sap.ui.getCore().initLibrary({"name":"sap.basetable.crosstab","dependencies":["sap.ui.core"],"types":[],"interfaces":[],"controls":["sap.basetable.crosstab.UI5Crosstab"],"elements":[],"version":"0.0"}),jQuery.sap.declare("sap.basetable.crosstab.MockBIQueryModelRequestHandler"),sap.basetable.crosstab.MockBIQueryModelRequestHandler=function(t,e){this._jsonData=t,this._crosstabDataProvider=e},sap.basetable.crosstab.MockBIQueryModelRequestHandler.prototype._truncateInitialData=function(t,e){var s,a={"dimAxes":{}};for(s in t.queryResponse[0].dimAxes)a.dimAxes[s]={},a.dimAxes[s].values=t.queryResponse[0].dimAxes[s].values.slice(0,e),a.dimAxes[s].count=t.queryResponse[0].dimAxes[s].count;a.ranges=t.queryResponse[0].ranges,a.valueAxes=[];for(var r=0;t.queryResponse[0].valueAxes.length>r;++r){var o=t.queryResponse[0].valueAxes[r],i=!0;for(s in t.queryResponse[0].dimAxes)if(o[s]>=e){i=!1;break}i&&a.valueAxes.push(o)}a.calculations=t.queryResponse[0].calculations,a.metadata=t.queryResponse[0].metadata,a.executionStatus=t.queryResponse[0].executionStatus;var n={"queryRequest":t.queryRequest,"queryResponse":[a],"consumptionModel":t.consumptionModel,"feeding":t.feeding};return n},sap.basetable.crosstab.MockBIQueryModelRequestHandler.prototype._fetchInitialWindow=function(t){var e=this._truncateInitialData(this._jsonData,t);this._crosstabDataProvider._initialize(e)},sap.basetable.crosstab.MockBIQueryModelRequestHandler.prototype._fetchAxesMetadata=function(t,e,s){for(var a={"dimAxes":{}},r=0;t.length>r;++r){var o="rows"===t[r]?e:s;
a.dimAxes[o]={"values":this._jsonData.queryResponse[0].dimAxes[o].values,"count":this._jsonData.queryResponse[0].dimAxes[o].count}}a.ranges=this._jsonData.queryResponse[0].ranges,a.valueAxes=[],a.calculations=this._jsonData.queryResponse[0].calculations,a.metadata=this._jsonData.queryResponse[0].metadata,a.executionStatus=this._jsonData.queryResponse[0].executionStatus;var i={"queryRequest":this._jsonData.queryRequest,"queryResponse":[a],"consumptionModel":this._jsonData.consumptionModel,"feeding":this._jsonData.feeding};this._crosstabDataProvider.initializeAxesMetadata(i)},sap.basetable.crosstab.MockBIQueryModelRequestHandler.prototype._fetchWindow=function(t,e,s,a){for(var r=0;t.queryWindowSpecifications.length>r;++r){var o,i,n,l={"version":"2.0","queries":[]},c=[],d=t.queryWindowSpecifications[r],b={},h={"dimAxes":{}};for(var p in d)o="rows"===p?s:a,b[o]={"page":d[p].page,"pageSize":d[p].pageSize,"axisType":this._jsonData.queryRequest.queries[0][o].axisType,"components":this._jsonData.queryRequest.queries[0][o].components,"calculations":this._jsonData.queryRequest.queries[0][o].calculations},i=d[p].page*d[p].pageSize,n=i+d[p].pageSize-1,h.dimAxes[o]={"values":this._jsonData.queryResponse[0].dimAxes[o].values.slice(i,n+1),"count":this._jsonData.queryResponse[0].dimAxes[o].count};l.queries.push(b),h.ranges=this._jsonData.queryResponse[0].ranges,h.valueAxes=[];for(var u=0;this._jsonData.queryResponse[0].valueAxes.length>u;++u){var _=this._jsonData.queryResponse[0].valueAxes[u],g=!0,C={};for(p in d){if(i=d[p].page*d[p].pageSize,n=i+d[p].pageSize-1,i>_[o]||_[o]>n){g=!1;break}C[o]=_[o]-i}g&&(C[e]=_[e],h.valueAxes.push(C))}h.calculations=this._jsonData.queryResponse[0].calculations,h.metadata=this._jsonData.queryResponse[0].metadata,h.executionStatus=this._jsonData.queryResponse[0].executionStatus,c.push(h);var f={"queryRequest":l,"queryResponse":c,"consumptionModel":this._jsonData.consumptionModel,"feeding":this._jsonData.feeding};this._crosstabDataProvider._addPage(t.coordinates,r,f)}},jQuery.sap.declare("sap.basetable.crosstab.PageManager"),sap.basetable.crosstab.PageManager=function(t,e,s,a,r){this._crosstabDataProvider=r,this._axisTupleArray={},this._axisSubtotalLevelNumAggregationsMap={},this._axisTupleMaps={},this._pendingPageRequests=[],this._inProcessPageRequest=void 0,this._pageSize=e,this._pageCache=[],this._pageResults=[],this._eDispatch=s,this._metadataFeedIds=[],this._pendingMetadataRequests=[],this._initializingAxesMetadata=!1,this._crosstabConstants=new sap.basetable.crosstab.CrosstabConstants},sap.basetable.crosstab.PageManager.prototype.getPageSize=function(){return this._pageSize},sap.basetable.crosstab.PageManager.prototype._initialize=function(t){var e;t.windowing?(this._queryRequestHandler=new sap.basetable.crosstab.MockBIQueryModelRequestHandler(t,this._crosstabDataProvider),this._eDispatch=d3.dispatch("mock_axesMetadataRequest","mock_pageRequest"),this._eDispatch.on("mock_axesMetadataRequest",this._queryRequestHandler._fetchAxesMetadata),this._eDispatch.on("mock_pageRequest",this._queryRequestHandler._fetchWindow),e=this._queryRequestHandler._truncateInitialData(t,this._pageSize)):e=t,this._measureAxisType=null;var s=this._crosstabDataProvider._processAxisFeeding(e.feeding.cols);this._columnDimensionIdArray=s.dimensionIdArray,null!==s.measureAxisPosition&&(this._measureAxisType="column",this._measureAxisPosition=s.measureAxisPosition,this._numMeasures=s.numMeasures),s=this._crosstabDataProvider._processAxisFeeding(e.feeding.rows),this._rowDimensionIdArray=s.dimensionIdArray,null===this._measureAxisType&&null!==s.measureAxisPosition&&(this._measureAxisType="row",this._measureAxisPosition=s.measureAxisPosition,this._numMeasures=s.numMeasures),this._entityIdCaptionMap=this._crosstabDataProvider._buildEntityIdCaptionMap(e.feeding),this._measureIdCaptionMap=this._crosstabDataProvider.buildMeasureIdCaptionMap(e.measureMetadata);var a=e.queryRequest?e.queryRequest.queries[0]:null,r=e.queryResponse[0];this._columnAxisName=this._crosstabDataProvider._findAxisName(r,this._columnDimensionIdArray),this._rowAxisName=this._crosstabDataProvider._findAxisName(r,this._rowDimensionIdArray),this._measureAxisName=null,"row"===this._measureAxisType?this._measureAxisName=this._rowAxisName:"column"===this._measureAxisType&&(this._measureAxisName=this._columnAxisName),this._measureGroupName=this._crosstabDataProvider._findMeasureGroupName(a),this._rowAxisName&&(this._axisSubtotalLevelNumAggregationsMap[this._rowAxisName]=this._buildSubtotalLevelNumAggregationsMap(this._rowAxisName,r)),this._columnAxisName&&(this._axisSubtotalLevelNumAggregationsMap[this._columnAxisName]=this._buildSubtotalLevelNumAggregationsMap(this._columnAxisName,r)),this._axisTupleLengths={};var o=r.dimAxes;if(o[this._columnAxisName]&&(this._axisTupleLengths[this._columnAxisName]=o[this._columnAxisName].count),o[this._rowAxisName]&&(this._axisTupleLengths[this._rowAxisName]=o[this._rowAxisName].count),a){var i=a.layout?a.layout:a;this._columnAxisName&&(i[this._columnAxisName]&&this._axisTupleLengths[this._columnAxisName]<i[this._columnAxisName].pageSize?this._initializeAxisMetadata(this._columnAxisName,a,r):this._metadataFeedIds.push("cols")),this._rowAxisName&&(i[this._rowAxisName]&&this._axisTupleLengths[this._rowAxisName]<i[this._rowAxisName].pageSize?this._initializeAxisMetadata(this._rowAxisName,a,r):this._metadataFeedIds.push("rows")),this._initializedWithFullQuery=0===this._metadataFeedIds.length}var n=this._rowAxisName?Math.max(this._pageSize,r.dimAxes[this._rowAxisName].values.length):void 0,l=this._columnAxisName?Math.max(this._pageSize,r.dimAxes[this._columnAxisName].values.length):void 0,c=this._createInitialWindowPageSpecification(n,l),d=this._createInitialWindowMeasuresSpecification(r),b=n?n>=this._axisTupleLengths[this._rowAxisName]:!0,h=l?l>=this._axisTupleLengths[this._columnAxisName]:!0,p=this._crosstabDataProvider._buildTupleTrees(a,r,this._entityIdCaptionMap,this._measureIdCaptionMap,this._rowAxisName,this._columnAxisName,this._measureAxisType,this._measureGroupName,this._measureAxisPosition,c,d,this._axisTupleLengths,b,h);this._storeInCache(p,{"rowPageIndex":0,"columnPageIndex":0},this._pageSize)},sap.basetable.crosstab.PageManager.prototype._initializeAxisMetadata=function(t,e,s){var a;void 0!==this._measureAxisPosition&&(a=this._crosstabDataProvider._buildMeasuresInfo(e,this._measureGroupName,this._measureAxisPosition)),this._axisTupleMaps[t]=this._buildAxisTupleMap(t,s,this._measureAxisName,a,this._axisSubtotalLevelNumAggregationsMap[t])},sap.basetable.crosstab.PageManager.prototype.initializeAxesMetadata=function(){if(!this._initializingAxesMetadata&&this._metadataFeedIds.length>0){for(var t=this._metadataFeedIds.length-1;t>=0;--t){var e={},s=this._metadataFeedIds[t];e[s]={"page":0,"pageSize":100*this._pageSize-1},this._metadataFeedIds.splice(t,1),this._pendingMetadataRequests.push(e)}this._eDispatch.crosstableMembersRequest(this._pendingMetadataRequests[0]),this._pendingMetadataRequests.shift(),this._initializingAxesMetadata=!0}},sap.basetable.crosstab.PageManager.prototype.updateAxesMetadata=function(t,e){var s,a=t.queryRequest.queries[0],r=t.queryResponse[0];for(var o in r.dimAxes)if(r.dimAxes.hasOwnProperty(o)){this._updateAxisTupleArray(o,r);var i=t.queryRequest.queries[0][o].page,n=t.queryRequest.queries[0][o].pageSize,l=o===this._rowAxisName?0:1,c=r.dimAxes[o];if(c.values.length===n){var d=(i+1)*n;d>this._axisTupleLengths[o]&&(this._axisTupleLengths[o]=d,e.setFullAxisLength(l,this._axisTupleLengths[o]));var b=o===this._rowAxisName?"rows":"cols";s||(s={}),s[b]={"page":i+1,"pageSize":n},this._pendingMetadataRequests.push(s)}else{var h;void 0!==this._measureAxisPosition&&(h=this._crosstabDataProvider._buildMeasuresInfo(a,this._measureGroupName,this._measureAxisPosition)),this._axisTupleMaps[o]=this._buildAxisTupleMap(o,r,this._measureAxisName,h,this._axisSubtotalLevelNumAggregationsMap[o],this._axisTupleArray[o]),delete this._axisTupleArray[o],e.setFullAxisLength(l,this.getFullAxisLengthByIndex(l))}}this._pendingMetadataRequests.length>0?(this._eDispatch.crosstableMembersRequest(this._pendingMetadataRequests[0]),this._pendingMetadataRequests.shift()):(this._initializingAxesMetadata=!1,this._processNextPendingPageRequest())},sap.basetable.crosstab.PageManager.prototype._buildSubtotalLevelNumAggregationsMap=function(t,e){var s=[];if(e.calculations){var a=e.calculations[t];if(a)for(var r=0;a.length>r;++r){var o=a[r].values;if(o.length>0){var i=o[0],n=i.window[t],l=void 0===n?0:n.length,c=i.values.length,d=void 0===s[l]?0:s[l];s[l]=d+c}}}return s},sap.basetable.crosstab.PageManager.prototype._buildAxisTupleMap=function(t,e,s,a,r,o){for(var i=[],n=0,l=s===t?0:void 0,c=n,d=o?o:e.dimAxes[t].values;d.length>c;){i.push({"axisTupleIndex":c,"measureIndex":l});var b=d[c],h=d[c+1],p=0,u=b.length,_=!1;if(void 0!==h){_=!0;for(var g=0;h.length>g;++g)if(b[g]!==h[g]){_=!1,p=g+1,u=h.length;break}}if(!_)for(var C=u;C>=p;--C){var f=r[C];if(f)if(void 0!==l){if(a.axisPosition>C){if(l===a.members.length-1)for(var m=0;f>m;++m)for(var v=0;a.members.length>v;++v){var x=a.members[v].indexForSubTotal;x>=0&&i.push({"axisTupleIndex":c,"subTotal":{"level":C,"aggregationIndex":m},"measureIndex":x})}}else if(a.members[l].indexForSubTotal>=0)for(var S=0;f>S;++S)i.push({"axisTupleIndex":c,"subTotal":{"level":C,"aggregationIndex":S},"measureIndex":a.members[l].indexForSubTotal})}else for(var y=0;f>y;++y)i.push({"axisTupleIndex":c,"subTotal":{"level":C,"aggregationIndex":y},"measureIndex":l})}if(void 0!==l){var P=a.members.length;if(void 0===h){if(P-1>l){l++,c=n;continue}}else{var T=a.axisPosition-1,A=h[T];if(void 0!==A&&A!==b[T]){if(l!==P-1){l++,c=n;continue}l=0,n=c+1}}}c++}return i},sap.basetable.crosstab.PageManager.prototype._lookUpMemberKey=function(t,e,s,a){var r,o=t[e];if(o){var i=o[s];if(i){var n=i.value[a];if(n){var l=n.attributes.key;if(l)for(var c=0;l.length>c;++c)r+=l[c];else r=n.key}}}return r},sap.basetable.crosstab.PageManager.prototype._updateAxisTupleArray=function(t,e){for(var s=e.dimAxes[t].values,a=e.metadata.dictionary,r=0;s.length>r;++r){for(var o=s[r],i=[],n=0;o.length>n;++n){var l=o[n],c=this._lookUpMemberKey(a,t,n,l);i.push(c)}this._axisTupleArray[t]||(this._axisTupleArray[t]=[]),this._axisTupleArray[t].push(i)}},sap.basetable.crosstab.PageManager.prototype._findDimensionMemberMeasureIndex=function(t,e){for(var s=e,a=t[s];void 0!==a.subTotal;)s--,a=t[s];return a.measureIndex},sap.basetable.crosstab.PageManager.prototype._calculateSubtotalOffset=function(t,e){var s,a=t[e];if(a.subTotal){for(var r=t[e].axisTupleIndex,o=e;(t[o].axisTupleIndex!==r||void 0!==t[o].subTotal)&&o>=0;)o--;s=e-o}return s},sap.basetable.crosstab.PageManager.prototype._getAxisRange=function(t,e){var s,a,r,o,i=t*this._pageSize,n=i+this._pageSize-1,l=this._axisTupleMaps[e];return void 0===l?(s=i,a=Math.min(n,this._axisTupleLengths[e]-1)):(s=l[i].axisTupleIndex,a=l.length>n?l[n].axisTupleIndex:l[l.length-1].axisTupleIndex,o=this._calculateSubtotalOffset(l,i)),r=0,this._axisTupleLengths[e]-1>a&&(a+=1,r=1),{"startIndex":s,"endIndex":a,"endIndexOffset":r,"subtotalOffset":o}},sap.basetable.crosstab.PageManager.prototype._getNumDimensions=function(t){var e=null;return t===this._columnAxisName&&(e=this._columnDimensionIdArray.length),t===this._rowAxisName&&(e=this._rowDimensionIdArray.length),e},sap.basetable.crosstab.PageManager.prototype._buildMeasureAxisRangesFromAxisTupleMap=function(t,e,s){var a,r,o,i,n,l,c=[],d=t*this._pageSize,b=s.length,h=Math.min(d+this._pageSize-1,b-1),p=s[d];a=p.axisTupleIndex,r=p.axisTupleIndex;for(var u,_=d+1;h>=_&&(u=s[_].axisTupleIndex,!(a>u));++_)r=Math.max(r,u);if(h>=_){for(i=this._findDimensionMemberMeasureIndex(s,d),l=this._calculateSubtotalOffset(s,d),c.push({"startIndex":a,"endIndex":r,"endIndexOffset":0,"measureStartIndex":i,"measureEndIndex":i,"subtotalOffset":l}),d=_,p=s[d],a=p.axisTupleIndex,r=p.axisTupleIndex,_+=1;h>=_;++_)u=s[_].axisTupleIndex,r=Math.max(r,u);o=0,this._axisTupleLengths[e]-1>r&&(r+=1,o=1),i=this._findDimensionMemberMeasureIndex(s,d),n=this._findDimensionMemberMeasureIndex(s,h),c.push({"startIndex":a,"endIndex":r,"endIndexOffset":o,"measureStartIndex":i,"measureEndIndex":n,"subtotalOffset":0})}else o=0,this._axisTupleLengths[e]-1>r&&(r+=1,o=1),i=this._findDimensionMemberMeasureIndex(s,d),n=this._findDimensionMemberMeasureIndex(s,h),l=this._calculateSubtotalOffset(s,d),c.push({"startIndex":a,"endIndex":r,"endIndexOffset":o,"measureStartIndex":i,"measureEndIndex":n,"subtotalOffset":l});return c},sap.basetable.crosstab.PageManager.prototype._getMeasureAxisRanges=function(t,e){var s,a=this._axisTupleMaps[e];if(void 0!==a)s=this._buildMeasureAxisRangesFromAxisTupleMap(t,e,a);else{s=[];var r,o,i,n,l,c,d,b,h;0===this._measureAxisPosition?(d=t*this._pageSize,b=this._axisTupleLengths[e],h=Math.min(d+this._pageSize-1,b*this._numMeasures-1),r=d%b,o=h%b,i=0,this._axisTupleLengths[e]-1>o&&(o+=1,i=1),n=Math.floor(d/b),l=Math.floor(h/b),n===l?s.push({"startIndex":r,"endIndex":o,"endIndexOffset":i,"measureStartIndex":n,"measureEndIndex":l}):(s.push({"startIndex":r,"endIndex":b-1,"endIndexOffset":0,"measureStartIndex":n,"measureEndIndex":n}),s.push({"startIndex":0,"endIndex":o,"endIndexOffset":i,"measureStartIndex":l,"measureEndIndex":l}))):this._measureAxisPosition===this._getNumDimensions(e)&&(d=t*this._pageSize,b=this._axisTupleLengths[e],h=Math.min(d+this._pageSize-1,b*this._numMeasures-1),r=Math.floor(d/this._numMeasures),o=Math.floor(h/this._numMeasures),i=0,this._axisTupleLengths[e]-1>o&&(o+=1,i=1),n=d%this._numMeasures,l=h%this._numMeasures,s.push({"startIndex":r,"endIndex":o,"endIndexOffset":i,"measureStartIndex":n,"measureEndIndex":l,"subtotalOffset":c}))}return s},sap.basetable.crosstab.PageManager.prototype._createWindowAxisSpecifications=function(t){var e,s=[];if("row"===this._measureAxisType||"column"===this._measureAxisType){var a="row"===this._measureAxisType?this._rowAxisName:this._columnAxisName,r="row"===this._measureAxisType?t.rowPageIndex:t.columnPageIndex,o="row"===this._measureAxisType?this._columnAxisName:this._rowAxisName,i="row"===this._measureAxisType?t.columnPageIndex:t.rowPageIndex,n=o?this._getAxisRange(i,o):null,l=a?this._getMeasureAxisRanges(r,a):null;if(l)for(var c=0;l.length>c;++c)e={},e[a]=l[c],n&&(e[o]=n),s.push(e);else n&&(e={},e[o]=n,s.push(e))}else e={},this._rowAxisName&&(e[this._rowAxisName]=this._getAxisRange(t.rowPageIndex,this._rowAxisName)),this._columnAxisName&&(e[this._columnAxisName]=this._getAxisRange(t.columnPageIndex,this._columnAxisName)),s.push(e);return s},sap.basetable.crosstab.PageManager.prototype._calculatePageSize=function(t){for(var e=t.endIndex-t.startIndex+1;Math.floor(t.startIndex/e)!==Math.floor(t.endIndex/e)&&t.endIndex+1>e;)e++;return e},sap.basetable.crosstab.PageManager.prototype._convertWindowAxisRangeToPageSpecification=function(t){var e=this._calculatePageSize(t),s={"page":Math.floor(t.startIndex/e),"pageSize":e};return s},sap.basetable.crosstab.PageManager.prototype._convertWindowAxisRangeToWindowPageSpecification=function(t){var e=this._calculatePageSize(t),s={"page":Math.floor(t.startIndex/e),"pageSize":e,"startIndexOffset":t.startIndex%e,"endIndexOffset":e-t.endIndex%e+t.endIndexOffset-1};return s},sap.basetable.crosstab.PageManager.prototype._createPageSpecification=function(t,e){for(var s={"coordinates":t,"queryWindowSpecifications":[]},a=0;e.length>a;++a){var r=e[a],o={};for(var i in r)if(r.hasOwnProperty(i)){var n=r[i],l=i===this._rowAxisName?"rows":"cols";o[l]=this._convertWindowAxisRangeToPageSpecification(n)}s.queryWindowSpecifications.push(o)}return s},sap.basetable.crosstab.PageManager.prototype._createWindowPageSpecifications=function(t){for(var e=[],s=0;t.length>s;++s){var a=t[s],r={};for(var o in a)if(a.hasOwnProperty(o)){var i=a[o];r[o]=this._convertWindowAxisRangeToWindowPageSpecification(i)}e.push(r)}return e},sap.basetable.crosstab.PageManager.prototype._createWindowMeasuresSpecifications=function(t){var e=[],s=null;if(("row"===this._measureAxisType||"column"===this._measureAxisType)&&(s="row"===this._measureAxisType?this._rowAxisName:this._columnAxisName),null!==s)for(var a=0;t.length>a;++a){var r=t[a][s],o={"measureStartIndex":r.measureStartIndex,"measureEndIndex":r.measureEndIndex};e.push(o)}return e},sap.basetable.crosstab.PageManager.prototype._createInitialWindowPageSpecification=function(t,e){var s={};return t&&(s[this._rowAxisName]={"page":0,"pageSize":t,"startIndexOffset":0,"endIndexOffset":0}),e&&(s[this._columnAxisName]={"page":0,"pageSize":e,"startIndexOffset":0,"endIndexOffset":0}),s},sap.basetable.crosstab.PageManager.prototype._createInitialWindowMeasuresSpecification=function(t){var e;if(this._measureAxisName){e={"measureStartIndex":0};var s=Math.max(this._pageSize,t.dimAxes[this._measureAxisName].values.length);s>=this._axisTupleLengths[this._measureAxisName]?e.measureEndIndex=this._numMeasures-1:0===this._measureAxisPosition?e.measureEndIndex=0:this._measureAxisPosition===this._getNumDimensions(this._measureAxisName)&&(e.measureEndIndex=this._numMeasures-1)}return e},sap.basetable.crosstab.PageManager.prototype._getFullAxisLength=function(t){var e=0;if(t){var s=this._axisTupleMaps?this._axisTupleMaps[t]:void 0;if(void 0===s){var a=t===this._rowAxisName?"row":"column";e=this._measureAxisType===a?this._axisTupleLengths[t]*this._numMeasures:this._axisTupleLengths[t]}else e=s.length}return e},sap.basetable.crosstab.PageManager.prototype._fetchPageFromCache=function(t,e){var s=null,a=this._pageCache[t.rowPageIndex];if(a){var r=a[t.columnPageIndex];if(void 0!==r)if(this._initializedWithFullQuery)s=r;else{var o=(t.rowPageIndex+1)*e,i=this._getFullAxisLength(this._rowAxisName),n=o>=i,l=n?i%e:e,c=r[0].rootnode.numOfLeafChildren?r[0].rootnode.numOfLeafChildren:0;if(c>=l){var d=(t.columnPageIndex+1)*e,b=this._getFullAxisLength(this._columnAxisName),h=d>=b,p=h?b%e:e,u=r[1].rootnode.numOfLeafChildren?r[1].rootnode.numOfLeafChildren:0;u>=p&&(s=r)}}}return s},sap.basetable.crosstab.PageManager.prototype._storeInCache=function(t,e,s){for(var a=sap.basetable.crosstab.TupleTreeUtil.splitTupleTree(t[0],s),r=sap.basetable.crosstab.TupleTreeUtil.splitTupleTree(t[1],s),o=t[1].rootnode.numOfLeafChildren?t[1].rootnode.numOfLeafChildren:0,i=e.rowPageIndex,n=0;a.length>n;++n){var l=a[n],c=sap.basetable.crosstab.TupleTreeUtil.splitTupleTreeByDataPoints(l,o,s),d=this._pageCache[i];void 0===d&&(d=[],this._pageCache[i]=d);for(var b=e.columnPageIndex,h=0;r.length>h;++h)d[b]=[c[h],r[h]],b++;i++}},sap.basetable.crosstab.PageManager.prototype._addPage=function(t,e,s){for(var a=this._createWindowAxisSpecifications(t),r=this._createWindowPageSpecifications(a),o=this._createWindowMeasuresSpecifications(a),i=this._crosstabDataProvider._buildTupleTrees(s.queryRequest.queries[0],s.queryResponse[0],this._entityIdCaptionMap,this._measureIdCaptionMap,this._rowAxisName,this._columnAxisName,this._measureAxisType,this._measureGroupName,this._measureAxisPosition,r[e],o[e],this._axisTupleLengths,!0,!0),n=this._pageResults.length-1;n>=0;--n){var l=this._pageResults[n];if(this._equalPages(l.page,t)){l.windows[e]=i;for(var c=!0,d=0;c&&l.windows.length>d;++d)void 0===l.windows[d]&&(c=!1);if(c){for(var b=null,h=0;l.windows.length>h;++h)b=null===b?l.windows[h]:"row"===this._measureAxisType?sap.basetable.crosstab.TupleTreeUtil.mergeTupleTreesVertically(b,l.windows[h]):sap.basetable.crosstab.TupleTreeUtil.mergeTupleTreesHorizontally(b,l.windows[h]);b=sap.basetable.crosstab.TupleTreeUtil.truncateTupleTrees(b,a,this._rowAxisName,this._columnAxisName),this._storeInCache(b,t,this._pageSize);var p=this._fetchPageFromCache(t,this._pageSize);this._pageResults.splice(n,1);var u=this._inProcessPageRequest;this._inProcessPageRequest=void 0;for(var _=0;u&&u.responseHandlers.length>_;++_)u.responseHandlers[_]._setTupleTrees(t,p);this._processNextPendingPageRequest()}else{var g=this._createPageSpecification(t,a);this._eDispatch.crosstablePageRequest(g.coordinates,g.queryWindowSpecifications[e+1],e+1)}}}},sap.basetable.crosstab.PageManager.prototype._processNextPendingPageRequest=function(){if(this._pendingPageRequests.length>0){var t=this._pendingPageRequests[0];this._pendingPageRequests.shift();for(var e=0;t.responseHandlers.length>e;++e)this.fetchPage(t.page,t.responseHandlers[e])}},sap.basetable.crosstab.PageManager.prototype._equalPages=function(t,e){return t.rowPageIndex===e.rowPageIndex&&t.columnPageIndex===e.columnPageIndex},sap.basetable.crosstab.PageManager.prototype._addToPendingPageRequests=function(t,e){for(var s,a=0;this._pendingPageRequests.length>a;++a)if(this._equalPages(this._pendingPageRequests[a].page,t)){s=this._pendingPageRequests[a];break}s||(s={"page":t,"responseHandlers":[]},this._pendingPageRequests.push(s)),s.responseHandlers.push(e)},sap.basetable.crosstab.PageManager.prototype.fetchPage=function(t,e){var s=this._fetchPageFromCache(t,this._pageSize);if(null===s){if(this._metadataFeedIds.length>0||this._initializingAxesMetadata)return this._addToPendingPageRequests(t,e),void 0;if(this._inProcessPageRequest)this._equalPages(this._inProcessPageRequest.page,t)?this._inProcessPageRequest.responseHandlers.push(e):this._addToPendingPageRequests(t,e);else{var a=this._createWindowAxisSpecifications(t),r=this._createPageSpecification(t,a);if(this._eDispatch.mock_pageRequest)this._eDispatch.mock_pageRequest.call(this._queryRequestHandler,r,this._measureGroupName,this._rowAxisName,this._columnAxisName);else{var o={"page":r.coordinates,"windows":[]};o.windows[r.queryWindowSpecifications.length-1]=void 0,this._pageResults.push(o),this._eDispatch.crosstablePageRequest(r.coordinates,r.queryWindowSpecifications[0],0)}this._inProcessPageRequest={"page":t,"responseHandlers":[e]}}}else e._setTupleTrees(t,s)},sap.basetable.crosstab.PageManager.prototype.getFullAxisLengthByIndex=function(t){var e=0;return 0===t?e=null===this._rowAxisName?this._measureAxisType===this._crosstabConstants.Row?this._numMeasures:0:this._getFullAxisLength(this._rowAxisName):1===t&&(e=null===this._columnAxisName?this._measureAxisType===this._crosstabConstants.Column?this._numMeasures:1:this._getFullAxisLength(this._columnAxisName)),e},jQuery.sap.declare("sap.basetable.crosstab.renderer.CustomRenderer"),sap.basetable.crosstab.renderer.CustomRenderer=function(){},sap.basetable.crosstab.renderer.CustomRenderer.render=function(t,e,s,a,r){var o=t.callBack;o.call(this,e,s,a,r)},jQuery.sap.declare("sap.basetable.crosstab.renderer.CVOMRenderer"),sap.basetable.crosstab.renderer.CVOMRenderer=function(){},sap.basetable.crosstab.renderer.CVOMRenderer.render=function(t,e,s){var a={"plotArea":{},"title":{"visible":!1},"xAxis":{"visible":!1},"yAxis":{"visible":!1},"tooltip":{"visible":!1},"legend":{"visible":!1}},r=t.chartOption?t.chartOption:a;$("#"+e).html("");var o=new sap.viz.api.data.CrosstableDataset;o.data(s),sap.viz.api.core.createViz({"type":t.type,"data":o,"container":$("#"+e),"options":r})},jQuery.sap.declare("sap.basetable.crosstab.renderer.MiniChartRenderer"),sap.basetable.crosstab.renderer.MiniChartRenderer=function(){},sap.basetable.crosstab.renderer.MiniChartRenderer.render=function(t,e,s){var a={"plotArea":{},"title":{"visible":!1},"xAxis":{"visible":!1},"yAxis":{"visible":!1},"tooltip":{"visible":!1},"legend":{"visible":!1}},r=t.chartOption?t.chartOption:a;$("#"+e).html("");var o=new sap.viz.api.data.CrosstableDataset;o.data(s),sap.viz.api.core.createViz({"type":t.type,"data":o,"container":$("#"+e),"options":r})},jQuery.sap.declare("sap.basetable.crosstab.renderer.StringRenderer"),sap.basetable.crosstab.renderer.StringRenderer=function(){},sap.basetable.crosstab.renderer.StringRenderer.render=function(t,e,s){var a=$("#"+t),r=e;s&&s.forEach(function(t){sap.basetable.crosstab.Format.TYPE_STYLE===t.type&&a.css(t.body.style),sap.basetable.crosstab.Format.TYPE_SIMPLE===t.type}),a.children(0).text(r)},jQuery.sap.declare("sap.basetable.crosstab.ScrollPageManager"),sap.basetable.crosstab.ScrollPageManager=function(t,e,s,a){this._pageManager=new sap.basetable.crosstab.PageManager(t,e,s,this,a),this._coordinatesPages=[]},sap.basetable.crosstab.ScrollPageManager.prototype.getPageSize=function(){return this._pageManager.getPageSize()},sap.basetable.crosstab.ScrollPageManager.prototype.initialize=function(t){this._pageManager._initialize(t)},sap.basetable.crosstab.ScrollPageManager.prototype.initializeAxesMetadata=function(){this._pageManager.initializeAxesMetadata()},sap.basetable.crosstab.ScrollPageManager.prototype.updateAxesMetadata=function(t,e){this._pageManager.updateAxesMetadata(t,e)},sap.basetable.crosstab.ScrollPageManager.prototype.addPage=function(t,e,s){this._pageManager._addPage(t,e,s)},sap.basetable.crosstab.ScrollPageManager.prototype._getPageCoordinatesFromViewCoordinates=function(t){var e=this.getPageSize(),s={"rowPageIndex":Math.floor(t.startRowIndex/e),"columnPageIndex":Math.floor(t.startColumnIndex/e)},a={"rowPageIndex":Math.floor(t.endRowIndex/e),"columnPageIndex":Math.floor(t.endColumnIndex/e)},r=[];if(s.rowPageIndex===a.rowPageIndex&&s.columnPageIndex===a.columnPageIndex)r.push(s);else if(r.push(s),r.push(a),s.rowPageIndex!==a.rowPageIndex&&s.columnPageIndex!==a.columnPageIndex){var o={"rowPageIndex":s.rowPageIndex,"columnPageIndex":a.columnPageIndex};r.splice(1,0,o);var i={"rowPageIndex":a.rowPageIndex,"columnPageIndex":s.columnPageIndex};r.splice(2,0,i)}return r},sap.basetable.crosstab.ScrollPageManager.prototype.fetchViewPage=function(t,e){var s=this._getPageCoordinatesFromViewCoordinates(t),a={"coordinates":t,"pageIndices":s,"pages":[],"requestHandler":e};this._coordinatesPages.push(a);for(var r=0;s.length>r;++r)this._pageManager.fetchPage(s[r],this)},sap.basetable.crosstab.ScrollPageManager.prototype._setTupleTrees=function(t,e){for(var s=this._coordinatesPages.length-1;s>=0;--s){for(var a=this._coordinatesPages[s],r=0;a.pageIndices.length>r;++r){var o=a.pageIndices[r];if(o.rowPageIndex===t.rowPageIndex&&o.columnPageIndex===t.columnPageIndex){a.pages[r]=e;break}}for(var i=a.pages.length===a.pageIndices.length,n=0;i&&a.pages.length>n;++n)a.pages[n]||(i=!1);if(i){var l;if(1===a.pageIndices.length)l=a.pages[0];else if(2===a.pageIndices.length)l=a.pageIndices[0].rowPageIndex===a.pageIndices[1].rowPageIndex?sap.basetable.crosstab.TupleTreeUtil.mergeTupleTreesHorizontally(a.pages[0],a.pages[1]):sap.basetable.crosstab.TupleTreeUtil.mergeTupleTreesVertically(a.pages[0],a.pages[1]);else{var c=sap.basetable.crosstab.TupleTreeUtil.mergeTupleTreesHorizontally(a.pages[0],a.pages[1]),d=sap.basetable.crosstab.TupleTreeUtil.mergeTupleTreesHorizontally(a.pages[2],a.pages[3]);l=sap.basetable.crosstab.TupleTreeUtil.mergeTupleTreesVertically(c,d)}var b=this.getPageSize(),h=a.coordinates.startRowIndex%b,p=a.coordinates.endRowIndex-a.coordinates.startRowIndex+1,u=a.coordinates.startColumnIndex%b,_=a.coordinates.endColumnIndex-a.coordinates.startColumnIndex+1,g=sap.basetable.crosstab.TupleTreeUtil.truncateTupleTreeRowsColumns(l,h,p,u,_);a.requestHandler.setTupleTrees(a.coordinates,g),this._coordinatesPages.splice(s,1)}}},sap.basetable.crosstab.ScrollPageManager.prototype.getFullAxisLength=function(t){return this._pageManager.getFullAxisLengthByIndex(t)},jQuery.sap.declare("sap.basetable.crosstab.TupleTreeUtil"),sap.basetable.crosstab.TupleTreeUtil={},sap.basetable.crosstab.TupleTreeUtil.getFirstTupleNodes=function(t){var e=t[t.length-1];return void 0!==e.children&&e.children.length>0&&(t.push(e.children[0]),this.getFirstTupleNodes(t)),t},sap.basetable.crosstab.TupleTreeUtil.getLastTupleNodes=function(t){var e=t[t.length-1];return void 0!==e.children&&e.children.length>0&&(t.push(e.children[e.children.length-1]),this.getLastTupleNodes(t)),t},sap.basetable.crosstab.TupleTreeUtil.mergeTupleTreeNodes=function(t,e,s){var a=t[s];if(0===e.children.length)for(var r=0;s>r;++r)t[r].numOfLeafChildren=t[r].numOfLeafChildren?t[r].numOfLeafChildren+1:1;else for(var o=0;e.children.length>o;++o){var i=t[s+1],n=e.children[o];if(!i||i.tuplePath!==n.tuplePath||i.member.id!==n.member.id||i.member.caption!==n.member.caption||i.member.aggregationTarget!==n.member.aggregationTarget){var l=this.copyNode(n);a.children.push(l),t.splice(s+1,t.length-(s+1)),t.push(l)}this.mergeTupleTreeNodes(t,n,s+1)}},sap.basetable.crosstab.TupleTreeUtil.mergeTupleTree=function(t,e){var s=this.copyNode(t,!0),a=this.getLastTupleNodes([s]);return this.mergeTupleTreeNodes(a,e,0),s},sap.basetable.crosstab.TupleTreeUtil.mergeDataPoints=function(t,e){void 0!==t.dataPoints&&void 0!==e.dataPoints&&(t.dataPoints=t.dataPoints.concat(e.dataPoints));for(var s=0;t.children.length>s;++s)this.mergeDataPoints(t.children[s],e.children[s])},sap.basetable.crosstab.TupleTreeUtil.mergeTupleTreeDataPoints=function(t,e){var s=this.copyNode(t,!0);return this.mergeDataPoints(s,e),s},sap.basetable.crosstab.TupleTreeUtil.mergeTupleTreesVertically=function(t,e){var s=[];return s[0]={"rootnode":this.mergeTupleTree(t[0].rootnode,e[0].rootnode)},s[1]={"rootnode":this.copyNode(t[1].rootnode,!0)},s},sap.basetable.crosstab.TupleTreeUtil.mergeTupleTreesHorizontally=function(t,e){var s=[];return s[0]={"rootnode":this.mergeTupleTreeDataPoints(t[0].rootnode,e[0].rootnode)},s[1]={"rootnode":this.mergeTupleTree(t[1].rootnode,e[1].rootnode)},s},sap.basetable.crosstab.TupleTreeUtil.mergeTrees=function(t,e){t.numOfLeafChildren+=e.numOfLeafChildren;for(var s=0;e.children.length>s;s++){for(var a=e.children[s],r=!1,o=0;t.children.length>o;o++){var i=t.children[o];if(i.tuplePath===a.tuplePath&&i.member.id===a.member.id&&i.member.caption===a.member.caption){if(i.member.aggregationTarget&&a.member.aggregationTarget&&i.member.aggregationTarget.id!==a.member.aggregationTarget.id)continue;if(i.member.aggregationTarget&&a.member.aggregationTarget&&i.member.aggregationTarget.id===a.member.aggregationTarget.id){r=!0;break}this.mergeTrees(i,a),r=!0;break}}r||t.children.push(a)}},sap.basetable.crosstab.TupleTreeUtil._copyNodeBase=function(t,e){var s={"tuplePath":t.tuplePath,"children":[]};return t.numOfLeafChildren&&(s.numOfLeafChildren=e?t.numOfLeafChildren:0),t.member&&(s.member={"id":t.member.id,"caption":t.member.caption,"aggregationTarget":t.member.aggregationTarget},void 0!==t.member.stackIndex&&(s.member.stackIndex=t.member.stackIndex)),void 0!==t.isTotal&&(s.isTotal=t.isTotal),void 0!==t.isMeasure&&(s.isMeasure=t.isMeasure),s},sap.basetable.crosstab.TupleTreeUtil.copyNode=function(t,e){var s=this._copyNodeBase(t,e);if(t.dataPoints){s.dataPoints=[];for(var a=0;t.dataPoints.length>a;++a)s.dataPoints.push(t.dataPoints[a])}if(e)for(var r=0;t.children.length>r;++r){var o=this.copyNode(t.children[r],e);s.children.push(o)}return s},sap.basetable.crosstab.TupleTreeUtil.copyDataPointLeafNode=function(t,e,s){var a=this._copyNodeBase(t);if(t.dataPoints){a.dataPoints=[];for(var r=e;t.dataPoints.length>r&&!(void 0!==s&&r>=e+s);++r)a.dataPoints.push(t.dataPoints[r])}return a},sap.basetable.crosstab.TupleTreeUtil.flattenTupleNodes=function(t,e,s){if(0===t.children.length)e.push(t),s.push(e);else for(var a=0;t.children.length>a;++a)this.flattenTupleNodes(t.children[a],e.concat([t]),s);return s},sap.basetable.crosstab.TupleTreeUtil.truncateTupleTree=function(t,e,s){var a,r=this.flattenTupleNodes(t.rootnode,[],[]),o=null;a=void 0===s?r.length-1:Math.min(r.length,e+s)-1;for(var i=e;a>=i;++i){for(var n=r[i],l=[],c=0;n.length>c;++c){var d=0===c?null:l[c-1],b=n[c],h=!0,p=null;if(o&&h){var u=o[c];h=!b.isTotal&&u.tuplePath===b.tuplePath&&(!b.member&&!u.member||b.member&&u.member&&b.member.id===u.member.id&&b.member.caption===u.member.caption),h&&(p=u)}null===p&&(p=this.copyNode(b),d&&d.children.push(p)),d&&d.numOfLeafChildren++,l.push(p),d=p}o=l}var _=null;return null!==o&&(_={"rootnode":o[0]}),_},sap.basetable.crosstab.TupleTreeUtil.truncateTupleTreeDataPoints=function(t,e,s){for(var a=this.flattenTupleNodes(t.rootnode,[],[]),r=null,o=0;a.length>o;++o){for(var i=a[o],n=[],l=0;i.length>l;++l){var c=0===l?null:n[l-1],d=i[l],b=!0,h=null;if(r&&b){var p=r[l];b=!d.isTotal&&p.tuplePath===d.tuplePath&&(!d.member&&!p.member||d.member&&p.member&&d.member.id===p.member.id&&d.member.caption===p.member.caption),b&&(h=p)
}null===h&&(h=l===i.length-1?this.copyDataPointLeafNode(d,e,s):this.copyNode(d),c&&c.children.push(h)),c&&c.numOfLeafChildren++,n.push(h),c=h}r=n}var u=null;return null!==r&&(u={"rootnode":r[0]}),u},sap.basetable.crosstab.TupleTreeUtil.truncateTupleTrees=function(t,e,s,a){var r=t[0],o=t[1],i=e[0];if(void 0!==i){var n=i[a];n&&n.subtotalOffset&&(o=this.truncateTupleTree(o,n.subtotalOffset),r=this.truncateTupleTreeDataPoints(r,n.subtotalOffset));var l=i[s];l&&l.subtotalOffset&&(r=this.truncateTupleTree(r,l.subtotalOffset))}return[r,o]},sap.basetable.crosstab.TupleTreeUtil.truncateTupleTreeRows=function(t,e,s){var a=this.truncateTupleTree(t[0],e,s);return[a,t[1]]},sap.basetable.crosstab.TupleTreeUtil.truncateTupleTreeColumns=function(t,e,s){var a=this.truncateTupleTreeDataPoints(t[0],e,s),r=this.truncateTupleTree(t[1],e,s);return[a,r]},sap.basetable.crosstab.TupleTreeUtil.truncateTupleTreeRowsColumns=function(t,e,s,a,r){var o=this.truncateTupleTreeRows(t,e,s);return this.truncateTupleTreeColumns(o,a,r)},sap.basetable.crosstab.TupleTreeUtil.splitTupleTree=function(t,e){for(var s=this.flattenTupleNodes(t.rootnode,[],[]),a=[],r=null,o=0;s.length>o;++o){for(var i=s[o],n=!0,l=[],c=0;i.length>c;++c){var d=0===c?null:l[c-1],b=i[c],h=null;if(r&&n){var p=r[c];n=!b.isTotal&&p.tuplePath===b.tuplePath&&(!b.member&&!p.member||b.member&&p.member&&b.member.id===p.member.id&&b.member.caption===p.member.caption),n&&(h=p)}null===h&&(h=this.copyNode(b),d&&d.children.push(h)),d&&d.numOfLeafChildren++,l.push(h),d=h}0===(o+1)%e?(a.push({"rootnode":l[0]}),r=null):r=l}return r&&a.push({"rootnode":r[0]}),a},sap.basetable.crosstab.TupleTreeUtil.splitTupleTreeByDataPoints=function(t,e,s){var a=this.flattenTupleNodes(t.rootnode,[],[]),r=[],o=null,i=0;do{for(var n=0;a.length>n;++n){for(var l=a[n],c=!0,d=[],b=0;l.length>b;++b){var h=0===b?null:d[b-1],p=l[b],u=null;if(o&&c){var _=o[b];c=!p.isTotal&&_.tuplePath===p.tuplePath&&(!p.member&&!_.member||p.member&&_.member&&p.member.id===_.member.id&&p.member.caption===_.member.caption),c&&(u=_)}null===u&&(u=b===l.length-1?this.copyDataPointLeafNode(p,i,s):this.copyNode(p),h&&h.children.push(u)),h&&h.numOfLeafChildren++,d.push(u),h=u}o=d}o&&r.push({"rootnode":o[0]}),o=null,i+=s}while(e>i);return r},jQuery.sap.declare("sap.basetable.crosstab.UI5Crosstab"),jQuery.sap.require("sap.ui.core.Control"),jQuery.sap.require("sap.basetable.crosstab.BaseControl"),jQuery.sap.require("sap.basetable.crosstab.Crosstab"),jQuery.sap.require("sap.basetable.crosstab.CrosstabDataProvider"),sap.basetable.crosstab.BaseControl.extend("sap.basetable.crosstab.UI5Crosstab",{"metadata":{"publicMethods":["select"],"properties":{"width":{"type":"sap.ui.core.CSSSize","group":"Misc","defaultValue":null},"height":{"type":"sap.ui.core.CSSSize","group":"Misc","defaultValue":null},"cellWidth":{"type":"sap.ui.core.CSSSize","group":"Misc","defaultValue":null},"cellHeight":{"type":"sap.ui.core.CSSSize","group":"Misc","defaultValue":null},"rowCellHeight":{"type":"sap.ui.core.CSSSize","group":"Misc","defaultValue":null},"rowCellWidth":{"type":"sap.ui.core.CSSSize","group":"Misc","defaultValue":null}},"aggregations":{"dataProvider":{"type":"sap.basetable.crosstab.CrosstabDataProvider","multiple":!1}},"events":{}}}),sap.basetable.crosstab.UI5Crosstab.prototype.init=function(){sap.basetable.crosstab.BaseControl.prototype.init.apply(this,arguments),this._crosstab=null,this._onThemeChanged=jQuery.proxy(this._applyTheme,this),sap.ui.getCore().attachThemeChanged(this._onThemeChanged),this._clearVariables(),this._externalScrollHandler=null,sap.ui.getCore().getEventBus().subscribe("viz.ext.crosstab","externalCrosstabScroll",this.handleExternalScroll,this),sap.ui.getCore().getEventBus().subscribe("viz.ext.crosstab","scaleCrosstab",this.handleCrosstabScaling,this)},sap.basetable.crosstab.UI5Crosstab.prototype.applySettings=function(){sap.ui.core.Control.prototype.applySettings.apply(this,arguments),this._createCrosstab()},sap.basetable.crosstab.UI5Crosstab.prototype.exit=function(){sap.basetable.crosstab.BaseControl.prototype.exit.apply(this,arguments),sap.ui.getCore().detachThemeChanged(this._onThemeChanged),this._clearVariables(),sap.ui.getCore().getEventBus().unsubscribe("viz.ext.crosstab","externalCrosstabScroll",this.handleExternalScroll,this),sap.ui.getCore().getEventBus().unsubscribe("viz.ext.crosstab","scaleCrosstab",this.handleCrosstabScaling,this)},sap.basetable.crosstab.UI5Crosstab.prototype.setDataProvider=function(t){this._crosstab&&this._crosstab.setDataProvider(t)},sap.basetable.crosstab.UI5Crosstab.prototype.vizUpdate=function(t){this._crosstab&&t.dataProvider&&this._crosstab.vizUpdate(t.dataProvider)},sap.basetable.crosstab.UI5Crosstab.prototype.getIntWidth=function(){var t=-1,e=this.getWidth();return e&&"auto"!==e&&(t=parseInt(e,10)),t},sap.basetable.crosstab.UI5Crosstab.prototype.getIntHeight=function(){var t=-1,e=this.getHeight();return e&&"auto"!==e&&(t=parseInt(e,10)),t},sap.basetable.crosstab.UI5Crosstab.prototype.getIntCellWidth=function(){var t=-1,e=this.getCellWidth();return e&&"auto"!==e&&(t=parseInt(e,10)),t},sap.basetable.crosstab.UI5Crosstab.prototype.getIntCellHeight=function(){var t=-1,e=this.getCellHeight();return e&&"auto"!==e&&(t=parseInt(e,10)),t},sap.basetable.crosstab.UI5Crosstab.prototype.getIntRowCellHeight=function(){var t=-1,e=this.getRowCellHeight();return e&&"auto"!==e&&(t=parseInt(e,10)),t},sap.basetable.crosstab.UI5Crosstab.prototype.getIntRowCellWidth=function(){var t=-1,e=this.getRowCellWidth();return t&&"auto"!==e&&(t=parseInt(e,10)),t},sap.basetable.crosstab.UI5Crosstab.prototype.select=function(t,e,s){return this._crosstab?this._crosstab.select(t,e,s):null},sap.basetable.crosstab.UI5Crosstab.prototype.handleExternalScroll=function(t,e,s){this.ignoreExternalScroll()||"viz.ext.crosstab"!==t||"externalCrosstabScroll"!==e||(this.externalScrollHandler&&this.externalScrollHandler.getUI5Crosstab().sId===this.sId||(this.externalScrollHandler=new sap.basetable.crosstab.ExternalScrollHandler(this)),this.externalScrollHandler.doScroll(s))},sap.basetable.crosstab.UI5Crosstab.prototype.handleCrosstabScaling=function(t,e,s){"viz.ext.crosstab"===t&&"scaleCrosstab"===e&&void 0!==typeof s&&"number"==typeof s.scaleFactor&&this._crosstab.setScaleFactor(s.scaleFactor)},sap.basetable.crosstab.UI5Crosstab.prototype.getScaleFactor=function(){return this._crosstab.getScaleFactor()},sap.basetable.crosstab.UI5Crosstab.prototype.ignoreExternalScroll=function(){return this._crosstab?this._crosstab.isHorizontallyScrollable()&&this._crosstab.isVerticallyScrollable():!0},sap.basetable.crosstab.UI5Crosstab.prototype._clearVariables=function(){this._crosstab$=null},sap.basetable.crosstab.UI5Crosstab.prototype._createCrosstab=function(){this._applyTheme();var t="ui5-viz-controls";this._crosstab$=$(document.createElement("div")),this._crosstab$.addClass(t+"-viz-frame"),$(this._app$).attr("data-sap-ui-preserve",!0);var e={"size":{"width":this.getIntWidth(),"height":this.getIntHeight(),"cellWidth":this.getIntCellWidth(),"cellHeight":this.getIntCellHeight(),"rowCellHeight":this.getIntRowCellHeight(),"rowCellWidth":this.getIntRowCellWidth()},"container":$(this._crosstab$),"dataProvider":this.getDataProvider(),"parentId":this.sId.split("__")[1]};this._crosstab=new sap.basetable.crosstab.Crosstab(e)},sap.basetable.crosstab.UI5Crosstab.prototype._updateCrosstab=function(t){this._crosstab&&(this._crosstab.draw(this.getIntHeight(),this.getIntWidth(),t),this._crosstab.renderCellGroups())},sap.basetable.crosstab.UI5Crosstab.prototype._createChildren=function(){this._crosstab$.appendTo(this._app$),this._updateCrosstab(!1)},sap.basetable.crosstab.UI5Crosstab.prototype._updateChildren=function(t){var e=!$.isEmptyObject(t);this._updateCrosstab(e)},sap.basetable.crosstab.UI5Crosstab.prototype._applyTheme=function(){},sap.basetable.crosstab.UI5Crosstab.prototype.setRoot=function(t){this._crosstab.setRoot(t)},sap.basetable.crosstab.UI5Crosstab.prototype.getCrosstab=function(){return this._crosstab},jQuery.sap.declare("sap.basetable.crosstab.UI5CrosstabRenderer"),sap.basetable.crosstab.UI5CrosstabRenderer={},sap.basetable.crosstab.UI5CrosstabRenderer.render=function(t,e){t.write("<DIV"),t.writeControlData(e),t.addClass("sapUI5Crosstab"),t.writeClasses(),t.addStyle("width",e.getWidth()),t.addStyle("height",e.getHeight()),t.addStyle("overflow","hidden"),t.writeStyles(),t.write(">"),t.write("</DIV>")},jQuery.sap.declare("sap.basetable.crosstab.utils.FormatUtils"),sap.basetable.crosstab.utils.FormatUtils=function(){},sap.basetable.crosstab.utils.FormatUtils.NUMERIC_PREFIX="numeric:",sap.basetable.crosstab.utils.FormatUtils.createFormatArray=function(t){if(!$.isEmptyObject(t)){for(var e,s=[],a=0;t.length>a;a++){var r=t[a];r&&(void 0===e&&(e=0===r.indexOf(sap.basetable.crosstab.utils.FormatUtils.NUMERIC_PREFIX)),e&&s.push(r))}return s}},sap.basetable.crosstab.utils.FormatUtils.applyFormats=function(t,e){return"string"==typeof e&&(t=sap.viz.api.env.Format.format(t,e)),t},jQuery.sap.declare("sap.basetable.crosstab.utils.RenderUtils"),sap.basetable.crosstab.utils.RenderUtils=function(){},sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell=function(t){var e=$(document.createElement("div"));return e.attr({"id":t}),e},sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow=function(t,e,s,a){var r=$(document.createElement("div"));return r.attr({"id":t}),e&&r.css({"height":e}),s&&r.append(s),r.addClass("crosstab-row"),r.addClass(a),r},sap.basetable.crosstab.utils.RenderUtils.createMatrixLayout=function(t,e,s,a){var r=$(document.createElement("div"));return r.attr({"id":t,"layoutFixed":!0,"widths":a}),r.css({"width":e+"px","height":s+"px","border-spacing":"0px","padding":"0px"}),r},sap.basetable.crosstab.utils.RenderUtils.createContentCell=function(t,e,s,a,r,o,i,n,l,c,d){var b=e,h=s;o&&o>1?(h*=o,h-=a):h-=a,c?b=c-a:i&&i>1?(b*=i,b-=a):b-=a,b=l?b+1:b;var p=$(document.createElement("div"));if(p[0].setAttribute("id",t),p[0].style.width=b+"px",p[0].style.minWidth=b+"px",p[0].style.maxWidth=b+"px",p[0].style.height=h+"px",p[0].style.lineHeight=h+"px",n&&(p[0].className=n),p.append(r),!d){var u=$(document.createElement("div"));u[0].className="crosstab-resizable",p.append(u)}return p},sap.basetable.crosstab.utils.RenderUtils.createHeaderCell=function(t,e,s,a,r,o,i,n,l,c,d,b,h){var p=this.createMatrixLayoutCell(t+"-div"),u=this.createContentCell(t,e,s,a,r,i,n,l,c,b,h);return d&&u.attr("title",d),p.append(u),o&&p.append(o),p},sap.basetable.crosstab.utils.RenderUtils.styleClasstoString=function(t){var e="";for(var s in t)t.hasOwnProperty(s)&&(e=e+s+": "+t[s]+";");return e.substr(0,e.length-1)},sap.basetable.crosstab.utils.RenderUtils._removeSelectionForOtherCells=function(t){for(var e=$(".crosstab-cell-selected").not(t),s=0;e.length>s;s++){var a=$(e[s]);a.removeClass("crosstab-cell-selected")}},sap.basetable.crosstab.utils.RenderUtils._selectCellUnderFloatingHeader=function(t,e){var s=!1;if(t.hasClass("crosstab-FloatingCell")&&(s=!0),s)for(var a=0;e.length>a;a++){var r=e[a],o=$(r.$headerDom),i=r.referenceId,n=$("div[id='"+i+"'");if(o.hasClass("crosstab-cell-selected")){n.addClass("crosstab-cell-selected");break}}},sap.basetable.crosstab.utils.RenderUtils.styleSelectedCells=function(t,e){var s,a=t.parent(),r=".crosstab-Cell, .crosstab-Cell-Top, .crosstab-FloatingCell",o=".crosstab-DataArea, .crosstab-LeftDimensionHeaders, .crosstab-columnDimensionHeaderRow";return a.is(r)?s=a:t.is(r)&&(s=t),s&&!s.parents().is(o)&&(s.toggleClass("crosstab-cell-selected"),this._removeSelectionForOtherCells(s),this._selectCellUnderFloatingHeader(s,e)),s},jQuery.sap.declare("sap.cvom.crosstabviewer.CrosstabDataModelHelper"),sap.cvom.crosstabviewer.CrosstabDataModelHelper=function(){},jQuery.sap.declare("sap.cvom.crosstabviewer.CrosstabViewer"),sap.cvom.crosstabviewer.CrosstabViewer=function(t,e,s){this.setProviderDataModelHelper(t),this._crosstabConstants=new sap.basetable.crosstab.CrosstabConstants,this.createCrosstab(e,s)},sap.cvom.crosstabviewer.CrosstabViewer.prototype={"OPTS":Object.freeze({"TYPE_SIZE":"sizeCalculated","SIZE":"size","TYPE_WIDTH":"widthCalculated","TYPE_HEIGHT":"heightCalculated","WIDTH":"width","HEIGHT":"height","PADDING":150,"SIZE_NOT_CHANGED":-1,"CROSSTAB_DEFAULT_PADDING":24}),"getProviderDataModelHelper":function(){return this._contentProviderDataModelHelper},"setProviderDataModelHelper":function(t){this._contentProviderDataModelHelper=t},"apply":function(t,e){var s=new sap.basetable.crosstab.CrosstabDataProvider(t,e);this._oCrosstab.setDataProvider(s)},"placeAt":function(t){this._oCrosstab&&t&&this._oCrosstab.placeAt(t)},"updateUI":function(t){this.reset(),this.updateCrosstabModel(t),this.reRendering()},"setWidth":function(t){$.isNumeric(t)&&(t+="px"),this.getCrosstab().setWidth(t)},"setHeight":function(t){$.isNumeric(t)&&(t+="px"),this.getCrosstab().setHeight(t)},"setProperties":function(t,e,s){if(t.conditionalFormat&&this.setConditionalFormat(t.conditionalFormat),t.resizedElements&&t.resizedElements.length>0){var a=!t.hideVerticalScrollbar,r=!t.hideHorizontalScrollbar,o=!a&&!r;o&&(s=!0),this.setResizedElements(t.resizedElements,s)}this.setScrollableProperties(t,e)},"setConditionalFormat":function(t){var e=this.getUnderlyingCrosstab();e&&t&&"function"==typeof t.conditionalFormatCallBack&&(e.setConditionalFormat(t.conditionalFormatCallBack),e.setConditionalFormatRules(t.conditionalFormatRules))},"setScrollableProperties":function(t,e){var s=!t.hideVerticalScrollbar,a=!t.hideHorizontalScrollbar,r=this.getCrosstab().getWidth(),o=this.getCrosstab().getHeight(),i=this.getUnderlyingCrosstab(),n=i.model().isCellJustResized(),l=!s&&!a,c=!s&&a;if(i){var d=i.setVerticallyScrollable(s),b=i.setHorizontallyScrollable(a),h=!1;(d&&!s||l)&&(o=this.getTotalHeight(),h=!0),(b&&!a||l)&&(r=this.getTotalWidth(),h=!0),(h||n)&&c&&(r=parseInt(r)+2*this.OPTS.CROSSTAB_DEFAULT_PADDING,o=this.getTotalHeight(),h=!0),h?this.dispatchSizeCalculated(e,r,o):this.dispatchSizeCalculated(e,this.OPTS.SIZE_NOT_CHANGED,this.OPTS.SIZE_NOT_CHANGED)}},"dispatchSizeCalculated":function(t,e,s){setTimeout(function(){var a={"width":parseInt(e),"height":parseInt(s)},r={"name":this.OPTS.TYPE_SIZE,"data":a};t.sizeCalculated(r)}.bind(this),0)},"setResizedElements":function(t,e){var s=this.getUnderlyingCrosstab();s&&t&&s.setResizedElements(t,e)},"resize":function(){this.getCrosstab().resize()},"destroy":function(){this.getCrosstab().destroy()},"updateCrosstabModel":function(t){this.buildModelFromContentProviderDataModel(t)},"reRendering":function(){},"createCrosstab":function(t,e){var s=t+"px",a=e+"px";this._oCrosstab=new sap.basetable.crosstab.UI5Crosstab({"width":s,"height":a,"cellWidth":this._crosstabConstants.CELL_WIDTH+"px","cellHeight":this._crosstabConstants.CELL_HEIGHT+"px","rowCellHeight":this._crosstabConstants.CELL_HEIGHT+"px","rowCellWidth":this._crosstabConstants.ROW_CELL_WIDTH+"px"})},"getCrosstab":function(){return this._oCrosstab},"getUnderlyingCrosstab":function(){return this._oCrosstab&&"function"==typeof this._oCrosstab.getCrosstab?this._oCrosstab.getCrosstab():void 0},"getUI":function(){return this.getCrosstab()},"buildModelFromContentProviderDataModel":function(t){this.getProviderDataModelHelper().buildModelFromContentProviderDataModel(t)},"updateAxesMetadata":function(t){var e=this.getUnderlyingCrosstab();e&&"function"==typeof e.updateAxesMetadata&&e.updateAxesMetadata(t)},"addPageData":function(t){var e=this.getUnderlyingCrosstab();e&&"function"==typeof e.addPageData&&e.addPageData(t)},"reset":function(){},"getTotalHeight":function(){var t=this.getUnderlyingCrosstab();return t.getTotalHeight()+this.OPTS.PADDING},"getTotalWidth":function(){var t=this.getUnderlyingCrosstab();return t.getTotalWidth()+this.OPTS.PADDING}},jQuery.sap.declare("sap.cvom.crosstabviewer.LanguageManager"),sap.cvom.crosstabviewer.LanguageManager=function(){this._cvomLangManager=null,this._initialize()},sap.cvom.crosstabviewer.LanguageManager.prototype.get=function(t){var e="";return this._cvomLangManager&&(e=this._cvomLangManager.getResourceString(t)),e},sap.cvom.crosstabviewer.LanguageManager.prototype._initialize=function(){var t=this;try{t._cvomLangManager=sap.viz.extapi.env.Language,t._cvomLangManager.register({"id":"language","value":{"XTAB_MEASURE_AXIS_TITLE":"Measures","XTAB_SUBTOTAL_LABEL_TOTAL":"Total","XTAB_SUBTOTAL_LABEL_SUM":"Sum","XTAB_SUBTOTAL_LABEL_AVERAGE":"Average","XTAB_SUBTOTAL_LABEL_COUNT":"Count","XTAB_SUBTOTAL_LABEL_MAX":"Maximum","XTAB_SUBTOTAL_LABEL_MIN":"Minimum"}})}catch(e){t._cvomLangManager=null}},jQuery.sap.declare("sap.basetable.crosstab.BaseControl"),jQuery.sap.require("sap.ui.core.Control"),sap.ui.core.Control.extend("sap.basetable.crosstab.BaseControl",{"metadata":{"properties":{"uiConfig":{"type":"object","group":"Misc","defaultValue":null}}}}),sap.basetable.crosstab.BaseControl.prototype.init=function(){this._app$=null,this._uiConfig=null,this._controls={},this._requestedLoad=null,this._handlers={"resize":null}},sap.basetable.crosstab.BaseControl.prototype.exit=function(){this._app$=null,this._deregister();for(var t in this._controls)this._controls[t].destroy()},sap.basetable.crosstab.BaseControl.prototype.onBeforeRendering=function(){this._deregister()},sap.basetable.crosstab.BaseControl.prototype.onAfterRendering=function(){this._app$?(this._app$.appendTo(this.getDomRef()),this._validateSize(),this._updateChildren(this.mProperties)):(this._app$=jQuery(document.createElement("div")).appendTo(this.getDomRef()).addClass("ui5-viz-controls-app"),jQuery(this._app$).attr("data-sap-ui-preserve",!0),this._createChildren(),this._validateSize()),this._crosstab._addResizeListener(),this._register()},sap.basetable.crosstab.BaseControl.prototype.getUiConfig=function(){return this._uiConfig},sap.basetable.crosstab.BaseControl.prototype.setUiConfig=function(t){this._app$||this._mergeConfig(t)},sap.basetable.crosstab.BaseControl.prototype.save=function(){var t={};for(var e in this._controls)t[e]=this._controls[e].save();return t},sap.basetable.crosstab.BaseControl.prototype.load=function(t){for(var e in t)this._controls[e]?this._controls[e].load(t[e]):this._requestedLoad=t},sap.basetable.crosstab.BaseControl.prototype._createChildren=function(){},sap.basetable.crosstab.BaseControl.prototype._updateChildren=function(){},sap.basetable.crosstab.BaseControl.prototype._mergeConfig=function(t){this._uiConfig=t},sap.basetable.crosstab.BaseControl.prototype._deregister=function(){this._handlers.resize&&sap.ui.core.ResizeHandler.deregister(this._handlers.resize),this._handlers.resize=null},sap.basetable.crosstab.BaseControl.prototype._register=function(){this._handlers.resize=sap.ui.core.ResizeHandler.register(this.getDomRef(),jQuery.proxy(this._validateSize,this))},sap.basetable.crosstab.BaseControl.prototype._validateSize=function(){},sap.basetable.crosstab.BaseControl.prototype._registerControl=function(t,e){this._controls[t]=e,this._requestedLoad&&this._requestedLoad[t]&&(e.load(this._requestedLoad[t]),delete this._requestedLoad[t])},jQuery.sap.declare("sap.basetable.crosstab.CellGroup"),sap.basetable.crosstab.CellGroup=function(t,e,s,a,r){this._id=e,this._tuplePaths=s,this._cellType=r?r:sap.basetable.crosstab.CellGroup.CELL_TYPE_DATAPOINTS,this._groupType=a?a:sap.basetable.crosstab.CellGroup.TYPE_INDIVIDUAL,this._crosstabModel=t.model(),this._cellHeight=t.getCellHeight(),this._cellWidth=t.getCellWidth()},sap.basetable.crosstab.CellGroup.prototype={"_mergedContainerId":void 0,"_data":[]},sap.basetable.crosstab.CellGroup.CELL_TYPE_DATAPOINTS="datapoints",sap.basetable.crosstab.CellGroup.CELL_TYPE_MEMBER_HEADER="memberHeader",sap.basetable.crosstab.CellGroup.GROUP_TYPE_RANGE="range",sap.basetable.crosstab.CellGroup.GROUP_TYPE_INDIVIDUAL="individual",sap.basetable.crosstab.CellGroup.DATA_TYPE_TUPLEPATHS="tuplePaths",sap.basetable.crosstab.CellGroup.DATA_TYPE_RAW="raw",sap.basetable.crosstab.CellGroup.RENDERER_TYPE_CVOM="cvom",sap.basetable.crosstab.CellGroup.RENDERER_TYPE_MINICHART="minichart",sap.basetable.crosstab.CellGroup.RENDERER_TYPE_CUSTOM="custom",sap.basetable.crosstab.CellGroup.prototype.id=function(t){return arguments.length?(this._id=t,this._id):this._id},sap.basetable.crosstab.CellGroup.prototype.tuplePaths=function(t){return arguments.length?(this._tuplePaths=t,this._tuplePaths):this._tuplePaths},sap.basetable.crosstab.CellGroup.prototype.cellType=function(t){return arguments.length?(this._cellType=t,this._cellType):this._cellType},sap.basetable.crosstab.CellGroup.prototype.groupType=function(t){return arguments.length?(this._groupType=t,this._groupType):this._groupType},sap.basetable.crosstab.CellGroup.prototype.formats=function(t){return arguments.length?(this._formats=t,void 0):this._formats},sap.basetable.crosstab.CellGroup.prototype.expression=function(t){return arguments.length?(this._expression=t,void 0):this._expression},sap.basetable.crosstab.CellGroup.prototype.data=function(t,e){if(!arguments.length)return this._data;if(sap.basetable.crosstab.CellGroup.DATA_TYPE_TUPLEPATHS===e){var s=this._getCellCoordinates(this._crosstabModel.getNumberOfTuples(0),this._crosstabModel.getNumberOfTuples(1),t,sap.basetable.crosstab.CellGroup.GROUP_TYPE_RANGE);this._data=[],this._data[0]=[],s.forEach(function(t){var e="dataCell_"+t[0]+"_"+t[1],s=$("#"+e);this._data[0].push(s.text())}.bind(this))}else this._data=t},sap.basetable.crosstab.CellGroup.prototype.setMerged=function(t){this._isMerged=t},sap.basetable.crosstab.CellGroup.prototype.isMerged=function(){return this._isMerged},sap.basetable.crosstab.CellGroup.prototype.renderer=function(t){return arguments.length?(this._renderer=t,void 0):this._renderer},sap.basetable.crosstab.CellGroup.prototype.draw=function(){if(this._isMerged){var t=this.data();this.mergeCell(),t.length>0&&this.data(t),this._drawCell(this._mergedContainerId,this._data[0])}else{var e=this._crosstabModel.getNumberOfTuples(0),s=this._crosstabModel.getNumberOfTuples(1),a=this._getCellCoordinates(e,s,this._tuplePaths,this._groupType);a.forEach(function(t,e){var s="dataCell_"+t[0]+"_"+t[1],a=$("#"+s),r=this._data.length>0?this._data[e]:a.text();this._drawCell(s,r)}.bind(this))}},sap.basetable.crosstab.CellGroup.prototype.mergeCell=function(){var t,e=this._crosstabModel.getNumberOfTuples(0),s=this._crosstabModel.getNumberOfTuples(1),a=this._getCellCoordinates(e,s,this._tuplePaths,this._groupType);this._data=[],this._data[0]=[],a.forEach(function(e,s){var a="dataCell_"+e[0]+"_"+e[1],r=$("#"+a);this._data[0].push(r.text());var o=$("#"+a).closest("td"),i=$("#"+a).closest("tr");0===s&&(t=i),i[0].removeChild(o[0])}.bind(this));var r=a[0],o=a[a.length-1];this._mergedContainerId="dataCell_"+r[0]+"_"+r[1];var i=o[0]-r[0]+1,n=o[1]-r[1]+1,l=sap.basetable.crosstab.utils.RenderUtils.createContentCell(this._mergedContainerId,this._cellWidth(),this._cellHeight(),this._borderWidth(),void 0,i,n,"crosstab-Cell");t.append(l),this._isMerged=!0},sap.basetable.crosstab.CellGroup.prototype._getTupleIndex=function(t){var e=[],s=[];return e=this._crosstabModel.getTupleIndex(0,t),void 0===e&&(e=[],s=this._crosstabModel.getTupleIndex(1,t)),{"rowTupleIndexRange":e,"columnTupleIndexRange":s}},sap.basetable.crosstab.CellGroup.prototype._getCellCoordinates=function(t,e,s,a){var r=[];if(s.forEach(function(s){var a=[],o=[],i=[],n=!1,l=!1;if(1===s.length)a=this._getTupleIndex(s[0]),0===a.rowTupleIndexRange.length?(i=a.columnTupleIndexRange,n=!0):(o=a.rowTupleIndexRange,l=!0);else if(2===s.length)for(var c=0;s.length>c;c++)a=this._getTupleIndex(s[c]),0===a.rowTupleIndexRange.length?i=a.columnTupleIndexRange:o=a.rowTupleIndexRange;if(n)for(var d=0;t>d;d++)for(var b=i[0];i[1]>b;b++)r.push([d,b]);else if(l)for(var h=o[0];o[1]>h;h++)for(var p=0;e>p;p++)r.push([h,p]);else r.push([o[0],i[0]])}.bind(this)),a===sap.basetable.crosstab.CellGroup.GROUP_TYPE_RANGE){var o=r[0],i=r[1];r=[];for(var n=o[0];i[0]>=n;n++)for(var l=o[1];i[1]>=l;l++)r.push([n,l])}return r},sap.basetable.crosstab.CellGroup.prototype._drawCell=function(t,e){var s=this._renderer;if(s){var a=s.type;if(sap.basetable.crosstab.CellGroup.RENDERER_TYPE_CVOM===a)sap.basetable.crosstab.renderer.CVOMRenderer.render(s.body,t,e,this._formats);else if(sap.basetable.crosstab.CellGroup.RENDERER_TYPE_MINICHART===a){var r={"analysisAxis":[{"index":1,"data":[{"type":"Dimension","values":[]}]}],"measureValuesGroup":[{"index":1,"data":[{"type":"Measure","values":[]}]}]};r.measureValuesGroup[0].data[0].values[0]=[],e.forEach(function(t){r.measureValuesGroup[0].data[0].values[0].push(parseFloat(t)),r.analysisAxis[0].data[0].values.push("0")}),sap.basetable.crosstab.renderer.CVOMRenderer.render(s.body,t,r,this._formats)}else sap.basetable.crosstab.CellGroup.RENDERER_TYPE_CUSTOM===a&&sap.basetable.crosstab.renderer.CustomRenderer.render(s.body,t,e,this._formats)}else sap.basetable.crosstab.renderer.StringRenderer.render(t,e,this._formats)},jQuery.sap.declare("sap.basetable.crosstab.ConditionalCellFormatter"),sap.basetable.crosstab.ConditionalCellFormatter=function(){},sap.basetable.crosstab.ConditionalCellFormatter.prototype.generateCellCallback=function(t,e,s){var a=t(e,{"measure":s});return a},jQuery.sap.declare("sap.basetable.crosstab.Crosstab"),sap.basetable.crosstab.Crosstab=function(t){this._crosstabScrollBarEventMediator=new sap.basetable.crosstab.CrosstabScrollBarEventMediator,this._crosstabScrollBarEventConstants=new sap.basetable.crosstab.CrosstabScrollBarEventConstants,this._crosstabConstants=new sap.basetable.crosstab.CrosstabConstants,this._crosstabElementResizedEventConstants=new sap.basetable.crosstab.CrosstabElementResizedEventConstants,this._model=new sap.basetable.crosstab.CrosstabModel(t,this,this._crosstabScrollBarEventMediator,this._crosstabScrollBarEventConstants,this._crosstabElementResizedEventConstants),this._container=t.container,this._size=t.size,this._id=t.parentId,this._crosstabContainers=new sap.basetable.crosstab.CrosstabContainers(this,this._crosstabScrollBarEventMediator,this._crosstabScrollBarEventConstants),this._renderer=new sap.basetable.crosstab.CrosstabRenderer(this,this._crosstabScrollBarEventMediator,t),this._registerScrollBarEvents(),this._crosstabScrollBarController=new sap.basetable.crosstab.CrosstabScrollBarController(this,this._crosstabScrollBarEventMediator,this._crosstabScrollBarEventConstants),this._conditionalFormat=null,this._conditionalFormatRules=[],this._addSelectionListener(),this._crosstabElementResizeHandler=new sap.basetable.crosstab.CrosstabElementResizeHandler(this,this._model,this._renderer,this._crosstabElementResizedEventConstants),this._addResizeListener()},sap.basetable.crosstab.Crosstab.prototype={"_verticallyScrollable":!0,"_horizontallyScrollable":!0,"_scaleFactor":1,"ROW_AXIS":0,"COLUMN_AXIS":1,"BORDER_WIDTH":1,"EXTRA_ROW_BUFFER":1},sap.basetable.crosstab.Crosstab.prototype.getCellWidth=function(){return this._size.cellWidth?this._size.cellWidth:this._crosstabConstants.CELL_WIDTH},sap.basetable.crosstab.Crosstab.prototype.getCellHeight=function(){return this._size.cellHeight?this._size.cellHeight:this._crosstabConstants.CELL_HEIGHT},sap.basetable.crosstab.Crosstab.prototype.getRowCellHeight=function(){return this._size.rowCellHeight?this._size.rowCellHeight:this._crosstabConstants.CELL_HEIGHT},sap.basetable.crosstab.Crosstab.prototype.getRowCellWidth=function(){return this._size.rowCellWidth?this._size.rowCellWidth:this._crosstabConstants.ROW_CELL_WIDTH},sap.basetable.crosstab.Crosstab.prototype.getBorderWidth=function(){return this._size.borderWidth?this._size.borderWidth:this.BORDER_WIDTH},sap.basetable.crosstab.Crosstab.prototype.getId=function(){return this._id},sap.basetable.crosstab.Crosstab.prototype.getHeight=function(){return this._size.height},sap.basetable.crosstab.Crosstab.prototype.getWidth=function(){return this._size.width},sap.basetable.crosstab.Crosstab.prototype.getTotalHeight=function(){var t=this.model().getFullAxisLength(this.ROW_AXIS);return this.model().getPageSize()>=t?this.getSize(this.ROW_AXIS,t,!0):t*this.getCellHeight()},sap.basetable.crosstab.Crosstab.prototype.getTotalWidth=function(){var t=this.model().getFullAxisLength(this.COLUMN_AXIS);return this.getSize(this.COLUMN_AXIS,t,!0)},sap.basetable.crosstab.Crosstab.prototype.getSize=function(t,e,s){var a=[{"key":this.ROW_AXIS,"value":this.COLUMN_AXIS},{"key":this.COLUMN_AXIS,"value":this.ROW_AXIS}],r=0,o=0,i=this.model().getDimensions(a[t].value).length;return t===this.ROW_AXIS&&0===e?(i+=1,this.model().getMeasureMembers().length>0&&(i+=1),o=this.getCellHeight()*i):(0===e&&(e=i),a[t].value===this.COLUMN_AXIS&&(i+=1),t===this.ROW_AXIS?(r+=this.getCellHeight()*e,o=this.getCellHeight()*i):(r+=this._renderer.calculateRightAreaWidth(s),o=this._renderer.calculateLeftAreaWidth()),r+o)},sap.basetable.crosstab.Crosstab.prototype.getPageWidth=function(){var t=this.model().getPageSize();return this.getSize(this.COLUMN_AXIS,t)},sap.basetable.crosstab.Crosstab.prototype.getPageHeight=function(){var t=this.model().getPageSize();return this.getSize(this.ROW_AXIS,t)},sap.basetable.crosstab.Crosstab.prototype.getCrosstabElementResizeHandler=function(){return this._crosstabElementResizeHandler},sap.basetable.crosstab.Crosstab.prototype._registerScrollBarEvents=function(){this._registerBorderEvent(),this._registerNextPageEvent(),this._registerUpdateAxisLengthEvent()},sap.basetable.crosstab.Crosstab.prototype._registerBorderEvent=function(){this._crosstabScrollBarEventMediator.subscribe(this._crosstabScrollBarEventConstants.borderEvent,this.borderEvent.bind(this))},sap.basetable.crosstab.Crosstab.prototype.borderEvent=function(t){this.getRenderer().updateContainerBordersEvent(t)},sap.basetable.crosstab.Crosstab.prototype._registerNextPageEvent=function(){this._crosstabScrollBarEventMediator.subscribe(this._crosstabScrollBarEventConstants.nextPageEvent,this.requestNextPageEvent.bind(this))},sap.basetable.crosstab.Crosstab.prototype.requestNextPageEvent=function(t){this.model().fetchPage(t)},sap.basetable.crosstab.Crosstab.prototype._registerUpdateAxisLengthEvent=function(){this._crosstabScrollBarEventMediator.subscribe(this._crosstabScrollBarEventConstants.updateAxisLength,this.updateAxisLength.bind(this))},sap.basetable.crosstab.Crosstab.prototype.updateAxisLength=function(t){var e=this._renderer.getScrollbarVisibility();this._crosstabScrollBarController.updateScrollBars(this._crosstabScrollBarEventConstants.updateAxisLength,t,e)},sap.basetable.crosstab.Crosstab.prototype.container=function(){return this._container},sap.basetable.crosstab.Crosstab.prototype.model=function(){return this._model},sap.basetable.crosstab.Crosstab.prototype.conditionalFormat=function(){return this._conditionalFormat},sap.basetable.crosstab.Crosstab.prototype.setConditionalFormat=function(t){this._conditionalFormat=t},sap.basetable.crosstab.Crosstab.prototype.setConditionalFormatRules=function(t){(null===t||void 0===t)&&(t=[]),(t.length>0||this._conditionalFormatRules.length!==t.length&&"function"==typeof this.draw)&&this.redraw(this._crosstabScrollBarEventConstants.conditionalFormatEvent),this._conditionalFormatRules=t},sap.basetable.crosstab.Crosstab.prototype.setResizedElements=function(t,e){t=t||[],this._model.setResizedElements(t),e||"function"!=typeof this.draw||this.redraw(this._crosstabElementResizedEventConstants.elementResizedEvent)},sap.basetable.crosstab.Crosstab.prototype.crosstabContainers=function(){return this._crosstabContainers},sap.basetable.crosstab.Crosstab.prototype.getRenderer=function(){return this._renderer},sap.basetable.crosstab.Crosstab.prototype.getCrosstabScrollBarController=function(){return this._crosstabScrollBarController},sap.basetable.crosstab.Crosstab.prototype.select=function(t,e,s){return this._model.select(t,e,s)},sap.basetable.crosstab.Crosstab.prototype.setDataProvider=function(t){this._model.setDataProvider(t)},sap.basetable.crosstab.Crosstab.prototype.vizUpdate=function(t){this.setDataProvider(t),this._renderer.draw(),this.renderCellGroups()},sap.basetable.crosstab.Crosstab.prototype.renderCellGroups=function(){var t=this._model.getCellGroups();
t.forEach(function(t){t.draw()})},sap.basetable.crosstab.Crosstab.prototype.redraw=function(t,e){var s=this._renderer.getScrollbarVisibility();if(t===this._crosstabScrollBarEventConstants.conditionalFormatEvent)this._renderer.redrawFromConditionalFormatting(),this._crosstabScrollBarController.updateScrollBars(t,e,s),this._addResizeListener();else if(t===this._crosstabScrollBarEventConstants.newPageEvent)this._renderer.redrawFromPageData(e),this._crosstabScrollBarController.updateScrollBars(t,e,s),this._addResizeListener();else if(t===this._crosstabElementResizedEventConstants.elementResizedEvent){var a=JSON.stringify(this._model.getResizedElements(0))+":"+JSON.stringify(this._model.getResizedElements(1));this._lastResizedElements&&this._lastResizedElements===a||(this.draw(this._size.height,this._size.width,!0),this._addResizeListener(),this._lastResizedElements=a)}},sap.basetable.crosstab.Crosstab.prototype.draw=function(t,e,s){this._updateSize(t,e),this._renderer.draw(t,e);var a=this._renderer.getScrollbarVisibility();this._crosstabScrollBarController.draw(s,a),this._crosstabScrollBarController.attachCrosstabTouchEvents(a),this.model().initializeAxesMetadata()},sap.basetable.crosstab.Crosstab.prototype.drawSection=function(t){var e=t.coordinates,s=this.model().getFullAxisLength(this.ROW_AXIS),a=this.model().getFullAxisLength(this.COLUMN_AXIS);if(e.endRowIndex>=s){e.endRowIndex=0===s?0:s-1;var r=e.endRowIndex-this.model().getPageSize()-1;e.startRowIndex=Math.max(r,0)}if(e.endColumnIndex>=a){e.endColumnIndex=0===a?0:a-1;var o=e.endColumnIndex-this.model().getPageSize()-1;e.startColumnIndex=Math.max(o,0)}this._renderer.drawSection(t);var i=this._renderer.getScrollbarVisibility();this._crosstabScrollBarController.updateScrollBars(this._crosstabScrollBarEventConstants.newSectionEvent,t,i),this._addResizeListener()},sap.basetable.crosstab.Crosstab.prototype.isHorizontallyScrollable=function(){return this._horizontallyScrollable},sap.basetable.crosstab.Crosstab.prototype.setHorizontallyScrollable=function(t){return"boolean"==typeof t&&this._horizontallyScrollable!==t?(this._horizontallyScrollable=t,!0):!1},sap.basetable.crosstab.Crosstab.prototype.isVerticallyScrollable=function(){return this._verticallyScrollable},sap.basetable.crosstab.Crosstab.prototype.setVerticallyScrollable=function(t){return"boolean"==typeof t&&this._verticallyScrollable!==t?(this._verticallyScrollable=t,!0):!1},sap.basetable.crosstab.Crosstab.prototype.getScaleFactor=function(){return this._scaleFactor},sap.basetable.crosstab.Crosstab.prototype.setScaleFactor=function(t){"number"==typeof t&&(this._scaleFactor=t)},sap.basetable.crosstab.Crosstab.prototype.updateAxesMetadata=function(t){this._model.updateAxesMetadata(t)},sap.basetable.crosstab.Crosstab.prototype.addPageData=function(t){this._model.addPageData(t)},sap.basetable.crosstab.Crosstab.prototype._addSelectionListener=function(){$(this._container).on("click",function(t){var e=$(t.target),s=this.getCrosstabScrollBarController().getAllFloatedHeaders(),a="",r=this._model.getMeasureMembers(),o=this.getRenderer().styleSelectedCells(e,s);if(r.length>0)if(o&&o.hasClass("crosstab-cell-selected")){var i=this.getRenderer().getPageCellIdMeasureMap();a=i[o.attr("id")]?i[o.attr("id")]:r[0].id}else a=r[0].id;sap.ui.getCore().getEventBus().publish("crosstab","sap.viz.ext.crosstab.CrosstabEvent.SELECTED",{"mergeKey":a})}.bind(this))},sap.basetable.crosstab.Crosstab.prototype._addResizeListener=function(){this._crosstabElementResizeHandler.addResizeListener()},sap.basetable.crosstab.Crosstab.prototype._updateSize=function(t,e){this._size.height=t,this._size.width=e},sap.basetable.crosstab.Crosstab.prototype.publishNextPageEvent=function(t){this._crosstabScrollBarEventMediator.publish(this._crosstabScrollBarEventConstants.nextPageEvent,t)},sap.basetable.crosstab.Crosstab.prototype.isMetaDataBorderPresent=function(t){var e=null;return t===this._crosstabConstants.Horizontal&&(e=this.model().getMeasureMembers().length>0||this.model().getDimensions(this._crosstabConstants.ROW_AXIS_INDEX).length>0),e},jQuery.sap.declare("sap.basetable.crosstab.CrosstabConstants"),sap.basetable.crosstab.CrosstabConstants=function(){var t={};return t.Both="Both",t.Horizontal="Horizontal",t.HORIZONTAL_SCROLL_WINDOW=50,t.Vertical="Vertical",t.VERTICAL_SCROLL_WINDOW=100,t.RowAxisHeader="RowAxisHeader",t.ROW_AXIS_INDEX=0,t.COLUMN_AXIS_INDEX=1,t.Row="row",t.Column="column",t.GreyBackground="#f7f7f8",t.PositionTop="top",t.PositionLeft="left",t.touchThreshold=20,t.IncreaseAxis="IncreaseAxis",t.DecreaseAxis="DecreaseAxis",t._METADATA_BORDER_HEIGHT=3,t._METADATA_BORDER_WIDTH=2,t._CROSSTAB_LAYOUT_BORDER_WIDTH=2,t._CROSSTAB_LAYOUT_BORDER_HEIGHT=2,t.ROW_CELL_WIDTH=128,t.CELL_WIDTH=96,t.CELL_HEIGHT=32,t.RowAxisHeaderContainerBorderWidth={"top":0,"right":2,"bottom":0,"left":0},t.LayoutBorderWidth={"top":1,"right":0,"bottom":0,"left":1},t.LeftDimensionHeadersBorderWidth={"top":0,"right":0,"bottom":3,"left":0},Object.freeze(t)},jQuery.sap.declare("sap.basetable.crosstab.CrosstabContainers"),sap.basetable.crosstab.CrosstabContainers=function(t){this._crosstab=t,this._crosstabConstants=new sap.basetable.crosstab.CrosstabConstants},sap.basetable.crosstab.CrosstabContainers.prototype={"_overallContainerHeight":null,"_overallContainerWidth":null,"_bodyHeight":null,"_headerHeight":null,"_scrollContainer":null,"_rowAxisHeaderContainer":null,"_rowAxisHeaderContent":null,"_rowAxisContentContainer":null,"_rowAxisContentContent":null,"_columnHeaderContainer":null,"_columnHeaderContent":null,"_leftAreaDimensionHeaderContainer":null,"_leftAreaDimensionHeaderOuterContainer":null,"_leftAreaDimensionHeaderContent":null,"_rowAxisFloatingHeaderContainer":null,"_oLayout":null,"_topSectionContainer":null,"_leftAreaContainerWidth":null,"_rightAreaContainerWidth":null},sap.basetable.crosstab.CrosstabContainers.scrollbarOutsideContainerAdjustment=20,sap.basetable.crosstab.CrosstabContainers.percentageOfLastCellShown=.5,sap.basetable.crosstab.CrosstabContainers.prototype.setOverallContainerHeight=function(t){var e=t?t:this._crosstab.getHeight();this._crosstab.isHorizontallyScrollable()&&(e-=sap.basetable.crosstab.CrosstabContainers.scrollbarOutsideContainerAdjustment),this._overallContainerHeight=e},sap.basetable.crosstab.CrosstabContainers.prototype.getOverallContainerHeight=function(){return this._overallContainerHeight},sap.basetable.crosstab.CrosstabContainers.prototype.setOverallContainerWidth=function(t){var e=t?t:this._crosstab.getWidth();e-=this._crosstab.isVerticallyScrollable()?sap.basetable.crosstab.CrosstabContainers.scrollbarOutsideContainerAdjustment:this._crosstabConstants._METADATA_BORDER_WIDTH+this._crosstabConstants._CROSSTAB_LAYOUT_BORDER_WIDTH,this._overallContainerWidth=e},sap.basetable.crosstab.CrosstabContainers.prototype.getOverallContainerWidth=function(){return this._overallContainerWidth},sap.basetable.crosstab.CrosstabContainers.prototype.setBodyHeight=function(t){this._bodyHeight=t},sap.basetable.crosstab.CrosstabContainers.prototype.setHeaderHeight=function(t){this._headerHeight=t},sap.basetable.crosstab.CrosstabContainers.prototype.getBodyHeight=function(){return this._bodyHeight},sap.basetable.crosstab.CrosstabContainers.prototype.getHeaderHeight=function(){return this._headerHeight},sap.basetable.crosstab.CrosstabContainers.prototype.setScrollContainer=function(t){this._scrollContainer=t},sap.basetable.crosstab.CrosstabContainers.prototype.getScrollContainer=function(){return this._scrollContainer},sap.basetable.crosstab.CrosstabContainers.prototype.setRowAxisHeaderContainer=function(t){this._rowAxisHeaderContainer=t},sap.basetable.crosstab.CrosstabContainers.prototype.getRowAxisHeaderContainer=function(){return this._rowAxisHeaderContainer},sap.basetable.crosstab.CrosstabContainers.prototype.setRowAxisHeaderContent=function(t){this._rowAxisHeaderContent=t},sap.basetable.crosstab.CrosstabContainers.prototype.getRowAxisHeaderContent=function(){return this._rowAxisHeaderContent},sap.basetable.crosstab.CrosstabContainers.prototype.setRowAxisContentContainer=function(t){this._rowAxisContentContainer=t},sap.basetable.crosstab.CrosstabContainers.prototype.getRowAxisContentContainer=function(){return this._rowAxisContentContainer},sap.basetable.crosstab.CrosstabContainers.prototype.setRowAxisContentContent=function(t){this._rowAxisContentContent=t},sap.basetable.crosstab.CrosstabContainers.prototype.getRowAxisContentContent=function(){return this._rowAxisContentContent},sap.basetable.crosstab.CrosstabContainers.prototype.setColumnHeaderContainer=function(t){this._columnHeaderContainer=t},sap.basetable.crosstab.CrosstabContainers.prototype.getColumnHeaderContainer=function(){return this._columnHeaderContainer},sap.basetable.crosstab.CrosstabContainers.prototype.setColumnHeaderContent=function(t){this._columnHeaderContent=t},sap.basetable.crosstab.CrosstabContainers.prototype.getColumnHeaderContent=function(){return this._columnHeaderContent},sap.basetable.crosstab.CrosstabContainers.prototype.setLeftAreaDimensionHeaderContainer=function(t){this._leftAreaDimensionHeaderContainer=t},sap.basetable.crosstab.CrosstabContainers.prototype.getLeftAreaDimensionHeaderContainer=function(){return this._leftAreaDimensionHeaderContainer},sap.basetable.crosstab.CrosstabContainers.prototype.setLeftAreaDimensionHeaderOuterContainer=function(t){this._leftAreaDimensionHeaderOuterContainer=t},sap.basetable.crosstab.CrosstabContainers.prototype.getLeftAreaDimensionHeaderOuterContainer=function(){return this._leftAreaDimensionHeaderOuterContainer},sap.basetable.crosstab.CrosstabContainers.prototype.setLeftAreaDimensionHeaderContent=function(t){this._leftAreaDimensionHeaderContent=t},sap.basetable.crosstab.CrosstabContainers.prototype.getLeftAreaDimensionHeaderContent=function(){return this._leftAreaDimensionHeaderContent},sap.basetable.crosstab.CrosstabContainers.prototype.setRowAxisFloatingHeaderContainer=function(t){this._rowAxisFloatingHeaderContainer=t},sap.basetable.crosstab.CrosstabContainers.prototype.getRowAxisFloatingHeaderContainer=function(){return this._rowAxisFloatingHeaderContainer},sap.basetable.crosstab.CrosstabContainers.prototype.setTopSectionContainer=function(t){this._topSectionContainer=t},sap.basetable.crosstab.CrosstabContainers.prototype.getTopSectionContainer=function(){return this._topSectionContainer},sap.basetable.crosstab.CrosstabContainers.prototype.setLayout=function(t){this._oLayout=t},sap.basetable.crosstab.CrosstabContainers.prototype.getLayout=function(){return this._oLayout},sap.basetable.crosstab.CrosstabContainers.prototype.setLeftAreaContainerWidth=function(t){this._leftAreaContainerWidth=t},sap.basetable.crosstab.CrosstabContainers.prototype.getLeftAreaContainerWidth=function(){return this._leftAreaContainerWidth},sap.basetable.crosstab.CrosstabContainers.prototype.setRightAreaContainerWidth=function(t){this._rightAreaContainerWidth=t},sap.basetable.crosstab.CrosstabContainers.prototype.getRightAreaContainerWidth=function(){return this._rightAreaContainerWidth},sap.basetable.crosstab.CrosstabContainers.prototype.getHorizontalScrollAreas=function(){var t={"bodyContainer":this._rowAxisContentContainer,"bodyContent":this._rowAxisContentContent,"headerContainer":this._columnHeaderContainer,"headerContent":this._columnHeaderContent,"floatingHeaders":null,"fullContainer":this._oLayout};return t},sap.basetable.crosstab.CrosstabContainers.prototype.getVerticalScrollAreas=function(){var t={"bodyContainer":this._rowAxisContentContainer,"bodyContent":this._rowAxisContentContent,"headerContainer":this._rowAxisHeaderContainer,"headerContent":this._rowAxisHeaderContent,"floatingHeaders":null,"fullContainer":this._oLayout};return t},sap.basetable.crosstab.CrosstabContainers.prototype.getRowAxisHeaderScrollAreas=function(){var t={"bodyContainer":this._rowAxisHeaderContainer,"bodyContent":this._rowAxisHeaderContent,"headerContainer":this._leftAreaDimensionHeaderContainer,"headerContent":this._leftAreaDimensionHeaderContent,"floatingHeaders":this._rowAxisFloatingHeaderContainer,"fullContainer":this._oLayout};return t},sap.basetable.crosstab.CrosstabContainers.prototype.replaceContainer=function(t,e){var s;if(e&&e[0]&&e[0].parentElement){var a=e[0].parentElement,r=e[0].nextSibling;e.detach(),s=t.replaceAll(e),r?a.insertBefore(s[0],r):a.appendChild(s[0])}else s=t.replaceAll(e);return s},jQuery.sap.declare("sap.basetable.crosstab.CrosstabDataProvider"),sap.basetable.crosstab.CrosstabDataProvider=function(t,e){this._dataChangeListeners=[],this._jsonData=t,this._feeding=t.feeding,this._consumptionModel=t.consumptionModel,this._measureMembers=[],this._dispatch=e;var s=this._jsonData.windowing?this._jsonData.windowing.pageSize:this._getPageSize();this._scrollPageManager=new sap.basetable.crosstab.ScrollPageManager(t,s,e,this),this._scrollPageManager.initialize(t),this._build()},sap.basetable.crosstab.CrosstabDataProvider.PATH_DELIMITER="|",sap.basetable.crosstab.CrosstabDataProvider.MEMBER_KEY_DELIMITER="&",sap.basetable.crosstab.CrosstabDataProvider.MINIMUM_PAGE_SIZE=100,sap.basetable.crosstab.CrosstabDataProvider.EXPORT_PAGE_SIZE=500,sap.basetable.crosstab.CrosstabDataProvider.prototype._getParameterValue=function(t){for(var e,s=window.location.search.split(/\?|\&/),a=0;s.length>a;++a){var r=s[a].split("=");if(r[0]===t){e=r[1];break}}return e},sap.basetable.crosstab.CrosstabDataProvider.prototype._getPageSize=function(){var t=this._getParameterValue("pageSize"),e=sap.basetable.crosstab.CrosstabDataProvider.MINIMUM_PAGE_SIZE;return t?e=Math.max(t,e):this._isExporting()&&(e=sap.basetable.crosstab.CrosstabDataProvider.EXPORT_PAGE_SIZE),e},sap.basetable.crosstab.CrosstabDataProvider.prototype._isExporting=function(){return this._getParameterValue("EXPORT_DIALOG_EXPORTING")||"true"===this._getParameterValue("export")},sap.basetable.crosstab.CrosstabDataProvider.prototype.addDataChangeListener=function(t){this._dataChangeListeners.push(t)},sap.basetable.crosstab.CrosstabDataProvider.prototype.updateData=function(){this._rebuild()},sap.basetable.crosstab.CrosstabDataProvider.prototype.getDimensions=function(){return this._dimensions},sap.basetable.crosstab.CrosstabDataProvider.prototype.getTupleTree=function(t){if(!this._tupleTree){var e={"rootnode":{"tuplePath":"","children":[]}};return e}return this._tupleTree[t]},sap.basetable.crosstab.CrosstabDataProvider.prototype.getPageSize=function(){return this._scrollPageManager.getPageSize()},sap.basetable.crosstab.CrosstabDataProvider.prototype.getFormatMap=function(){return this._formatMap},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildAxesValuesArray=function(t,e,s,a,r,o,i){var n,l,c,d,b,h;"row"===o?(n=t.dimAxes[a],l=e,c=a,d=t.dimAxes[r],b=s,h=r):"column"===o&&(n=t.dimAxes[r],l=s,c=r,d=t.dimAxes[a],b=e,h=a);for(var p=l?l.startIndexOffset:0,u=b?b.startIndexOffset:0,_=l?Math.max(0,l.endIndexOffset-(l.pageSize-n.values.length)):0,g=b?Math.max(0,b.endIndexOffset-(b.pageSize-d.values.length)):0,C=h?d.values.length-(u+g)-1:0,f=[],m=n?n.values.length-(p+_):1,v=0;m>v;++v)f[v]=[],f[v][C]=void 0;for(var x=t.valueAxes,S=0;x.length>S;++S){var y=x[S],P=y[i];if(P&&P.length>0){if(c&&(p>y[c]||y[c]>n.values.length-_-1)||h&&(u>y[h]||y[h]>d.values.length-g-1))continue;var T=c?y[c]-p:0,A=h?y[h]-u:0;f[T][A]=P}}return f},sap.basetable.crosstab.CrosstabDataProvider.prototype._getAppEntityNameByAttribute=function(t){var e="";if(this._jsonData.consumptionModel){var s=this._jsonData.consumptionModel.entities;s.forEach(function(s){if(s&&s.attributes)for(var a in s.attributes)t===a&&(e=s.caption)})}return e},sap.basetable.crosstab.CrosstabDataProvider.prototype._formatCalculationName=function(t,e){var s={"Running.Sum":"Running_Sum","Running.Min":"Running_Min","Running.Max":"Running_Max","Running.Count":"Running_Count","Running.Average":"Running_Avg","Moving.Average":"Moving_Avg","Percentage":"Percentage"},a=!1,r=s[t]||t;return e&&e.withEmpties&&(a="false"===e.withEmpties),a&&(r+="_NE"),r},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildMeasureAggregationTypeMap=function(t,e){var s={};if(t[e]&&t[e].components)for(var a=0;t[e].components.length>a;++a){var r=t[e].components[a];s[r.id]=r.aggregationType}else if(t.dataQuery&&t.dataQuery.dataSources)for(var o=0;t.dataQuery.dataSources.length>o;++o){var i=t.dataQuery.dataSources[o];if(i.entities)for(var n=0;i.entities.length>n;++n){var l=i.entities[n];"measure"===l.analyticType&&(s[l.refId]=l.aggregationType)}}return s},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildMeasuresInfo=function(t,e,s,a,r){var o={"members":[],"axisPosition":s,"containAggregationNone":!1},i=t.layout?t.layout:t;if(e&&i[e]){var n=this._buildMeasureAggregationTypeMap(t,e),l=i[e].components;this._measureMembers=l;var c=0;l.forEach(function(t){var e={"id":t.id};if(a&&r)if("calculation"===t.analyticType)if(t.key&&t.key.calculation){var s=this._buildEntityIdCaptionMapFromConsumption(this._consumptionModel),i=s[t.key.calculation.measure];i===void 0&&(i=this._getAppEntityNameByAttribute(t.key.calculation.measure));var l=t.key.calculation.type,d=t.key.calculation.properties;e.caption=this._formatCalculationName(l,d)+": "+i}else e.caption=a[t.id],e.caption===void 0&&(e.caption=r[t.id]);else e.caption=a[t.id];o.containAggregationNone=o.containAggregationNone||"none"===n[t.id],"calculation"!==t.analyticType?(e.indexForSubTotal=c,c++):e.indexForSubTotal=-1,o.members.push(e)}.bind(this))}return o},sap.basetable.crosstab.CrosstabDataProvider.prototype.getMeasureMembers=function(){return this._measureMembers},sap.basetable.crosstab.CrosstabDataProvider.sanitizeMemberKey=function(t){var e;return e=void 0===t||null===t?"<<null>>":""===t?"<<empty>>":t},sap.basetable.crosstab.CrosstabDataProvider.sanitizeMemberValue=function(t){var e;return e=null===t?"":t},sap.basetable.crosstab.CrosstabDataProvider._buildMemberKey=function(t){var e=sap.basetable.crosstab.CrosstabDataProvider.sanitizeMemberKey(t.key);if(t.properties&&(t.properties.secondaryDistinctCount!==void 0&&(e+=sap.basetable.crosstab.CrosstabDataProvider.MEMBER_KEY_DELIMITER+(""+t.properties.secondaryDistinctCount)),t.properties.parentId!==void 0)){var s='"'+sap.basetable.crosstab.CrosstabDataProvider.sanitizeMemberKey(t.properties.parentId)+'"';e+=sap.basetable.crosstab.CrosstabDataProvider.MEMBER_KEY_DELIMITER+s}return e},sap.basetable.crosstab.CrosstabDataProvider.prototype._addChildNode=function(t,e,s,a,r,o){var i={"tuplePath":0===t.tuplePath.length?e:t.tuplePath+sap.basetable.crosstab.CrosstabDataProvider.PATH_DELIMITER+e,"member":{"id":s,"caption":a},"children":[]};return r&&(i.member.stackIndex=t.member?t.member.stackIndex+1:0),o&&(i.dataPoints=[]),t.children.push(i),i},sap.basetable.crosstab.CrosstabDataProvider.prototype._addChildMeasureNode=function(t,e,s,a,r,o){var i=this._addChildNode(t,e,s,a,r,o);return i.isMeasure=!0,i},sap.basetable.crosstab.CrosstabDataProvider.prototype._addEmptySubTotalNode=function(t,e,s){var a={"tuplePath":0===t.tuplePath.length?"":t.tuplePath+sap.basetable.crosstab.CrosstabDataProvider.PATH_DELIMITER+"","member":{"id":"","caption":""},"children":[],"isTotal":!0};return e&&(a.member.stackIndex=t.member?t.member.stackIndex+1:0),s&&(a.dataPoints=[]),t.children.push(a),a},sap.basetable.crosstab.CrosstabDataProvider.prototype._addSubTotalNode=function(t,e,s,a,r,o){var i=new sap.cvom.crosstabviewer.LanguageManager,n={"tuplePath":0===t.tuplePath.length?e:t.tuplePath+sap.basetable.crosstab.CrosstabDataProvider.PATH_DELIMITER+e,"member":{"id":e,"caption":i.get(this._getAggregationLabel(e)),"aggregationTarget":s},"children":[],"isTotal":!0};a&&(n.member.stackIndex=t.member?t.member.stackIndex+1:0),r&&(n.dataPoints=[]),t.children.push(n);for(var l=0;o>l;++l)n=this._addEmptySubTotalNode(n,a,r);return n},sap.basetable.crosstab.CrosstabDataProvider.prototype._addDataPoints=function(t,e,s,a,r,o,i){for(var n=t[i],l=0;n.length>l;++l){var c=n[l]?n[l][r]:"";e&&(this._addSubTotalValues(e,s,l,o,i),e.dataPoints.push(c),l===n.length-1&&this._addSubTotalValues(e,s,n.length,o,i)),a&&(a[l]||(a[l]=[]),a[l].push(c))}},sap.basetable.crosstab.CrosstabDataProvider.prototype._addSubTotalNodeDataPoints=function(t,e,s,a){for(var r=0;t.length>r;++r){var o=void 0===t[r]?"":t[r];e&&(this._addEmptySubTotalValues(e,s,r),e.dataPoints.push(o),r===t.length-1&&this._addEmptySubTotalValues(e,s,t.length)),a&&(a[r]||(a[r]=[]),a[r].push(o))}},sap.basetable.crosstab.CrosstabDataProvider.prototype._addFlattenSubTotalValues=function(t,e,s,a){for(var r in e)if(e.hasOwnProperty(r)){var o=e[r];for(var i in o)if(o.hasOwnProperty(i)){var n=o[i];for(var l in n)if(n.hasOwnProperty(l))for(var c=n[l].aggregations,d=0;c.length>d;++d){var b=c[d],h=t[l].aggregations[b.aggregation];0>s?h.push(""):h.push(b.values[s][a])}}}},sap.basetable.crosstab.CrosstabDataProvider.prototype._addEmptyFlattenSubTotalValues=function(t){for(var e in t)if(t.hasOwnProperty(e)){var s=t[e].aggregations;for(var a in s)s.hasOwnProperty(a)&&s[a].push("")}},sap.basetable.crosstab.CrosstabDataProvider.prototype._addSubTotalValues=function(t,e,s,a,r){var o=e[s];if(void 0!==o)for(var i=o.length-1;i>=0;--i){var n=o[i];if(void 0!==n)for(var l in n)if(n.hasOwnProperty(l))for(var c=n[l],d=0;c.aggregations.length>d;++d){var b="",h=c.aggregations[d].values[a];h&&void 0!==h[r]&&(b=h[r]),t.dataPoints.push(b)}}},sap.basetable.crosstab.CrosstabDataProvider.prototype._addEmptySubTotalValues=function(t,e,s){var a=e[s];if(void 0!==a)for(var r=a.length-1;r>=0;--r){var o=a[r];if(void 0!==o)for(var i in o)if(o.hasOwnProperty(i))for(var n=o[i],l=0;n.aggregations.length>l;++l)t.dataPoints.push("")}},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildAxisTupleTree=function(t,e,s,a,r,o,i,n,l,c){var d,b={"rootnode":{"tuplePath":"","children":[]}},h=b.rootnode;if(e){var p,u=t.dimAxes[e],_=[];if(n)for(d in n)if(n.hasOwnProperty(d)){var g=n[d];p=g.level;var C=_[p];void 0===C&&(C={},_[p]=C),C[d]=[h]}for(var f=l?l.startIndexOffset:0,m=l?Math.max(0,l.endIndexOffset-(l.pageSize-u.values.length)):0,v=f,x=u.values.length-m;x>v;++v){for(var S=h,y=u.values[v],P=y.length,T=0;P>T;++T){S.numOfLeafChildren=S.numOfLeafChildren?S.numOfLeafChildren+1:1;var A=S.children[S.children.length-1],I=T,R=y[I],w=sap.basetable.crosstab.CrosstabDataProvider._buildMemberKey(t.metadata.dictionary[e][I].value[R]);o&&o.containAggregationNone&&T==P-1&&(w=w+"_"+v);var H=sap.basetable.crosstab.CrosstabDataProvider.sanitizeMemberValue(t.metadata.dictionary[e][I].value[R].attributes.value[0]);if(A&&A.member.id===w&&A.member.caption===H)S=A;else{var E=sap.basetable.crosstab.CrosstabDataProvider._buildMemberKey(t.metadata.dictionary[e][I].value[R]);S=this._addChildNode(S,E,w,H,s,r)}if(n){var M=this._buildTuplePath(t,e,y,I);for(d in n)if(this._containsTuplePath(d,M)){p=n[d].level;var D=_[p][d];D[T+1]=S}}r&&i&&T===P-1&&(S.dataPoints=i[v-f])}if(n)for(var B=u.values[v+1],z=this._buildTuplePath(t,e,B),L=_.length-1;L>=0;--L){var O=_[L];if(void 0!==O)for(var N in O)if(O.hasOwnProperty(N)){p=n[N].level;var F=p+1;if(void 0!==O[N]&&O[N].length===F&&(null===z&&c||null!==z&&!this._containsTuplePath(z,N))){var W=O[N],U=W[W.length-1],V=n[N].aggregations;for(var q in V)if(V.hasOwnProperty(q)){for(var $=0;W.length>$;++$)W[$].numOfLeafChildren++;var k=t.metadata.dictionary[e].length-W.length,j=this._addSubTotalNode(U,q,null,s,r,k);r&&(j.dataPoints=n[N].aggregations[q])}O[N]=[h]}}}}}else r&&i&&(h.dataPoints=i[0]);return b},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildMeasureAxisTupleTree=function(t,e,s,a,r,o,i,n,l,c,d,b,h){var p={"rootnode":{"tuplePath":"","children":[]}},u=p.rootnode;if(e){var _,g=t.dimAxes[e],C=b?b.measureStartIndex:0,f=b?b.measureEndIndex:o.members.length-1,m=d?d.startIndexOffset:0,v=null,x=[];for(var S in l)if(l.hasOwnProperty(S)){var y=l[S];_=y.level;var P=x[_];void 0===P&&(P={},x[_]=P),P[S]=[u]}for(var T=d?d.startIndexOffset:0,A=d?Math.max(0,d.endIndexOffset-(d.pageSize-g.values.length)):0,I=T,R=g.values.length-A;R>I;){var w=u,H=g.values[I],E=H.length+1,M=-1;o.members&&o.members.length>C&&(M=o.members[C].indexForSubTotal);for(var D,B=0;E>B;++B){D=w;var z=w.children[w.children.length-1],L=o.axisPosition===B&&o.members.length>0,O=B>=o.axisPosition?B-1:B,N=H[O],F=L?o.members[C].id:sap.basetable.crosstab.CrosstabDataProvider._buildMemberKey(t.metadata.dictionary[e][O].value[N]);o.containAggregationNone&&B==E-1&&(F=F+"_"+I);var W=L?o.members[C].caption:sap.basetable.crosstab.CrosstabDataProvider.sanitizeMemberValue(t.metadata.dictionary[e][O].value[N].attributes.value[0]);if(z&&z.member.id===F&&z.member.caption===W)w=z;else{L&&(v=w);var U=L?o.members[C].caption:sap.basetable.crosstab.CrosstabDataProvider._buildMemberKey(t.metadata.dictionary[e][O].value[N]);w=L?this._addChildMeasureNode(w,U,F,W,s,r):this._addChildNode(w,U,F,W,s,r)}D.numOfLeafChildren=D.numOfLeafChildren?D.numOfLeafChildren+1:1;var V=this._buildTuplePath(t,e,H,O);if(M>=0)for(var q in l)if(this._containsTuplePath(q,V)){_=l[q].level;var $=o.axisPosition>_?_:_+1;if($>B){var k=x[_][q];k[B+1]=w}}(r||i)&&B===E-1&&this._addDataPoints(a,r?w:null,c,i,C,M,I-T)}n&&this._addFlattenSubTotalValues(n,c,M,I-T);for(var j,G,X,Y,Q,K,Z,J,te,ee=g.values[I+1],se=this._buildTuplePath(t,e,ee),ae=x.length-1;ae>=0;--ae){var re=x[ae];if(void 0!==re)for(var oe in re)if(re.hasOwnProperty(oe)){_=l[oe].level;var ie=_>=o.axisPosition?_+2:_+1;if(void 0!==re[oe]&&re[oe].length===ie&&(null===se&&h||null!==se&&!this._containsTuplePath(se,oe)))if(o.axisPosition>_){if(C===o.members.length-1){for(j=l[oe].aggregations,X=0;j.length>X;++X){G=j[X],K=re[oe];for(var ne=0;o.members.length>ne;++ne){var le=o.members[ne].indexForSubTotal;if(le>=0&&(Q=G.values[le],Y=o.members[ne],Q)){for(Z=0;K.length>Z;++Z)K[Z].numOfLeafChildren++;D=K[K.length-1],J=t.metadata.dictionary[e].length-K.length+1,te=this._addSubTotalNode(D,G.aggregation,Y,s,r,J),(r||i)&&this._addSubTotalNodeDataPoints(Q,r?te:null,c,i),n&&this._addEmptyFlattenSubTotalValues(n)}}}re[oe]=[u]}}else if(M>=0){for(j=l[oe].aggregations,X=0;j.length>X;++X)if(G=j[X],Y=o.members[C],K=re[oe],Q=G.values[M]){for(Z=0;K.length>Z;++Z)K[Z].numOfLeafChildren++;D=K[K.length-1],J=t.metadata.dictionary[e].length-K.length+1,te=this._addSubTotalNode(D,G.aggregation,Y,s,r,J),(r||i)&&this._addSubTotalNodeDataPoints(Q,r?te:null,c,i),n&&this._addEmptyFlattenSubTotalValues(n)}re[oe]=[u]}}}if(ee){for(var ce=o.axisPosition-1,de=!0,be=0;ce>=be;++be)if(H[be]!==ee[be]){de=!1;break}if(!de){if(C!==o.members.length-1){C++,I=m;continue}C=0,m=I+1}}else if(f&&f>C){C++,I=m;continue}I++}}else{for(var he=0;o.members.length>he;++he){var pe=o.members[he],ue=this._addChildMeasureNode(u,pe.caption,pe.id,pe.caption,s,r);(r||i)&&this._addDataPoints(a,r?ue:null,c,i,he,pe.indexForSubTotal,0),n&&this._addFlattenSubTotalValues(n,c,pe.indexForSubTotal,0)}u.numOfLeafChildren=o.members.length}return p},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildFlattenSubtotalValues=function(t,e){var s=e?e:{};for(var a in t)if(t.hasOwnProperty(a)){var r=t[a];if(r)for(var o=0;r.length>o;++o){var i=r[o];if(i)for(var n in i)if(i.hasOwnProperty(n)){s[n]={"level":o,"aggregations":{}};for(var l=i[n].aggregations,c=0;l.length>c;++c){var d=l[c];s[n].aggregations[d.aggregation]=[]}}}}return s},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildTupleTrees=function(t,e,s,a,r,o,i,n,l,c,d,b,h,p){var u,_,g,C=c?c[r]:null,f=c?c[o]:null,m=b?b[r]:null,v=b?b[o]:null;if("row"===i||"column"===i){var x=this._buildAxesValuesArray(e,C,f,r,o,i,n),S=this._buildMeasuresInfo(t,n,l,s,a),y="row"===i?r:o,P="row"===i?o:r,T=c?c[y]:null,A=c?c[P]:null,I="row"===i?h:p,R=this._buildMeasureAxisSubTotalTuples(t,e,y,A,P,n),w=b?b[P]:null,H="row"===i?p:h,E=this._buildAxisSubTotalTuples(t,e,A,w,P,T,y,n,H);if(g=this._buildFlattenSubtotalValues(E),"row"===i)u=this._buildMeasureAxisTupleTree(e,r,!1,x,!0,S,null,g,R,E,C,d,I),_=this._buildAxisTupleTree(e,o,!0,null,!1,S,null,g,f,H);else{var M=[];_=this._buildMeasureAxisTupleTree(e,o,!0,x,!1,S,M,g,R,E,f,d,I),u=this._buildAxisTupleTree(e,r,!1,null,!0,S,M,g,C,H)}}else{var D=this._buildAxisSubTotalTuples(t,e,C,m,r,f,o,n,h);g=this._buildFlattenSubtotalValues(D),u=this._buildAxisTupleTree(e,r,!1,null,!0,null,null,g,C,h);var B=this._buildAxisSubTotalTuples(t,e,f,v,o,C,r,n,p);g=this._buildFlattenSubtotalValues(B),_=this._buildAxisTupleTree(e,o,!0,null,!1,null,null,g,f,p)}return[u,_]},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildAxisDimensions=function(t,e,s,a){for(var r=new sap.cvom.crosstabviewer.LanguageManager,o={"dimensions":[]},i=t.metadata.dictionary[s],n=0;i&&i.length>n;++n){var l=i[n].id,c={"id":l,"caption":e[l]};o.dimensions.push(c)}if(null!==a){var d={"id":"MeasureNamesDimension","caption":r.get("XTAB_MEASURE_AXIS_TITLE")};o.dimensions.splice(a,0,d)}return o},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildAxesDimensions=function(t,e,s,a,r,o){var i="row"===r?o:null,n=this._buildAxisDimensions(t,e,s,i),l="column"===r?o:null,c=this._buildAxisDimensions(t,e,a,l);return[n,c]},sap.basetable.crosstab.CrosstabDataProvider.prototype._findAxisName=function(t,e){var s=null;if(e.length>0){var a=t.dimAxes;for(var r in a)if(a.hasOwnProperty(r)){for(var o=t.metadata.dictionary[r],i=[],n=0;o.length>n;++n)i.push(o[n].id);if(e.length===i.length){s=r;for(var l=0;e.length>l;++l)if(-1===i.indexOf(e[l])){s=null;break}}if(null!==s)break}}return s},sap.basetable.crosstab.CrosstabDataProvider.prototype._findMeasureGroupName=function(t){var e=null;if(t){var s=t.layout?t.layout:t;for(var a in s)if(s.hasOwnProperty(a)&&"numerical"===s[a].axisType){e=a;break}}return e},sap.basetable.crosstab.CrosstabDataProvider.prototype._getAggregationTypes=function(t,e,s){for(var a=[],r=t.layout?t.layout:t,o=r[e].calculations,i=0;o.length>i;++i)if(o[i].id===s){for(var n=0;o[i].definitions.length>n;++n)a.push(o[i].definitions[n].aggregationType);break}return a},sap.basetable.crosstab.CrosstabDataProvider.prototype._getAggregationLabel=function(t){var e=null;switch(t.toLowerCase()){case"default":e="XTAB_SUBTOTAL_LABEL_TOTAL";break;case"sum":e="XTAB_SUBTOTAL_LABEL_SUM";break;case"count":e="XTAB_SUBTOTAL_LABEL_COUNT";break;case"average":e="XTAB_SUBTOTAL_LABEL_AVERAGE";break;case"min":e="XTAB_SUBTOTAL_LABEL_MIN";break;case"max":e="XTAB_SUBTOTAL_LABEL_MAX";break;default:}return e},sap.basetable.crosstab.CrosstabDataProvider.prototype._getMeasureIndices=function(t,e,s,a){var r=[],o=[],i=t.layout?t.layout:t;if(a&&i[a]){var n=i[a].components;n.forEach(function(t){var e=t.analyticType;"calculation"!==e&&o.push(t.id)})}for(var l=t.layout?t.layout:t,c=l[e].calculations,d=0;c.length>d;++d)if(c[d].id===s){for(var b=0;c[d].target.length>b;++b){var h=c[d].target[b].id,p=o.indexOf(h);r.push(p)}break}return r},sap.basetable.crosstab.CrosstabDataProvider.prototype._coordsStartsWith=function(t,e){for(var s=!0,a=0;e.length>a;++a)if(t[a]!==e[a]){s=!1;break}return s},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildTuplePath=function(t,e,s,a){var r=null;if(s){r="";for(var o=void 0===a?s.length:a+1,i=0;o>i;++i){var n=s[i];r.length>0&&(r+=sap.basetable.crosstab.CrosstabDataProvider.PATH_DELIMITER),r+=sap.basetable.crosstab.CrosstabDataProvider._buildMemberKey(t.metadata.dictionary[e][i].value[n])}}return r},sap.basetable.crosstab.CrosstabDataProvider.prototype._containsTuplePath=function(t,e){if(void 0!==t&&void 0!==e){if(t===e||0===e.length)return!0;if(0!==t.indexOf(e))return!1;var s=t.split(sap.basetable.crosstab.CrosstabDataProvider.PATH_DELIMITER),a=e.split(sap.basetable.crosstab.CrosstabDataProvider.PATH_DELIMITER);if(s.length>=a.length){for(var r=0;a.length>r;r++)if(a[r]!==s[r])return!1;return!0}}return!1},sap.basetable.crosstab.CrosstabDataProvider.prototype._findSubtotalAxisIndex=function(t,e,s,a,r,o,i){var n=null,l=t.dimAxes[a].values.length;if(void 0===r||0===r.length)o?null===e||null===s?n=l:(e.page+1)*e.pageSize-e.endIndexOffset>=s&&(n=l):null===e||null===s?n=0:0===e.page+e.startIndexOffset&&(n=0);else if(o)for(var c=0,d=e?e.startIndexOffset:0,b=e?Math.max(0,e.endIndexOffset-(e.pageSize-l)):0,h=d;l-b>h;++h){var p=t.dimAxes[a].values[h],u=t.dimAxes[a].values[h+1];
if(this._coordsStartsWith(p,r)&&(void 0===u&&i||void 0!==u&&!this._coordsStartsWith(u,r))){n=c+1;break}c++}return n},sap.basetable.crosstab.CrosstabDataProvider.prototype._coordsEqual=function(t,e){var s=!0;if(t.length===e.length){for(var a=0;t.length>a;++a)if(t[a]!==e[a]){s=!1;break}}else s=!1;return s},sap.basetable.crosstab.CrosstabDataProvider.prototype._addAggregationValues=function(t,e,s,a,r,o,i){for(var n=0;o.length>n;++n){for(var l=o[n],c=null,d=0;e.length>d;++d)if(e[d].aggregation===l){c=e[d];break}null===c&&(c={"aggregation":l,"values":[]},e.push(c));for(var b=a?a.startIndexOffset:0,h=a?Math.max(0,a.endIndexOffset-(a.pageSize-t.dimAxes[r].values.length)):0,p=0;i.length>p;++p){var u=i[p],_=c.values[u];if(void 0===_){_=[];var g;g=null===r?1:t.dimAxes[r].values.length-(b+h),_[g-1]=void 0,c.values[u]=_}if(null===r)_[0]=s.values[n][u];else for(var C=s.window[r],f=t.dimAxes[r].values,m=0,v=b;f.length-h>v;++v){if(this._coordsEqual(f[v],C)){(void 0===_[m]||null===_[m])&&(_[m]=s.values[n][u]);break}m++}}}return e},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildAxisSubTotalTuples=function(t,e,s,a,r,o,i,n,l){var c=[],d=e.calculations;if(d){var b=d[r];if(b)for(var h=0;b.length>h;++h)for(var p=b[h],u=this._getAggregationTypes(t,r,p.id),_=this._getMeasureIndices(t,r,p.id,n),g=0;p.values.length>g;++g){var C=p.values[g],f=C.window[r]?C.window[r]:[],m=this._findSubtotalAxisIndex(e,s,a,r,f,!0,l);if(null!==m){var v=c[m];void 0===v&&(v=[],c[m]=v);var x=f.length,S=v[x];void 0===S&&(S={},v[x]=S);var y=this._buildTuplePath(e,r,f),P=S[y];void 0===P&&(P={"aggregations":[]},S[y]=P),this._addAggregationValues(e,P.aggregations,C,o,i,u,_)}}}return c},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildMeasureAxisSubTotalTuples=function(t,e,s,a,r,o){var i={},n=e.calculations;if(n){var l=n[s];if(l)for(var c=0;l.length>c;++c)for(var d=l[c],b=this._getAggregationTypes(t,s,d.id),h=this._getMeasureIndices(t,s,d.id,o),p=0;d.values.length>p;++p){var u=d.values[p],_=u.window[s]?u.window[s]:[],g=i,C=this._buildTuplePath(e,s,_),f=g[C];void 0===f&&(f={"level":_.length,"aggregations":[]},g[C]=f),this._addAggregationValues(e,f.aggregations,u,a,r,b,h)}}return i},sap.basetable.crosstab.CrosstabDataProvider.prototype._processAxisFeeding=function(t){for(var e=null,s=0,a=[],r=0,o=0;t.length>o;++o){var i=t[o];if("dimension"===i.type)a.push(i.id);else if("hierarchy"===i.type){for(var n=0;i.levels.length>n;n++){var l=i.levels[n];if(a.push(l.id),r++,l.selected)break}r-=1}else"measure"===i.type&&(s++,null===e&&(e=o+r))}var c={"measureAxisPosition":e,"numMeasures":s,"dimensionIdArray":a};return c},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildEntityIdCaptionMapFromConsumption=function(t){var e={};if(t){for(var s=0;t.entities.length>s;++s){var a=t.entities[s];e[a.id]=a.caption}if(t.userHierarchies)for(var r=0;t.userHierarchies.length>r;++r)if(t.userHierarchies[r].levels)for(var o=0;t.userHierarchies[r].levels.length>o;++o){var i=t.userHierarchies[r].levels[o];e[i.id]=i.caption}}return e},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildEntityIdCaptionMap=function(t){var e={};if(t){var s=function(t){e[t.id]=t.name,"hierarchy"===t.type&&t.levels&&t.levels.forEach(function(t){e[t.id]=t.name}.bind(this))}.bind(this);t.cols.forEach(s),t.rows.forEach(s),t.values.forEach(s)}return e},sap.basetable.crosstab.CrosstabDataProvider.prototype.buildMeasureIdCaptionMap=function(t){var e={};if(t)for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s].name);return e},sap.basetable.crosstab.CrosstabDataProvider.prototype._buildFormatMap=function(){var t={};if(this._measureMembers&&this._measureMembers.length>0){var e=this._jsonData.formatArr,s=sap.basetable.crosstab.utils.FormatUtils.createFormatArray(e);if(s&&s.length>0)for(var a=0,r=0;this._measureMembers.length>r;r++){var o=this._measureMembers[r];t[o.id]=s[a],a++}}return t},sap.basetable.crosstab.CrosstabDataProvider.prototype._build=function(){var t=null,e=null,s=this._processAxisFeeding(this._feeding.cols),a=s.dimensionIdArray;null!==s.measureAxisPosition&&(t="column",e=s.measureAxisPosition),s=this._processAxisFeeding(this._feeding.rows);var r=s.dimensionIdArray;null===t&&null!==s.measureAxisPosition&&(t="row",e=s.measureAxisPosition);var o=this._jsonData.queryResponse[0],i=this._findAxisName(o,a),n=this._findAxisName(o,r),l=this._buildEntityIdCaptionMap(this._jsonData.feeding),c=this._scrollPageManager.getPageSize(),d=this._jsonData.windowing?this._jsonData.windowing.pages[0].rowPageIndex:0,b=this._jsonData.windowing?this._jsonData.windowing.pages[0].columnPageIndex:0,h={"startRowIndex":d*c,"startColumnIndex":b*c};h.endRowIndex=h.startRowIndex+(c-1),h.endColumnIndex=h.startColumnIndex+(c-1),this._scrollPageManager.fetchViewPage(h,this),this._dimensions=this._buildAxesDimensions(o,l,n,i,t,e),this._formatMap=this._buildFormatMap(t),this._rowHeadersDirty=!0,this._columnHeadersDirty=!0,this._cellsDirty=!0},sap.basetable.crosstab.CrosstabDataProvider.prototype._rebuild=function(){this._rowHeadersDirty=!0,this._columnHeadersDirty=!0,this._cellsDirty=!0,this._notifyDataChangeListeners()},sap.basetable.crosstab.CrosstabDataProvider.prototype._notifyDataChangeListeners=function(){this._dataChangeListeners.forEach(function(t){t.dataChanged(this)})},sap.basetable.crosstab.CrosstabDataProvider.prototype.setTupleTrees=function(t,e){this._tupleTree=e},sap.basetable.crosstab.CrosstabDataProvider.prototype.initializeAxesMetadata=function(){this._scrollPageManager.initializeAxesMetadata()},sap.basetable.crosstab.CrosstabDataProvider.prototype.updateAxesMetadata=function(t,e){this._scrollPageManager.updateAxesMetadata(t,e)},sap.basetable.crosstab.CrosstabDataProvider.prototype._addPage=function(t,e,s){this._scrollPageManager.addPage(t,e,s)},sap.basetable.crosstab.CrosstabDataProvider.prototype._fetchViewPage=function(t,e){this._scrollPageManager.fetchViewPage(t,e)},sap.basetable.crosstab.CrosstabDataProvider.prototype.getFullAxisLength=function(t){return this._scrollPageManager.getFullAxisLength(t)},sap.basetable.crosstab.CrosstabDataProvider.prototype.elementsResized=function(t){this._dispatch.crosstableElementsResized({"crosstab":{"resizedElements":t}}),this._dispatch.initialized()},jQuery.sap.declare("sap.basetable.crosstab.CrosstabElementResizedEventConstants"),sap.basetable.crosstab.CrosstabElementResizedEventConstants=function(){var t={};return t.elementResizedEvent="elementResizedEvent",t.columnDimensionWidth="COLUMN_DIMENSION_WIDTH",t.rowDimensionWidth="ROW_DIMENSION_WIDTH",t.emptyColumnDimension="__:__",Object.freeze(t)},jQuery.sap.declare("sap.basetable.crosstab.CrosstabElementResizeHandler"),sap.basetable.crosstab.CrosstabElementResizeHandler=function(t,e,s,a){this._crosstab=t,this._model=e,this._renderer=s,this._crosstabElementResizedEventConstants=a},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype={"_inResizingState":!1},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype.getResizedState=function(){return this._inResizingState},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype.addResizeListener=function(){var t=this._crosstab.container().closest(".sapUI5Crosstab");t.unbind("mousedown"),t.mousedown(this._startResize.bind(this)),t.unbind("mouseup"),t.mouseup(this._stopResize.bind(this)),window.TouchEvent&&!sap.ui.Device.browser.internet_explorer&&this._setResizeListenerToTouch(t),sap.ui.Device.browser.internet_explorer&&window.navigator.msPointerEnabled&&this._setResizeListenerToPointer(t)},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype._setResizeListenerToTouch=function(t){t.unbind("touchstart touchmove touchend contextmenu"),t.bind("touchstart touchmove touchend contextmenu",this._handleResizeTouch.bind(this))},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype._setResizeListenerToPointer=function(t){t.unbind("pointerdown pointerup pointermove contextmenu"),t.bind("pointerdown pointerup pointermove contextmenu",this._handleResizeTouch.bind(this))},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype._handleResizeTouch=function(t){var e=$(t.target);if(e.hasClass("crosstab-resizable")){t.preventDefault(),t.stopPropagation();var s;switch(t.type){case"contextmenu":return;case"touchstart":case"pointerdown":s="mousedown";break;case"touchmove":case"pointermove":s="mousemove";break;case"touchend":case"pointerup":s="mouseup";break;default:return}var a=document.createEvent("MouseEvent");if(sap.ui.Device.browser.internet_explorer)a.initMouseEvent(s,!0,!0,window,1,t.originalEvent.screenX,t.originalEvent.screenY,t.originalEvent.clientX,t.originalEvent.clientY,!1,!1,!1,!1,0,null);else{var r=t.changedTouches[0];a.initMouseEvent(s,!0,!0,window,1,r.screenX,r.screenY,r.clientX,r.clientY,!1,!1,!1,!1,0,null),e=r.target}e.dispatchEvent(a)}},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype._startResize=function(t){var e=$(t.target);if(e.hasClass("crosstab-resizable")){this._inResizingState=!0;var s=e.parent(),a=t.clientX,r=s.attr("id"),o=r.split("_");this._columnResizingData={"originalStartPoint":a,"target":s,"treePathToCell":o},this._createVisualLineForResize(a,s)}},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype._handleResize=function(t,e){e.preventDefault(),e.stopPropagation();var s=$("#crosstab-resizable-line");s.css("left",(e.pageX-t)/this._crosstab.getScaleFactor())},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype._stopResize=function(t){var e=$("#crosstab-resizable-line");if(e.length&&(e.remove(),$(".sapUI5Crosstab").unbind("mousemove")),this._columnResizingData){var s,a=t.clientX,r=this._columnResizingData.originalStartPoint&&a?a-this._columnResizingData.originalStartPoint:"",o=this._columnResizingData.target.width()+r,i=this._crosstab.container();if(Math.abs(r)>2&&i&&i.has(this._columnResizingData.target).length&&(o=Math.floor(Math.max(this._renderer.MINIMUM_RESIZED_CELL_WIDTH,o)),s=this._createTreePathToCell(this._columnResizingData.treePathToCell,o),this._model.elementsResized(s)),this._columnResizingData=null,sap.ui.Device.browser.internet_explorer){var n=i.find(".crosstab-resizable");n.removeClass("crosstab-resizable"),setTimeout(function(){n.addClass("crosstab-resizable")},100)}this._inResizingState=!1}},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype._createVisualLineForResize=function(t,e){var s=e.closest(".sapUI5Crosstab"),a="crosstab-resizable-line",r=this._setParametersForVisualLine(e,s,t),o=$(document.createElement("div"));jQuery("#crosstab-resizable-line").remove(),o.attr("id",a),o.css({"height":r.height+"px","line-height":r.height+"px","left":r.left+"px","top":r.top+"px"}),s.append(o),s.mousemove(this._handleResize.bind(this,r.offsetLeft))},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype._setParametersForVisualLine=function(t,e,s){var a,r=e.find("#crosstabLayout"),o=e.find("#crosstabScrollContainer"),i=Math.max(r.height(),o.height()),n=parseInt(o.css("border-top-width"),10),l=i+n,c=n,d=e.offset().left,b=this._crosstab.getScaleFactor();return(t.closest("#rowAxisContent-Container").length||t.closest("#columnHeader-Container").length)&&(a=e.find("#colDimRow"),a.length&&(c=(a.offset().top-e.offset().top)/b)),l-=c,{"top":c,"height":l,"offsetLeft":d,"left":(s-d)/b}},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype._createTreePathToCell=function(t,e){var s;if(t.length)switch(s=this._treePathToCellHelper(t[0])){case"RowAxisheaderCell":return{"type":this._crosstabElementResizedEventConstants.rowDimensionWidth,"index":t.length-2,"width":e};case"dataCell":return{"type":this._crosstabElementResizedEventConstants.columnDimensionWidth,"index":parseInt(t[t.length-1]),"width":e};case"ColumnMemberHeaderCell":return{"type":this._crosstabElementResizedEventConstants.columnDimensionWidth,"tupleIndex":t.slice(1,t.length),"width":e};default:return{"type":this._crosstabElementResizedEventConstants.rowDimensionWidth,"dimensionId":s+this._createTreePathId(t),"width":e}}},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype._createTreePathId=function(t){for(var e="",s=1;t.length>s;s++)e=e+"_"+t[s];return e},sap.basetable.crosstab.CrosstabElementResizeHandler.prototype._treePathToCellHelper=function(t){var e=t.replace("#","");return-1!==e.indexOf("ui5crosstab")||-1!==e.indexOf("Crosstab")?(e=e.split("-"),e[1]):e},jQuery.sap.declare("sap.basetable.crosstab.CrosstabDataModel"),sap.basetable.crosstab.CrosstabModel=function(t,e,s,a,r){this._crosstab=e,this._crosstabScrollBarEventMediator=s,this._crosstabScrollBarEventConstants=a,this._crosstabElementResizedEventConstants=r,this._rowAxisLength=null,this._columnAxisLength=null,this._currentVerticalPosition=0,this._currentHorizontalPosition=0,this._recentPageData={"redrawRowAxisHeader":null,"redrawRowAxisContent":null,"redrawColumnHeader":null,"coordinates":{"startRowIndex":0,"startColumnIndex":0,"endRowIndex":0,"endColumnIndex":0}},this._cellGroup=[],this._dimensionHeaderTemplates=[],this._tupleTrees=[],this._tupleMap=[],this._resizedElements=[{},{}],this._measuresPosition={"axis":null,"level":null},t.dataProvider&&(this._dataProvider=t.dataProvider,this._tupleTrees[0]=this._dataProvider.getTupleTree(0),this._tupleTrees[1]=this._dataProvider.getTupleTree(1),this._buildTupleMap(),this._currentCoordinates=[{"rowAxisIndex":0,"columnAxisIndex":0},{"rowAxisIndex":this.getPageSize(),"columnAxisIndex":this.getPageSize()}]),this._isCellJustResized=!1,this._crosstabConstants=new sap.basetable.crosstab.CrosstabConstants},sap.basetable.crosstab.CrosstabModel.prototype._initializeRecentPageData=function(){this._recentPageData.coordinates.endRowIndex=this.getPageSize()-1,this._recentPageData.coordinates.endColumnIndex=this.getPageSize()-1},sap.basetable.crosstab.CrosstabModel.prototype.getDimensions=function(t){return this._dataProvider.getDimensions()[t].dimensions},sap.basetable.crosstab.CrosstabModel.prototype.getTupleTree=function(t){return this._tupleTrees[t]},sap.basetable.crosstab.CrosstabModel.prototype.getResizedElements=function(t){return this._resizedElements.length>t?this._resizedElements[t]:void 0},sap.basetable.crosstab.CrosstabModel.prototype.setResizedElements=function(t){t&&2===t.length&&"object"==typeof t[0]&&"object"==typeof t[1]||(t=[{},{}]),this._resizedElements=t},sap.basetable.crosstab.CrosstabModel.prototype.elementsResized=function(t){if(t&&t.type){switch(t.type){case this._crosstabElementResizedEventConstants.columnDimensionWidth:var e=null;if("tupleIndex"in t){for(var s=this._tupleTrees[1].rootnode,a=0;t.tupleIndex.length>a;a++){var r=t.tupleIndex[a];s=s.children[r]}e=""+s.tuplePath}else if("index"in t){var o=this._dataProvider.getDimensions()[1].dimensions.length;if(0===o)e=this._crosstabElementResizedEventConstants.emptyColumnDimension;else for(var i in this._tupleMap[1])if(2===this._tupleMap[1][i].length&&this._tupleMap[1][i][0]===t.index&&this._tupleMap[1][i][1]===t.index+1&&this.getTupleDepth(i)===o&&":"!==i){e=i;break}}e&&(this._resizedElements[0][e]=t.width);break;case this._crosstabElementResizedEventConstants.rowDimensionWidth:var n;if("dimensionId"in t)n=t.dimensionId;else{var l=this.getDimensions(0);n=l[t.index].id}this._resizedElements[1][n]=t.width;break;default:throw Error("Event type "+t.type+" not supported!")}this._isCellJustResized=!0,this._dataProvider.elementsResized(this._resizedElements)}},sap.basetable.crosstab.CrosstabModel.prototype.getTupleDepth=function(t){var e=!1,s=0;if(t){for(var a=0;t.length>=a;a++){var r=t.charAt(a);if('"'===r)e=!e;else if("|"!==r||e){if("\\"===r){a++;continue}}else s++}return s+1}},sap.basetable.crosstab.CrosstabModel.prototype.getDataCells=function(t,e,s){return this._dataProvider.getDataCells(t,e,s)},sap.basetable.crosstab.CrosstabModel.prototype.getCellGroups=function(){return this._cellGroup},sap.basetable.crosstab.CrosstabModel.prototype.getMeasuresPosition=function(){if(!$.isEmptyObject(this._measuresPosition)){for(var t=this.getDimensions(0),e=this.getDimensions(1),s=0;e.length>s;s++)if("MeasureNamesDimension"===e[s].id){this._measuresPosition.axis="column",this._measuresPosition.level=s;break}if("column"!==this._measuresPosition.axis)for(var a=0;t.length>a;a++)if("MeasureNamesDimension"===t[a].id){this._measuresPosition.axis="row",this._measuresPosition.level=a;break}}return this._measuresPosition},sap.basetable.crosstab.CrosstabModel.prototype.select=function(t,e,s){var a=this._cellGroup.length,r=new sap.basetable.crosstab.CellGroup(this,a,t,e,s);return this._cellGroup.push(r),r},sap.basetable.crosstab.CrosstabModel.prototype.setDataProvider=function(t){this._dataProvider=t,this._initializeRecentPageData(),this._rebuild()},sap.basetable.crosstab.CrosstabModel.prototype.getMeasureMembers=function(){return this._dataProvider.getMeasureMembers()},sap.basetable.crosstab.CrosstabModel.prototype.createDimensionHeaderTemplate=function(t){var e=this._dimensionHeaderTemplates.length;t.id=e;var s=new sap.basetable.crosstab.DimensionHeaderTemplate(t);this._dimensionHeaderTemplates.push(s)},sap.basetable.crosstab.CrosstabModel.prototype.getDimensionHeaderTemplate=function(t){return this._dimensionHeaderTemplates.forEach(function(e){return t===e.dimensionId||""===t?e.cellTemplate:void 0}),null},sap.basetable.crosstab.CrosstabModel.prototype.getTupleIndex=function(t,e){return this._tupleMap[t][e]},sap.basetable.crosstab.CrosstabModel.prototype.getNumberOfTuples=function(t){return this._tupleTrees[t].rootnode.numOfLeafChildren},sap.basetable.crosstab.CrosstabModel.prototype.addTuplePath=function(t,e,s){for(var a=0;e.children.length>a;a++){var r=e.children[a],o=r.tuplePath,i=r.numOfLeafChildren?r.numOfLeafChildren:1;this._tupleMap[t][o]=[s,s+i],r.children.length>0?s=this.addTuplePath(t,r,s):s++}return s},sap.basetable.crosstab.CrosstabModel.prototype._buildTupleMap=function(){this._tupleTrees.forEach(function(t,e){var s=0,a=t.rootnode,r=a.numOfLeafChildren?a.numOfLeafChildren:1;this._tupleMap[e]=[],this._tupleMap[e][":"]=[0,r],this.addTuplePath(e,a,s)}.bind(this))},sap.basetable.crosstab.CrosstabModel.prototype._rebuild=function(){this._tupleTrees[0]=this._dataProvider.getTupleTree(0),this._tupleTrees[1]=this._dataProvider.getTupleTree(1),this._tupleMap=[],this._buildTupleMap(),this._numberFormat_Map=this._dataProvider.getFormatMap()},sap.basetable.crosstab.CrosstabModel.prototype.fetchPage=function(t){var e=this._currentHorizontalPosition,s=this._currentVerticalPosition;this.updateRowAxisLength(),this.updateColumnAxisLength();var a=this._calculatePageAxisCoordinates(this._rowAxisLength,s,this._crosstabConstants.VERTICAL_SCROLL_WINDOW);t.coordinates.startRowIndex=a.startAxisIndex,t.coordinates.endRowIndex=a.endAxisIndex;var r=this._calculatePageAxisCoordinates(this._columnAxisLength,e,this._crosstabConstants.HORIZONTAL_SCROLL_WINDOW);t.coordinates.startColumnIndex=r.startAxisIndex,t.coordinates.endColumnIndex=r.endAxisIndex,-1===t.coordinates.endColumnIndex&&(t.coordinates.endColumnIndex=0),-1===t.coordinates.endRowIndex&&(t.coordinates.endRowIndex=0),this.fetchPageDirectly(t)},sap.basetable.crosstab.CrosstabModel.prototype._calculatePageAxisCoordinates=function(t,e,s){var a,r;if(s>=t)a=0,r=t-1;else{var o=t-1;r=this._calculateEndAxisIndex(e,s),a=this._calculateStartAxisIndex(e,s),r>o?(r=o,a=t-s):0>=a?(a=0,r=s-1):r-=1}return{"startAxisIndex":a,"endAxisIndex":r}},sap.basetable.crosstab.CrosstabModel.prototype._calculateStartAxisIndex=function(t,e){var s=t-e/2;return Math.floor(s)},sap.basetable.crosstab.CrosstabModel.prototype._calculateEndAxisIndex=function(t,e){var s=t+e/2;return Math.floor(s)},sap.basetable.crosstab.CrosstabModel.prototype.fetchPageDirectly=function(t){this._recentPageData=t,this._dataProvider._fetchViewPage(t.coordinates,this)},sap.basetable.crosstab.CrosstabModel.prototype.getRecentPageData=function(){return this._recentPageData},sap.basetable.crosstab.CrosstabModel.prototype.setTupleTrees=function(t,e){if(this._recentPageData.coordinates===t)if(this._dataProvider.setTupleTrees(t,e),this._rebuild(),this._crosstab.isHorizontallyScrollable()&&this._crosstab.isVerticallyScrollable())this._crosstab.redraw(this._crosstabScrollBarEventConstants.newPageEvent,this._recentPageData);else{var s=this.getSectionData(t);this._crosstab.drawSection(s,!1)}},sap.basetable.crosstab.CrosstabModel.prototype.getSectionData=function(t){var e,s=this.getPageSize(),a=s-1>=t.endRowIndex;e=this._crosstab.isHorizontallyScrollable()?!0:s-1>=t.endColumnIndex;var r=0,o=0;t.startRowIndex>0&&(r=t.startRowIndex*this._crosstab.getCellHeight()),this._crosstab.isHorizontallyScrollable()||t.startColumnIndex>0&&(o=t.startColumnIndex*this._crosstab.getCellWidth());var i=this._crosstab.model().getDimensions(0),n=this._crosstab.model().getDimensions(1),l={"redrawRowAxisHeader":0!==i.length,"redrawRowAxisContent":!0,"redrawColumnHeader":0!==n.length,"coordinates":t,"showRowAxisHeaders":e,"showColumnAxisHeaders":a,"topBuffer":r,"leftBuffer":o};return l},sap.basetable.crosstab.CrosstabModel.prototype.setFullAxisLength=function(t,e){var s={"axisIndex":t,"length":e};this._crosstabScrollBarEventMediator.publish(this._crosstabScrollBarEventConstants.updateAxisLength,s)},sap.basetable.crosstab.CrosstabModel.prototype.updateRowAxisLength=function(){this._rowAxisLength=this.getFullAxisLength(this._crosstab.ROW_AXIS)},sap.basetable.crosstab.CrosstabModel.prototype.updateColumnAxisLength=function(){this._columnAxisLength=this.getFullAxisLength(this._crosstab.COLUMN_AXIS)},sap.basetable.crosstab.CrosstabModel.prototype.getFullAxisLength=function(t){return this._dataProvider.getFullAxisLength(t)},sap.basetable.crosstab.CrosstabModel.prototype.initializeAxesMetadata=function(){this._dataProvider.initializeAxesMetadata()},sap.basetable.crosstab.CrosstabModel.prototype.updateAxesMetadata=function(t){this._dataProvider.updateAxesMetadata(t,this)},sap.basetable.crosstab.CrosstabModel.prototype.addPageData=function(t){this._dataProvider._addPage(t.page,t.windowIndex,t)},sap.basetable.crosstab.CrosstabModel.prototype.getFormat=function(t){return void 0===this._numberFormat_Map?this._numberFormat_Map:this._numberFormat_Map[t]},sap.basetable.crosstab.CrosstabModel.prototype.getPageSize=function(){return this._dataProvider.getPageSize()},sap.basetable.crosstab.CrosstabModel.prototype.setVerticalScrollPosition=function(t){this._currentVerticalPosition=t},sap.basetable.crosstab.CrosstabModel.prototype.setHorizontalScrollPosition=function(t){this._currentHorizontalPosition=t},sap.basetable.crosstab.CrosstabModel.prototype.getStartColumnIndex=function(){var t=0;return $.isNumeric(this._recentPageData.coordinates.startColumnIndex)&&(t=this._recentPageData.coordinates.startColumnIndex),t},sap.basetable.crosstab.CrosstabModel.prototype.getStartRowIndex=function(){var t=0;return $.isNumeric(this._recentPageData.coordinates.startRowIndex)&&(t=this._recentPageData.coordinates.startRowIndex),t},sap.basetable.crosstab.CrosstabModel.prototype.getStartColumnIndex=function(){var t=0;return $.isNumeric(this._recentPageData.coordinates.startColumnIndex)&&(t=this._recentPageData.coordinates.startColumnIndex),t},sap.basetable.crosstab.CrosstabModel.prototype.getEndRowIndex=function(){var t=Math.min(this.getFullAxisLength(this._crosstab.ROW_AXIS),this.getPageSize());return $.isNumeric(this._recentPageData.coordinates.endColumnIndex)&&(t=this._recentPageData.coordinates.endRowIndex),t},sap.basetable.crosstab.CrosstabModel.prototype.getEndColumnIndex=function(){var t=Math.min(this.getFullAxisLength(this._crosstab.COLUMN_AXIS),this.getPageSize());return $.isNumeric(this._recentPageData.coordinates.endColumnIndex)&&(t=this._recentPageData.coordinates.endColumnIndex),t},sap.basetable.crosstab.CrosstabModel.prototype.isCellJustResized=function(){return this._isCellJustResized},jQuery.sap.declare("sap.basetable.crosstab.CrosstabRenderer"),sap.basetable.crosstab.CrosstabRenderer=function(t,e){this._crosstab=t,this._crosstabContainers=this._crosstab.crosstabContainers(),this.oConditionalCellFormatter=new sap.basetable.crosstab.ConditionalCellFormatter,this._crosstabScrollBarEventMediator=e,this._crosstabConstants=new sap.basetable.crosstab.CrosstabConstants,this._crosstabElementResizedEventConstants=new sap.basetable.crosstab.CrosstabElementResizedEventConstants,this._columnSubtotals=[],this._measuresMap=[],this._pageCellIdMeasureMap={}},sap.basetable.crosstab.CrosstabRenderer.prototype={"_oLayout":null,"_leftAreaContainerMaxSizeOfWindow":.3,"_horizontalScrollBarVisible":!1,"_verticalScrollBarVisible":!1,"_rowAxisHeaderScrollBarVisible":!1,"_isContentWidthGreaterThanContainerWidth":!1,"_isLeftAreaGreaterThanThirtyPercentOfContainerWidth":!1,"_isContentHeightGreaterThanContainerHeight":!1,"_isLoading":!1,"_CELL_CORRECTION_PIXEL_OFFSET":1,"_FIRST_COLUMN_DIMENSION_CELL":"crosstab-ColumnDimensionCell-first","MINIMUM_RESIZED_CELL_WIDTH":32,"_HIDE_SECTION":"crosstab-hideSection","_MEASURES_SPAN":"Crosstab-MeasuresSpan","_MEASURES_ICON_CONTAINER_WIDTH":24},sap.basetable.crosstab.CrosstabRenderer.prototype.getMeasuresMap=function(t){return"number"==typeof t?this._measuresMap[t]:this._measuresMap},sap.basetable.crosstab.CrosstabRenderer.prototype.createContentSpan=function(t,e,s,a,r){var o=$(document.createElement("span"));return e=null===e?"":e,o[0].innerHTML=e,void 0!==r&&o[0].setAttribute("title",r),o[0].className+=s?" crosstab-Total":" crosstab-CellContent",$.isEmptyObject(a)||o[0].setAttribute("style",a),o},sap.basetable.crosstab.CrosstabRenderer.prototype.createContentCell=function(t,e,s,a,r,o,i,n){var l,c;$.isEmptyObject(o)||(l=sap.basetable.crosstab.utils.RenderUtils.styleClasstoString(o),c=o["background-color"]);var d=this.createContentSpan(t,e,s,l,i),b=0===t.indexOf("dataCell_0"),h=sap.basetable.crosstab.utils.RenderUtils.createContentCell(t,this._crosstab.getCellWidth(),this.getUpdatedCellHeight(b),this._crosstab.getBorderWidth(),d,a,r,"crosstab-Cell",!1,n);return c&&c.length>0&&h.css({"background-color":c}),h},sap.basetable.crosstab.CrosstabRenderer.prototype.createHeaderCell=function(t,e,s,a,r,o,i,n,l,c,d,b,h,p){var u;if(o&&o.length>0){u=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell(t+"-children");for(var _=0;o.length>_;_++)u.append(o[_]);u.addClass("crosstab-ChildrenCell")}var g=this.createContentSpan(t,e,s),C=n?this._crosstab.getCellHeight():this._crosstab.getCellHeight()-1;g.css({"line-height":C+"px","min-height":C+"px"});var f,m=n?"crosstab-Cell-Top":"crosstab-Cell";return f=b?sap.basetable.crosstab.utils.RenderUtils.createHeaderCell(t,this._crosstab.getRowCellWidth(),this._crosstab.getRowCellHeight(),this._crosstab.getBorderWidth(),g,u,a,r,m,l,e,h,!1):sap.basetable.crosstab.utils.RenderUtils.createHeaderCell(t,this._crosstab.getCellWidth(),this._crosstab.getCellHeight(),this._crosstab.getBorderWidth(),g,u,a,r,m,l,e,h,p),i&&f.addClass(i),d&&(this._pageCellIdMeasureMap[t]=c),f},sap.basetable.crosstab.CrosstabRenderer.prototype.createDimensionHeaderCell=function(t,e,s,a,r,o){var i=$(document.createElement("span")),n=r?!1:!0;i.text(e),i.attr("title",e),i.addClass("crosstab-CellContent"),o=a?o+1:o;var l;0>t.indexOf("MeasureNamesDimension")?l="Crosstab-"+t:(l=t,i.attr("id",this._MEASURES_SPAN));var c=sap.basetable.crosstab.utils.RenderUtils.createHeaderCell(l,o,this._crosstab.getCellHeight(),this._crosstab.getBorderWidth(),i,void 0,void 0,void 0,void 0,void 0,void 0,void 0,n);return c.addClass("crosstab-DimensionCell"),s&&c.addClass(s),c},sap.basetable.crosstab.CrosstabRenderer.prototype._hasDataPoints=function(t){for(var e=0;t.children.length>e;e++){var s=t.children[e];if(s.dataPoints&&s.dataPoints.length>0)return!0;if(s.children&&s.children.length>0&&this._hasDataPoints(s)===!0)return!0}return t.children&&0>=t.children.length&&t.dataPoints&&t.dataPoints.length>0?!0:!1},sap.basetable.crosstab.CrosstabRenderer.prototype.draw=function(t,e){this._crosstab.container().html("");var s=this._crosstab.model().getDimensions(0),a=this._crosstab.model().getDimensions(1),r=this._crosstab.model().getTupleTree(0).rootnode,o=this._crosstab.model().getTupleTree(1).rootnode,i=this.calculateLeftAreaWidth(),n=this.calculateRightAreaWidth(),l=(a.length+1)*this._crosstab.getCellHeight(),c=r.numOfLeafChildren?r.numOfLeafChildren*this._crosstab.getCellHeight():0;this._crosstabContainers.setHeaderHeight(l),this._crosstabContainers.setBodyHeight(c),0===this._crosstabContainers.getBodyHeight()&&this._hasDataPoints(r)&&this._crosstabContainers.setBodyHeight(this._crosstab.getCellHeight());var d=i+n,b=this._crosstabContainers.getHeaderHeight()+this._crosstabContainers.getBodyHeight(),h={"layoutTotalWidth":d,"layoutTotalHeight":b,"rowDimensions":s,"columnDimensions":a,"rowTupleRootNode":r,"columnTupleRootNode":o};this._setOverallContainerSizes(t,e);var p=this.createLayout(h);if(this.createTopSection(p.layoutObject,i,n,s,a,r,o),this.createBottomSection(p.layoutObject,i,n,s,r),this.createScrollContainer(p.layoutObject),this._setContainerSizes(i,n),this._createLoadingIndicator(p),!this._crosstab.isHorizontallyScrollable()||!this._crosstab.isVerticallyScrollable()){var u=this._crosstab.model().getRecentPageData().coordinates,_=this._crosstab.model().getSectionData(u);this._drawPostProcessing(_)}},sap.basetable.crosstab.CrosstabRenderer.prototype._drawPostProcessing=function(t){this._addBuffer(t),this._determineSectionsToHide(t)},sap.basetable.crosstab.CrosstabRenderer.prototype._setOverallContainerSizes=function(t,e){this._crosstabContainers.setOverallContainerHeight(t),this._crosstabContainers.setOverallContainerWidth(e)},sap.basetable.crosstab.CrosstabRenderer.prototype.getScrollbarVisibility=function(){var t={"horizontalScrollBar":this._horizontalScrollBarVisible&&this._isHeaderHeightLessThanContainerHeight(),"verticalScrollBar":this._verticalScrollBarVisible&&this._isHeaderHeightLessThanContainerHeight(),"rowAxisHeaderScrollBar":this._rowAxisHeaderScrollBarVisible&&this._isHeaderHeightLessThanContainerHeight(),"isVerticallyScrollable":this._crosstab.isVerticallyScrollable()};return t},sap.basetable.crosstab.CrosstabRenderer.prototype._isHeaderHeightLessThanContainerHeight=function(){return this._crosstabContainers._headerHeight<this._crosstabContainers._overallContainerHeight},sap.basetable.crosstab.CrosstabRenderer.prototype.createScrollContainer=function(t){var e=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell("crosstabScrollContainer");if(e.addClass("crosstab-Scroll-Container"),!this._crosstab.isVerticallyScrollable()){var s=this._crosstab.getTotalHeight();e.css({"height":s})}if(!this._crosstab.isHorizontallyScrollable()){var a=this._crosstab.getTotalWidth();e.css({"width":a})}this._crosstabContainers.setScrollContainer(e),this._crosstab.container().append(e),e.append(t)},sap.basetable.crosstab.CrosstabRenderer.prototype.createLayout=function(t){var e=[],s=this._getCrosstabLayoutSize(t);t.layoutTotalWidth<=s.width&&e.push("borderRightWidth"),t.layoutTotalHeight<=s.height&&e.push("borderBottomWidth");var a=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayout("crosstabLayout",s.width,s.height);a.addClass("crosstab-Layout"),0===t.rowDimensions.length&&0===t.columnDimensions.length&&a.addClass("noBorder");for(var r=0;e.length>r;r++)a.addClass(e[r]);return this._crosstab.isVerticallyScrollable()&&this._crosstab.isHorizontallyScrollable()||a.css({"position":"relative"}),this._crosstabContainers.setLayout(a),{"layoutObject":a,"layoutSize":s}},sap.basetable.crosstab.CrosstabRenderer.prototype._setContainerSizes=function(t,e){this._setContainerBoundaries(t,e),this._resetScrollBarVisibleFlags(),this.intializeScrollContainers(t,e),this._rowAxisHeaderScrollBarVisible&&!this._horizontalScrollBarVisible&&this.updateContainerWidths()},sap.basetable.crosstab.CrosstabRenderer.prototype._createLoadingIndicator=function(t){this._loadingIndicator=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell("crosstabLoadingIndicator"),this._loadingIndicator.addClass("crosstab-loadingIndicator crosstab-loadingHidden");var e=Math.round(t.layoutSize.height/2),s=Math.round(t.layoutSize.width/2);this._loadingIndicator.css({"top":e,"left":s}),t.layoutObject.append(this._loadingIndicator)
},sap.basetable.crosstab.CrosstabRenderer.prototype._getCrosstabLayoutSize=function(t){var e=this._crosstabContainers.getOverallContainerHeight(),s=this._crosstabContainers.getOverallContainerWidth();return s>=t.layoutTotalWidth&&(s=t.layoutTotalWidth),e>=t.layoutTotalHeight&&(e=t.layoutTotalHeight),t.rowDimensions.length>0&&(this._hasDataPoints(t.rowTupleRootNode)||t.columnTupleRootNode.numOfLeafChildren)&&(s+=this._crosstabConstants._METADATA_BORDER_WIDTH),this._crosstab.isMetaDataBorderPresent(this._crosstabConstants.Horizontal)&&(e+=this._crosstabConstants._METADATA_BORDER_HEIGHT),{"height":e,"width":s}},sap.basetable.crosstab.CrosstabRenderer.prototype._resetScrollBarVisibleFlags=function(){this._rowAxisHeaderScrollBarVisible=!1,this._horizontalScrollBarVisible=!1,this._verticalScrollBarVisible=!1},sap.basetable.crosstab.CrosstabRenderer.prototype._setContainerBoundaries=function(t,e){this._setIsContentWidthGreaterThanContainerWidth(t,e),this._setIsLeftAreaGreaterThanThirtyPercentOfContainerWidth(t),this._setIsContentHeightGreaterThanContainerHeight()},sap.basetable.crosstab.CrosstabRenderer.prototype._setIsContentWidthGreaterThanContainerWidth=function(t,e){this._isContentWidthGreaterThanContainerWidth=t+e>this._crosstabContainers.getOverallContainerWidth()?!0:!1},sap.basetable.crosstab.CrosstabRenderer.prototype._setIsLeftAreaGreaterThanThirtyPercentOfContainerWidth=function(t){this._isLeftAreaGreaterThanThirtyPercentOfContainerWidth=t>this._crosstabContainers.getOverallContainerWidth()*this._leftAreaContainerMaxSizeOfWindow?!0:!1},sap.basetable.crosstab.CrosstabRenderer.prototype._setIsContentHeightGreaterThanContainerHeight=function(){this._isContentHeightGreaterThanContainerHeight=this._crosstabContainers.getHeaderHeight()+this._crosstabContainers.getBodyHeight()>this._crosstabContainers.getOverallContainerHeight()?!0:!1},sap.basetable.crosstab.CrosstabRenderer.prototype.updateContainerWidths=function(){var t=this._crosstabContainers.getLeftAreaContainerWidth(),e=this._crosstabContainers.getRightAreaContainerWidth(),s=this._crosstabContainers.getLayout();$(s).css({"width":t+e+this._crosstabConstants._METADATA_BORDER_WIDTH}),$(s).addClass("borderRightWidth")},sap.basetable.crosstab.CrosstabRenderer.prototype.intializeScrollContainers=function(t,e){this._crosstab.isHorizontallyScrollable()&&(this._setLeftAreaContainerWidth(t,e),this._setHorizontalScrollBarVisible()),this._crosstab.isVerticallyScrollable()&&this._setVerticalScrollBarVisible(),this._setContainers(t,e)},sap.basetable.crosstab.CrosstabRenderer.prototype._setLeftAreaContainerWidth=function(t,e){if(this._isContentWidthGreaterThanContainerWidth&&this._isLeftAreaGreaterThanThirtyPercentOfContainerWidth){this._rowAxisHeaderScrollBarVisible=!0;var s=this._crosstabContainers.getOverallContainerWidth(),a=Math.floor(s*this._leftAreaContainerMaxSizeOfWindow);if(s>a+e){var r=s-e;this._crosstabContainers.setLeftAreaContainerWidth(r)}else this._crosstabContainers.setLeftAreaContainerWidth(a)}else this._crosstabContainers.setLeftAreaContainerWidth(t);this._setIsContentWidthGreaterThanContainerWidth(this._crosstabContainers.getLeftAreaContainerWidth(),e)},sap.basetable.crosstab.CrosstabRenderer.prototype._setHorizontalScrollBarVisible=function(){this._isContentWidthGreaterThanContainerWidth&&(this._horizontalScrollBarVisible=!0)},sap.basetable.crosstab.CrosstabRenderer.prototype._setVerticalScrollBarVisible=function(){this._isContentHeightGreaterThanContainerHeight&&(this._verticalScrollBarVisible=!0)},sap.basetable.crosstab.CrosstabRenderer.prototype._setContainers=function(t,e){this._isContentHeightGreaterThanContainerHeight&&this._isContentWidthGreaterThanContainerWidth?(this.setRightAreaContainerWidth(e),this.setRowHeaderContainerSize(!0),this.setColumnHeaderContainerSize(),this.setBodyContainerSize(!0,this._crosstabConstants.Both)):this._isContentHeightGreaterThanContainerHeight?(this.setRightAreaContainerWidth(e),this.setRowHeaderContainerSize(!0),this.setBodyContainerSize(!0,this._crosstabConstants.Vertical)):this._isContentWidthGreaterThanContainerWidth&&(this.setRightAreaContainerWidth(e),this.setColumnHeaderContainerSize(),this.setBodyContainerSize(!0,this._crosstabConstants.Horizontal)),this._rowAxisHeaderScrollBarVisible&&(this._horizontalScrollBarVisible||this._verticalScrollBarVisible?this._horizontalScrollBarVisible&&!this._verticalScrollBarVisible?(this.setRowHeaderContainerSize(!1),this.setLeftAreaDimensionHeaderContainer()):this.setLeftAreaDimensionHeaderContainer():(this.setRightAreaContainerWidth(e),this.setLeftAreaDimensionHeaderContainer(),this.setRowHeaderContainerSize(!1),this.setColumnHeaderContainerSize(),this.setBodyContainerSize(!1)))},sap.basetable.crosstab.CrosstabRenderer.prototype.setLeftAreaDimensionHeaderContainer=function(){$(this._crosstabContainers.getLeftAreaDimensionHeaderContainer()).css({"height":this._crosstabContainers.getHeaderHeight(),"width":this._crosstabContainers.getLeftAreaContainerWidth()+this._CELL_CORRECTION_PIXEL_OFFSET}),$(this._crosstabContainers.getLeftAreaDimensionHeaderOuterContainer()).css({"height":this._crosstabContainers.getHeaderHeight(),"width":this._crosstabContainers.getLeftAreaContainerWidth()+this._crosstabContainers.getRightAreaContainerWidth()+this._crosstabConstants._METADATA_BORDER_WIDTH})},sap.basetable.crosstab.CrosstabRenderer.prototype.setRightAreaContainerWidth=function(t){this._isContentWidthGreaterThanContainerWidth?this._crosstabContainers.setRightAreaContainerWidth(this._crosstabContainers.getOverallContainerWidth()-this._crosstabContainers.getLeftAreaContainerWidth()):this._crosstabContainers.setRightAreaContainerWidth(t)},sap.basetable.crosstab.CrosstabRenderer.prototype.setBodyContainerSize=function(t,e){var s=this._crosstabContainers.getBodyHeight(),a=e===this._crosstabConstants.Vertical||e===this._crosstabConstants.Both,r=t&&a;r&&(s=this._crosstabContainers.getOverallContainerHeight()-this._crosstabContainers.getHeaderHeight()),$(this._crosstabContainers.getRowAxisContentContainer()).css({"height":s,"width":this._crosstabContainers.getRightAreaContainerWidth()})},sap.basetable.crosstab.CrosstabRenderer.prototype.setRowHeaderContainerSize=function(t){var e,s=this._crosstabContainers.getRowAxisHeaderContainer(),a=this._crosstabContainers.getLeftAreaContainerWidth();if(t){e=this._crosstabContainers.getHeaderHeight();var r=this._crosstabContainers.getOverallContainerHeight()-e;$(s).css({"height":r,"width":a})}else e=this._crosstabContainers.getBodyHeight(),$(s).css({"height":e,"width":a})},sap.basetable.crosstab.CrosstabRenderer.prototype._incrementWidthIfHorizontalScrollbarVisible=function(t){var e=t,s=this._crosstab.model().getDimensions(0);return this._horizontalScrollBarVisible&&s.length>0?e+this._CELL_CORRECTION_PIXEL_OFFSET:e},sap.basetable.crosstab.CrosstabRenderer.prototype.setColumnHeaderContainerSize=function(){var t=this._crosstabContainers.getColumnHeaderContainer(),e=this._incrementWidthIfHorizontalScrollbarVisible(this._crosstabContainers.getRightAreaContainerWidth());$(t).css({"height":this._crosstabContainers.getHeaderHeight(),"width":e})},sap.basetable.crosstab.CrosstabRenderer.prototype.createRowDimensionHeader=function(t,e,s,a){var r,o=!0,i=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell("leftAreaDimensionHeader-Container");i.addClass("crosstab-LeftDimensionHeaders"),this._crosstabContainers.setLeftAreaDimensionHeaderContainer(i),this._hasDataPoints(s)||!(e.length>0)&&a.numOfLeafChildren||(t-=1);var n=t;if(this._hasDataPoints(s)&&!a.numOfLeafChildren){var l=this._crosstab.model().getResizedElements(0),c=this._crosstabElementResizedEventConstants.emptyColumnDimension,d=l[c]?l[c]:this._crosstab.getCellWidth();t=t+d+this._crosstabConstants._METADATA_BORDER_WIDTH,t>this._crosstabContainers.getOverallContainerWidth()&&(t=this._crosstabContainers.getOverallContainerWidth()+this._crosstabConstants._METADATA_BORDER_WIDTH),r=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell("leftAreaDimensionHeader-ScrollbarContainer"),this._crosstabContainers.setLeftAreaDimensionHeaderContainer(r),this._crosstabContainers.setLeftAreaDimensionHeaderOuterContainer(i)}var b=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayout("leftAreaDimensionHeader-Content",t);b.addClass("crosstab-Layout-Column");var h;a.numOfLeafChildren||(h=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayout("leftAreaDimensionHeader-Content-inner",n)),this._hasDataPoints(s)||a.numOfLeafChildren?a.numOfLeafChildren&&b.addClass("leftArea"):b.addClass("noDataPoints"),this._crosstabContainers.setLeftAreaDimensionHeaderContent(b);var p=this._crosstabContainers.getHeaderHeight();b.css({"height":p-1+"px"});var u=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("leftAreaDimensionHeaderCellRow",p);void 0!==h?(h.append(u),b.append(h)):b.append(u);var _=this._crosstab.model().getResizedElements(1);return e.forEach(function(t){var s=_[t.id];s||(s=this._crosstab.getRowCellWidth());var r=e.length>0&&a.numOfLeafChildren,i=this.createDimensionHeaderCell(t.id,t.caption,"crosstab-RowDimensionCell",r,o,s);if(i.find(".crosstab-resizable").css("height",p),"MeasureNamesDimension"===t.id){var n=$(document.createElement("div")).attr("id","Crosstab-MeasuresIconContainer").addClass("icon-Crosstab-Measures-Rows"),l=i.find("#"+this._MEASURES_SPAN);l.css("width",i.children().width()-this._MEASURES_ICON_CONTAINER_WIDTH),i.children().prepend(n)}i.attr("valign","bottom"),u.append(i)}.bind(this)),r?(r.append(b),i.append(r)):i.append(b),i},sap.basetable.crosstab.CrosstabRenderer.prototype._isAdditionalBorderVisible=function(t,e){if(t.length>0&&e.length>0)return!1;for(var s=0;t.length>s;s++)if("MeasureNamesDimension"===t[s].id)return!1;return!0},sap.basetable.crosstab.CrosstabRenderer.prototype.createColumnHeaderContainer=function(t,e,s,a,r,o){var i=this._crosstab.getCellHeight(),n=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell("columnHeader-Container");this._isAdditionalBorderVisible(s,e)?n.addClass("crosstab-ColumnHeaderContainer-blueBarsRemoved"):n.addClass("crosstab-ColumnHeaderContainer"),this._crosstabContainers.setColumnHeaderContainer(n);var l=t;e.length>0&&this._hasDataPoints(a)&&(l+=1);var c=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayout("columnHeaderCell-Content",l,this._crosstabContainers.getHeaderHeight());c.addClass("crosstab-Layout-Column");var d=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("columnDimensionHeaderRow",i,null,"crosstab-columnDimensionHeaderRow"),b=this.createColumnDimensionHeaderCell(t,s,e.length>0);d.append(b),c.append(d);var h=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("columnMemberHeaderRow",this._crosstabContainers.getHeaderHeight()-this._crosstab.getCellHeight()),p=this.createColumnMemberHeaderCell(t,this._crosstabContainers.getHeaderHeight()-i,s,r,o,e.length>0);return p.addClass("crosstab-columnMemberHeaderRow"),this._crosstabContainers.setColumnHeaderContent(p),h.append(p),c.append(h),n.append(c),n},sap.basetable.crosstab.CrosstabRenderer.prototype.createColumnDimensionHeaderCell=function(t,e,s){var a=this._crosstab.getCellHeight();t=s&&e.length>0?t+this._CELL_CORRECTION_PIXEL_OFFSET:t;var r=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell("rightAreaDimensionHeaderCell",t,a);r.addClass("crosstab-rightAreaDimensionHeader");var o=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayout("rightAreaDimensionHeaderCellLayout",t,a),i=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("rightAreaDimensionHeaderCellRow",a);return o.append(i),e.forEach(function(t,e){var a=0===e?this._FIRST_COLUMN_DIMENSION_CELL:"crosstab-ColumnDimensionCell",r=this.createDimensionHeaderCell(t.id,t.caption,a,s,!1,this._crosstab.getCellWidth());if("MeasureNamesDimension"===t.id){var o=$(document.createElement("div")).attr("id","Crosstab-MeasuresIconContainer").addClass("icon-Crosstab-Measures-Columns");r.children().prepend(o)}i.append(r)}.bind(this)),r.append(o),r},sap.basetable.crosstab.CrosstabRenderer.prototype.addColumnMemberHeader=function(t,e,s,a,r){for(var o=[],i=!1,n=0,l=this._crosstab.model().getResizedElements(0),c=!0,d=0;t.children.length>d;d++){var b=t.children[d],h=[],p=0,u=b.numOfLeafChildren?b.numOfLeafChildren:1;if(b.isTotal&&this._columnSubtotals.push(e),b.children.length>0){i=!1;var _=this.addColumnMemberHeader(b,e,s+1,a+"_"+d,r);e=_.index,h=_.nodes,p=_.width,n+=p}else{i=!0;var g=l[b.tuplePath];p=g?g:this._crosstab.getCellWidth(),n+=p,e++,c=!1}var C=!1;r&&0===d&&(-1===a.lastIndexOf("_")||this._isHeaderCellInFirstColumn(a))&&(C=!0);var f=this.createHeaderCell(a+"_"+d,b.member.caption,b.isTotal,1,u,h,"crosstab-ColumnHeaderCell",0===s,C,b.member.id,b.isMeasure,!1,p,c);i&&f.addClass(this._crosstab.getId()+"-ColumnHeader-LeafChild"+e),o.push(f)}var m=this._crosstab.model().getMeasuresPosition();if("column"===m.axis&&s===m.level)for(var v=0,x=0;t.children.length>x;x++){var S,y=t.children[x];if(y.numOfLeafChildren>0){S=0===v?e-t.numOfLeafChildren:v;for(var P=0;y.numOfLeafChildren>P;P++)this._measuresMap[S+P]=y.member.id,v=S+P+1}else S=e-t.numOfLeafChildren+x,this._measuresMap[S]=y.member.id}return{"index":e,"nodes":o,"width":n}},sap.basetable.crosstab.CrosstabRenderer.prototype._isHeaderCellInFirstColumn=function(t){return/ColumnMemberHeaderCell(_0)+$/i.test(t)},sap.basetable.crosstab.CrosstabRenderer.prototype.createColumnMemberHeaderCell=function(t,e,s,a,r,o){var i=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell("rightAreaMemberHeaderCell"),n=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayout("rightAreaMembersHeaderCellLayout",t,e),l=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("colDimRow",this._crosstab.getCellHeight());n.append(l);for(var c=this.addColumnMemberHeader(a,r,0,this._crosstab.getId()+"-ColumnMemberHeaderCell",o),d=0;c.nodes.length>d;d++)l.append(c.nodes[d]);return i.append(n),i},sap.basetable.crosstab.CrosstabRenderer.prototype.createTopSection=function(t,e,s,a,r,o,i){var n=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("topSection",this._crosstabContainers.getHeaderHeight(),null,"crosstab-TopSection"),l=this._crosstab.model().getStartColumnIndex();if(a.length>0){var c=this.createRowDimensionHeader(e,a,o,i);n.append(c)}if(r.length>0){for(var d=this.createColumnHeaderContainer(s,a,r,o,i,l),b=0;r.length-1>b;b++){var h=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell(this._crosstab.getId()+"-ColumnAxisFloatingHeader"+b);h.css({"height":this._crosstab.getCellHeight()+"px","line-height":this._crosstab.getCellHeight()-this._crosstab.getBorderWidth()+"px","width":this._crosstab.getCellWidth()+"px","left":"0px","top":(b+1)*this._crosstab.getCellHeight()+"px","z-index":"100"}),h.addClass("crosstab-FloatingCell crosstab-CellContent"),d.append(h)}n.append(d)}this._crosstabContainers.setTopSectionContainer(n),t.append(n)},sap.basetable.crosstab.CrosstabRenderer.prototype.addDataPointsCellsToRow=function(t,e,s,a,r){if(e.dataPoints&&e.dataPoints.length>0)e.dataPoints.forEach(function(a,o){var i,n,l,c=this._crosstab.model(),d=c.getMeasuresPosition();"column"===d.axis?l=o+c.getStartColumnIndex():"row"===d.axis&&(l=s),i=this.getMeasuresMap(l),n=c.getFormat(i);var b=a;a||0===a||(b=null);var h,p=e.isTotal?e.isTotal:$.inArray(o,this._columnSubtotals)>=0;p||null===this._crosstab.conditionalFormat()||void 0===this._crosstab.conditionalFormat()||(h=this.oConditionalCellFormatter.generateCellCallback(this._crosstab.conditionalFormat(),b,i)),n&&void 0!==n&&r&&(b=sap.basetable.crosstab.utils.FormatUtils.applyFormats(a,n));var u,_=this._crosstab.model().getResizedElements(0),g=this._crosstab.model().getDimensions(1).length;for(var C in _){var f=this._crosstab.model().getTupleIndex(1,C);if(f&&o===f[1]-1&&g===this._crosstab.model().getTupleDepth(C)||0===g&&C===this._crosstabElementResizedEventConstants.emptyColumnDimension){u=_[C];break}}var m;m=$.isEmptyObject(h)?this.createContentCell("dataCell_"+s+"_"+o,b,p,null,null,null,a,u):this.createContentCell("dataCell_"+s+"_"+o,b,p,null,null,h,a,u);var v=0===o?"crosstab-DataCell-first":"crosstab-DataCell";m.addClass(v),$.isEmptyObject(h)||"transparent"===h["background-color"]||m.css({"border-top-color":h["background-color"]}),t[s].append(m)}.bind(this));else for(var o=0;a>o;o++){var i=this.createContentCell("dataCell_"+s+"_"+o,"",e.isTotal,null,null,null,null,null);i.addClass("crosstab-DataCell"),t[s].append(i)}},sap.basetable.crosstab.CrosstabRenderer.prototype.addCellsToRow=function(t,e,s,a,r,o,i,n,l,c){var d,b=!0,h=[],p=this._crosstab.model().getMeasuresPosition();if(s.isTotal&&!c){var u=s.member.aggregationTarget;void 0!==u&&null!==u&&(c=u.id)}if("row"===p.axis&&o===p.level&&void 0!==p.level)for(var _=a,g=0;s.children.length>g;g++){var C=s.children[g];if(d=C.numOfLeafChildren?C.numOfLeafChildren:1,c&&s.isTotal||(c=C.member.id),d>1)for(var f=0;C.numOfLeafChildren>f;f++)this._measuresMap[_]=c,_++;else this._measuresMap[_]=c,_++}for(var m=function(t,e){return e!==P&&t.tuplePath.length>0&&I.tuplePath===t.tuplePath},v=this._crosstab.model().getDimensions(0),x=this._crosstab.model().getResizedElements(1),S=x[v[o].id],y=S?S:this._crosstab.getRowCellWidth(),P=0;s.children.length>P;P++){var T,A,I=s.children[P],R=[];if(d=I.numOfLeafChildren?I.numOfLeafChildren:1,I.children.length>0){T=!i||I.isTotal&&"count"===I.member.id?!1:!0;var w=this.addCellsToRow(t,e,I,a,r,o+1,T,n+"_"+P,0===a,c);a=w.iRowIndex,R=w.nodes,A=!1}else 0===I.children.length&&(T=!i||I.isTotal&&"count"===I.member.id?!1:!0,this.addDataPointsCellsToRow(e,I,a,r,T),A=!0),a++;var H,E=!1,M=null;if(I.isTotal===!0&&(H=jQuery.grep(s.children,m),H.length>0)){var D=I.member.caption+" ("+I.member.aggregationTarget.caption+")";M=this.createHeaderCell(n+"_"+P,D,I.isTotal,d,null,R,"crosstab-dimensionHeaderCell",null,null,I.member.id,I.isMeasure,b,y),A&&M.addClass(this._crosstab.getId()+"-RowAxisHeader-LeafChild"+a),E=!0}E===!1&&(M=this.createHeaderCell(n+"_"+P,I.member.caption,I.isTotal,d,null,R,"crosstab-dimensionHeaderCell",l,null,I.member.id,I.isMeasure,b,y),A&&M.addClass(this._crosstab.getId()+"-RowAxisHeader-LeafChild"+a)),M&&(h.push(M),l=!1)}return{"iRowIndex":a,"nodes":h}},sap.basetable.crosstab.CrosstabRenderer.prototype.createBottomSection=function(t,e,s,a,r){var o=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell("rowAxisContent-Container");o.addClass("crosstab-LeftDimensionHeaders"),this._crosstabContainers.setRowAxisContentContainer(o);var i=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayout("rowAxisContent-Content",s,this._crosstabContainers.getBodyHeight());i.addClass("crosstab-DataArea"),this._crosstabContainers.setRowAxisContentContent(i);var n=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("bottomRow",this._crosstabContainers.getBodyHeight());n.addClass("crosstab-BottomSection");var l,c=r.numOfLeafChildren?r.numOfLeafChildren:0,d=[],b=this._crosstab.model().getStartRowIndex(),h=this._crosstab.model().getNumberOfTuples(1);if(0===c&&r.dataPoints&&r.dataPoints.length>0)l=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("row0",this._crosstab.getCellHeight()),i.append(l),d[0]=l,this.addDataPointsCellsToRow(d,r,b,h,!0),o.append(i),n.append(o);else if(0!==c){c=b+c;for(var p=b;c>p;p++)l=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("row"+p,this.getUpdatedCellHeight(0===p)),i.append(l),d[p]=l;var u=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("row"+p,this._crosstab.getCellHeight()),_=this.addCellsToRow(u,d,r,b,h,0,!0,this._crosstab.getId()+"-RowAxisheaderCell",!0),g=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell("rowAxisHeader-Container");this._hasDataPoints(r)||0!==s?g.addClass("crosstab-RowAxisheaderContainer"):g.addClass("crosstab-RowAxisheaderContainer-noDataPoints"),(s>0&&e>0||this._hasDataPoints(r))&&g.addClass("crosstab-RowAxisheaderContainer-blueBars"),this._crosstabContainers.setRowAxisFloatingHeaderContainer(sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell("rowAxisHeader-FloatingHeadersContainer"));var C=this._crosstabContainers.getRowAxisFloatingHeaderContainer();C.addClass("crosstab-RowAxisFloatingHeadersContainer");for(var f=this._crosstab.model().getResizedElements(1),m=0,v=0;a.length-1>v;v++){var x=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell(this._crosstab.getId()+"-RowAxisFloatingHeader"+v),S=this._crosstab.getRowCellWidth(),y=f[a[v].id];S=y?y:S,x.css({"height":this._crosstab.getCellHeight()-this._crosstab.getBorderWidth()+"px","line-height":this._crosstab.getCellHeight()-this._crosstab.getBorderWidth()+"px","width":S+"px","top":"0px","left":m+"px"}),m+=S,x.addClass("crosstab-FloatingCell crosstab-CellContent"),C.append(x)}g.append(C),this._crosstabContainers.setRowAxisHeaderContainer(g);var P=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayout("rowAxisHeader-Content",e,this._crosstabContainers.getBodyHeight());P.addClass("crosstab-RowAxisHeaderContent"),this._crosstabContainers.setRowAxisHeaderContent(P);for(var T=0;_.nodes.length>T;T++)P.append(_.nodes[T]);g.append(P),n.append(g),this._hasDataPoints(r)&&(o.append(i),n.append(o))}t.append(n)},sap.basetable.crosstab.CrosstabRenderer.prototype._addBuffer=function(t){var e=t.topBuffer,s=t.leftBuffer;0===e?this._crosstabContainers.getLayout().css({"top":""}):this._crosstabContainers.getLayout().css({"top":e+"px"}),0===s?this._crosstabContainers.getLayout().css({"left":""}):this._crosstabContainers.getLayout().css({"left":s+"px"})},sap.basetable.crosstab.CrosstabRenderer.prototype._determineSectionsToHide=function(t){var e,s,a,r,o,i=this._crosstabContainers.getLeftAreaDimensionHeaderContainer(),n=this._crosstabContainers.getRowAxisHeaderContainer(),l=this._crosstabContainers.getTopSectionContainer(),c=this._crosstabContainers.getLayout();n&&(t.showRowAxisHeaders===!1&&n.is(":visible")?(s=parseInt(n.css("width")),a=parseInt(c.css("width"))-s,c.css({"width":a}),n.addClass(this._HIDE_SECTION),e=!1):t.showRowAxisHeaders!==!0||n.is(":visible")||(n.removeClass(this._HIDE_SECTION),s=parseInt(n.css("width")),a=parseInt(c.css("width"))+s,c.css({"width":a}),e=!0)),t.showColumnAxisHeaders===!1&&l.is(":visible")?(r=parseInt(l.css("height")),o=parseInt(c.css("height"))-r,c.css({"height":o}),l.addClass(this._HIDE_SECTION),e=!1):t.showColumnAxisHeaders!==!0||l.is(":visible")||(this._crosstabContainers.getTopSectionContainer().removeClass(this._HIDE_SECTION),r=parseInt(l.css("height")),o=parseInt(c.css("height"))+r,c.css({"height":o}),e=!0),i&&(e===!1&&i.is(":visible")?i.addClass(this._HIDE_SECTION):e!==!0||i.is(":visible")||i.removeClass(this._HIDE_SECTION))},sap.basetable.crosstab.CrosstabRenderer.prototype.drawSection=function(t){this._drawPostProcessing(t),this.redrawFromPageData(t),this._crosstab.isVerticallyScrollable()||this._crosstab.isHorizontallyScrollable()||this._crosstabContainers.getRowAxisContentContent().addClass("crosstab-DataArea-PositionAbsolute ")},sap.basetable.crosstab.CrosstabRenderer.prototype.redrawFromPageData=function(t){var e,s=0;t.redrawRowAxisContent&&(t.redrawColumnHeader&&(this.redrawColumnHeaderContent(),this._crosstab.isHorizontallyScrollable()||(s=this.calculateRightAreaWidth()+this._CELL_CORRECTION_PIXEL_OFFSET)),e=this.redrawRowAxisContentContent(),t.redrawRowAxisHeader&&this.redrawRowAxisHeaderContent(e)),s>0&&this.updateCrosstabLayoutWidth(s)},sap.basetable.crosstab.CrosstabRenderer.prototype.redrawRowAxisContentContent=function(){var t=this._crosstab.model().getTupleTree(0).rootnode,e=this.calculateRightAreaWidth();this._crosstabContainers.setBodyHeight(t.numOfLeafChildren?t.numOfLeafChildren*this._crosstab.getCellHeight():0);var s=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayout("rowAxisContent-Content",e,this._crosstabContainers.getBodyHeight());s.addClass("crosstab-DataArea");var a,r,o=t.numOfLeafChildren?t.numOfLeafChildren:0,i=[],n=this._crosstab.model().getNumberOfTuples(1),l=this._crosstab.model().getStartRowIndex();if(0===o&&t.dataPoints&&t.dataPoints.length>0)a=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("row0",this._crosstab.getCellHeight()),s.append(a),i[0]=a,this.addDataPointsCellsToRow(i,t,l,n,!0);else if(0!==o){o=l+o;for(var c=l;o>c;c++)a=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("row"+c,this.getUpdatedCellHeight(0===c)),s.append(a),i[c]=a;var d=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow("row"+c,this._crosstab.getCellHeight());r=this.addCellsToRow(d,i,t,l,n,0,!0,this._crosstab.getId()+"-RowAxisheaderCell",0===l)}var b=this._crosstabContainers.replaceContainer(s,this._crosstabContainers.getRowAxisContentContent());return this._crosstabContainers.setRowAxisContentContent(b),r},sap.basetable.crosstab.CrosstabRenderer.prototype.redrawRowAxisHeaderContent=function(t){var e=this.calculateLeftAreaWidth(),s=this._crosstab.model().getTupleTree(0).rootnode;this._crosstabContainers.setBodyHeight(s.numOfLeafChildren?s.numOfLeafChildren*this._crosstab.getCellHeight():0);var a=sap.basetable.crosstab.utils.RenderUtils.createMatrixLayout("rowAxisHeader-Content",e,this._crosstabContainers.getBodyHeight());a.addClass("crosstab-RowAxisHeaderContent");for(var r=0;t.nodes.length>r;r++)a.append(t.nodes[r]);var o=this._crosstabContainers.replaceContainer(a,this._crosstabContainers.getRowAxisHeaderContent());this._crosstabContainers.setRowAxisHeaderContent(o)},sap.basetable.crosstab.CrosstabRenderer.prototype.redrawColumnHeaderContent=function(){var t=this._crosstab.model().getDimensions(0),e=this._crosstab.model().getDimensions(1),s=this._crosstab.model().getTupleTree(1).rootnode,a=this._crosstab.getCellHeight()-1;this._crosstabContainers.setHeaderHeight((e.length+1)*this._crosstab.getCellHeight());var r=this._incrementWidthIfHorizontalScrollbarVisible(this.calculateRightAreaWidth()),o=this._crosstab.model().getStartColumnIndex(),i=this.createColumnMemberHeaderCell(r,this._crosstabContainers.getHeaderHeight()-a,e,s,o,t.length>0);i.addClass("crosstab-columnMemberHeaderRow");var n=this._crosstabContainers.replaceContainer(i,this._crosstabContainers.getColumnHeaderContent());this._crosstabContainers.setColumnHeaderContent(n)},sap.basetable.crosstab.CrosstabRenderer.prototype.calculateRightAreaWidth=function(t){var e=0,s=this._crosstab.model().getDimensions(1),a=this._crosstab.model().getTupleTree(1).rootnode,r=this._crosstab.model().getResizedElements(0);if(a.numOfLeafChildren){var o=0;for(var i in r)this._crosstab.model().getTupleIndex(1,i)&&this._crosstab.model().getTupleDepth(i)===s.length&&(e+=r[i],o++);var n;n=void 0!==typeof t&&t===!0?this._crosstab.model().getFullAxisLength(this._crosstab.COLUMN_AXIS):a.numOfLeafChildren,e+=(n-o)*this._crosstab.getCellWidth()}else{var l=this._crosstab.model().getTupleTree(0).rootnode;if(this._hasDataPoints(l)){var c=this._crosstabElementResizedEventConstants.emptyColumnDimension;e=r[c]?r[c]:this._crosstab.getCellWidth()}}return e},sap.basetable.crosstab.CrosstabRenderer.prototype.calculateLeftAreaWidth=function(){for(var t=this._crosstab.model().getDimensions(0),e=this._crosstab.model().getResizedElements(1),s=0,a=0,r=0;t.length>r;r++)t[r].id in e&&(a+=e[t[r].id],s++);return(t.length-s)*this._crosstab.getRowCellWidth()+a},sap.basetable.crosstab.CrosstabRenderer.prototype.updateContainerBordersEvent=function(t){var e=this._crosstabContainers.getLayout();t?$(e).hasClass("borderBottomWidth")?e.removeClass("borderBottomWidth"):e.addClass("borderBottomWidth"):$(e).hasClass("borderRightWidth")?e.removeClass("borderRightWidth"):e.addClass("borderRightWidth")},sap.basetable.crosstab.CrosstabRenderer.prototype.redrawFromConditionalFormatting=function(){this.redrawRowAxisContentContent()},sap.basetable.crosstab.CrosstabRenderer.prototype.showLoadingIndicator=function(){this._isLoading===!1&&(this._isLoading=!0,setTimeout(function(){this._isLoading===!0&&this._loadingIndicator.is(":hidden")&&(this._loadingIndicator.addClass("crosstab-loadingVisible"),this._loadingIndicator.removeClass("crosstab-loadingHidden"))}.bind(this),3e3))},sap.basetable.crosstab.CrosstabRenderer.prototype.hideLoadingIndicator=function(){this._isLoading=!1,this._loadingIndicator.is(":visible")&&(this._loadingIndicator.addClass("crosstab-loadingHidden"),this._loadingIndicator.removeClass("crosstab-loadingVisible"))},sap.basetable.crosstab.CrosstabRenderer.prototype.styleSelectedCells=function(t,e){var s=sap.basetable.crosstab.utils.RenderUtils.styleSelectedCells(t,e);return s},sap.basetable.crosstab.CrosstabRenderer.prototype.getPageCellIdMeasureMap=function(){return this._pageCellIdMeasureMap},sap.basetable.crosstab.CrosstabRenderer.prototype.getCellWidth=function(t){var e;return e=t?this._crosstab.getRowCellWidth():this._crosstab.getCellWidth()},sap.basetable.crosstab.CrosstabRenderer.prototype.getUpdatedCellHeight=function(t){var e=this._crosstab.getCellHeight();return t&&(e=this._crosstab.getCellHeight()-1),e},sap.basetable.crosstab.CrosstabRenderer.prototype.updateCrosstabLayoutWidth=function(t){var e=this._crosstab.container().closest(".sapUI5Crosstab"),s=0,a=this._crosstabContainers.getLeftAreaDimensionHeaderContainer();a&&!a.hasClass(this._HIDE_SECTION)&&(s=this.calculateLeftAreaWidth()+this._crosstabConstants._METADATA_BORDER_WIDTH);var r=s+t;e&&r>0&&(e.find("#crosstabLayout").width(r),e.find("#columnHeaderCell-Content").width(t),e.find("#rightAreaDimensionHeaderCellLayout").width(t))},jQuery.sap.declare("sap.basetable.crosstab.CrosstabScrollBar"),sap.basetable.crosstab.CrosstabScrollBar=function(t,e,s,a,r){this._scrollBarType=e,this._crosstabScrollBarEventMediator=s,this._scrollableCellAmount=a,this._crosstabScrollBarEventConstants=new sap.basetable.crosstab.CrosstabScrollBarEventConstants,this._crosstabConstants=new sap.basetable.crosstab.CrosstabConstants,this._crosstab=t,this._floatedHeaders=r,this._isHorizontalScrolling=this._scrollBarType===this._crosstabConstants.Horizontal,this._isVerticalScrolling=this._scrollBarType===this._crosstabConstants.Vertical,this._isPageable=this._scrollBarType!==this._crosstabConstants.RowAxisHeader,this._crosstabElementResizedEventConstants=new sap.basetable.crosstab.CrosstabElementResizedEventConstants,this._positionMap=[],this._bodyScrollableProps={"width":0}},sap.basetable.crosstab.CrosstabScrollBar.prototype={"_ScrollBarContainer":null,"_ScrollBarContainerSpan":null,"_ScrollBarTrack":null,"_ScrollBarTrackPiece":null,"_bodyContainer":null,"_bodyScrollable":null,"_headerContainer":null,"_headerScrollable":null,"_floatingHeadersScrollable":null,"_parentContainerSize":null,"_scrollableContentSize":null,"_scrollBarSize":null,"_pagingRequestLimit":null,"_nextPageEventFired":!1,"_axisIndex":0,"_scrollbarStepAmount":0,"_totalScrollBarSteps":null,"_scrollableContent":null,"_fullAxisLength":null,"_fullAxisLengthPixels":null,"_pageSize":null,"_pageSizeInPixels":null,"_startPageIndex":null,"_endPageIndex":null,"_previousPosition":null,"_currentStartIndex":null,"_atLastPage":!1,"_atFirstPage":!1,"_scrollBarMinSize":15,"_showEnd":!1,"_touchScrollData":{"startX":null,"startY":null,"endX":null,"endY":null},"_hideFloatingHeader":!1,"_isNewIdCellEntirelyVisible":!1,"_firstVisibleCell":null,"_floatedHeaderPositionChanged":!1,"_HIDE_HEADER":"crosstab-Cell-Under-Floating-Header","_MINIMUM_FLOATING_HEADER_WIDTH":16,"_MINUMUM_VISIBILITY":1.5},sap.basetable.crosstab.CrosstabScrollBar.prototype.initializeScrollBar=function(t,e,s,a,r,o){this._isPageable&&(this._setFullAxisLength(s),this._setFullAxisLengthPixels(),this._setPageSize(a),this._setPageSizeInPixels()),this._setBodyScrollable(t.bodyContent),this._setBodyScrollableProps(t.bodyContent),this._setBodyContainer(t.bodyContainer),this._setHeaderScrollable(t.headerContent),this._setHeaderContainer(t.headerContainer),t.floatingHeaders&&this.setScrollableFloatingHeaders(t.floatingHeaders),this._setScrollableContent(),this._setupScrollBar(e.Top,e.Left),this._setPositions(r),this._calculatePositionMap(),null!==o.eventData?(this._setShowEnd(o.eventData.showEnd),this.updateFromExternalEvent(o)):this._isPageable&&(this._setEndPageIndex(),this._setStartPageIndex(),this._setCurrentStartIndex()),this._setMouseWheelEvent($(t.bodyContainer).add(t.headerContainer).add(this._ScrollBarContainer)),this._setScrollBarTouchEvents(),this._updateFloatedHeaders(),this._registerCrosstabTouchEvent()
},sap.basetable.crosstab.CrosstabScrollBar.prototype._registerCrosstabTouchEvent=function(){var t;switch(this._scrollBarType){case this._crosstabConstants.Horizontal:t=this._crosstabScrollBarEventConstants.touchCrosstabHorizontalScrollBarEvent;break;case this._crosstabConstants.Vertical:t=this._crosstabScrollBarEventConstants.touchCrosstabVerticalScrollBarEvent;break;case this._crosstabConstants.RowAxisHeader:t=this._crosstabScrollBarEventConstants.touchCrosstabRowAxisScrollBarEvent;break;default:throw"Invalid Crosstab Touch Event Type"}this._crosstabScrollBarEventMediator.subscribe(t,this._doTouchScroll.bind(this))},sap.basetable.crosstab.CrosstabScrollBar.prototype._doTouchScroll=function(t){this._crosstab.getCrosstabElementResizeHandler().getResizedState()||(this._atLastPage=this._isLastPage(),this._atFirstPage=this._isFirstPage(),this._adjustIndexUpOrDown(t.scrollBarAction===this._crosstabConstants.DecreaseAxis),t.direction===this._crosstabConstants.Vertical?this._updateScrollPositionAndContent(this._crosstabConstants.PositionTop):this._updateScrollPositionAndContent(this._crosstabConstants.PositionLeft),this._isRowScrollScroll?this._doHorizontalPaging():this._isVerticalScrolling&&this._doVerticalPaging())},sap.basetable.crosstab.CrosstabScrollBar.prototype._setScrollBarTouchEvents=function(){window.TouchEvent&&$(this._ScrollBarTrackPiece).bind("touchstart touchmove touchend",function(t){this._handleScrollBarTouch(t)}.bind(this))},sap.basetable.crosstab.CrosstabScrollBar.prototype._handleScrollBarTouch=function(t){var e,s=t.changedTouches[0];switch(t.type){case"touchstart":e="mousedown";break;case"touchmove":e="mousemove";break;case"touchend":e="mouseup"}var a=document.createEvent("MouseEvent");a.initMouseEvent(e,!0,!0,window,1,s.screenX,s.screenY,s.clientX,s.clientY,!1,!1,!1,!1,0,null),s.target.dispatchEvent(a)},sap.basetable.crosstab.CrosstabScrollBar.prototype._setFullAxisLength=function(t){this._fullAxisLength=t},sap.basetable.crosstab.CrosstabScrollBar.prototype._setFullAxisLengthPixels=function(){if(this._isHorizontalScrolling){var t=this._crosstab.model().getResizedElements(0),e=this._crosstab.model().getDimensions(1),s=0,a=0,r=0;for(var o in t){var i=this._crosstab.model().getTupleIndex(1,o);(i&&e.length===this._crosstab.model().getTupleDepth(o)||0===e.length&&o===this._crosstabElementResizedEventConstants.emptyColumnDimension)&&(a=t[o],r+=a?a:0,s++)}this._fullAxisLengthPixels=(this._fullAxisLength-s)*this._scrollableCellAmount+r}else this._fullAxisLengthPixels=this._fullAxisLength*this._scrollableCellAmount},sap.basetable.crosstab.CrosstabScrollBar.prototype._setPageSize=function(t){this._pageSize=t},sap.basetable.crosstab.CrosstabScrollBar.prototype._setPageSizeInPixels=function(){this._pageSizeInPixels=this._pageSize*this._scrollableCellAmount},sap.basetable.crosstab.CrosstabScrollBar.prototype._setBodyScrollable=function(t){this._bodyScrollable=t,$(t).addClass("crosstab-scrollableContent")},sap.basetable.crosstab.CrosstabScrollBar.prototype._setBodyScrollableProps=function(t){this._bodyScrollableProps.width=parseInt(t[0].style.width,10)},sap.basetable.crosstab.CrosstabScrollBar.prototype._setBodyContainer=function(t){this._bodyContainer=t,$(t).addClass("crosstab-scrollableContainer")},sap.basetable.crosstab.CrosstabScrollBar.prototype._setHeaderScrollable=function(t){this._headerScrollable=t,$(t).addClass("crosstab-scrollableContent")},sap.basetable.crosstab.CrosstabScrollBar.prototype._setHeaderContainer=function(t){this._headerContainer=t,$(t).addClass("crosstab-scrollableContainer")},sap.basetable.crosstab.CrosstabScrollBar.prototype.setScrollableFloatingHeaders=function(t){this._floatingHeadersScrollable=t},sap.basetable.crosstab.CrosstabScrollBar.prototype._setScrollableContent=function(){this._scrollableContent=$(this._bodyScrollable).add(this._headerScrollable),this._floatingHeadersScrollable&&(this._scrollableContent=this._scrollableContent.add(this._floatingHeadersScrollable))},sap.basetable.crosstab.CrosstabScrollBar.prototype._setPositions=function(t){this._setCSSForScrollableContent(t),this.setCSSForTrackPiece(t),this.setCSSForFloatingHeaders(),this.setCSSForContainers()},sap.basetable.crosstab.CrosstabScrollBar.prototype._setCSSForScrollableContent=function(t){$(this._scrollableContent).css({"position":"absolute"});var e;t===!0?e=0:t===!1?(this._setShowEnd(!0),e=this._scrollableContentSize-this._parentContainerSize):e=this._getScrollableContentPosition(),this._isVerticalScrolling?$(this._scrollableContent).css({"top":-e}):$(this._scrollableContent).css({"left":-e})},sap.basetable.crosstab.CrosstabScrollBar.prototype._setShowEnd=function(t){this._showEnd!==t&&this._isPageable&&this._crosstabScrollBarEventMediator.publish(this._crosstabScrollBarEventConstants.borderEvent,this._isVerticalScrolling),this._showEnd=t},sap.basetable.crosstab.CrosstabScrollBar.prototype.getShowEnd=function(){return this._showEnd},sap.basetable.crosstab.CrosstabScrollBar.prototype.setCSSForFloatingHeaders=function(){this._floatingHeadersScrollable&&$(this._floatingHeadersScrollable).css({"top":0})},sap.basetable.crosstab.CrosstabScrollBar.prototype.setCSSForContainers=function(){$(this._headerContainer).css({"position":"relative","overflow":"hidden"}),$(this._bodyContainer).css({"position":"relative","overflow":"hidden"})},sap.basetable.crosstab.CrosstabScrollBar.prototype.setCSSForTrackPiece=function(t){var e=t?0:this._parentContainerSize-this._scrollBarSize;this._isVerticalScrolling?$(this._ScrollBarTrackPiece).css({"top":e}):$(this._ScrollBarTrackPiece).css({"left":e})},sap.basetable.crosstab.CrosstabScrollBar.prototype._setupScrollBar=function(t,e){this.setupContainer(),this.setScrollBarSizeRelativeToContent(),this.setupTrack(t,e),this.setupTrackPiece(),this._ScrollBarTrack.append(this._ScrollBarTrackPiece),this._ScrollBarContainerSpan.append(this._ScrollBarTrack)},sap.basetable.crosstab.CrosstabScrollBar.prototype.setupContainer=function(){this._ScrollBarContainer=$(document.createElement("div")),this._ScrollBarContainerSpan=$(document.createElement("span")),this._ScrollBarContainer.append(this._ScrollBarContainerSpan),this._ScrollBarContainer.addClass("crosstab-scroll")},sap.basetable.crosstab.CrosstabScrollBar.prototype.setupTrack=function(t,e){this._ScrollBarTrack=$(document.createElement("div"));var s="top: "+t+"px; left: "+e+"px;",a=this._parentContainerSize+"px";this._isVerticalScrolling?(s+="position: absolute; border-radius: 2.5px; width: 20px;height: "+a,$(this._ScrollBarTrack).addClass("vertical-Scroll-Bar-Track")):(s+="position: absolute; border-radius: 2.5px; height: 20px;width: "+a,$(this._ScrollBarTrack).addClass("horizontal-Scroll-Bar-Track")),this._ScrollBarTrack.attr("style",s),$(this._ScrollBarTrack).click(function(t){if(!$(this._bodyScrollable).is(":animated")&&!$(this._ScrollBarTrackPiece).is(":animated")&&!$(this._headerScrollable).is(":animated")){var e=this._ScrollBarTrack.context,s=this._ScrollBarTrackPiece.context,a=s.offsetTop,r=s.offsetLeft;t.target===e&&(this._isVerticalScrolling&&(a>t.offsetY||t.offsetY>s.offsetHeight+a)?this._doVerticalClickScroll(t,s.offsetTop,s.offsetHeight):!this._isVerticalScrolling&&(r>t.offsetX||t.offsetX>s.offsetWidth+r)&&this._doHorizontalClickScroll(t,s.offsetWidth,s.offsetLeft))}}.bind(this))},sap.basetable.crosstab.CrosstabScrollBar.prototype.enforceMinScrollbarHeight=function(){var t=0;return this._scrollBarSize<this._scrollBarMinSize&&(t=this._scrollBarMinSize-this._scrollBarSize,this._scrollBarSize=this._scrollBarMinSize),t},sap.basetable.crosstab.CrosstabScrollBar.prototype.setScrollBarSizeRelativeToContent=function(){var t=0;this._isVerticalScrolling?(this._scrollableContentSize=this._isPageable?this._fullAxisLengthPixels:$(this._bodyScrollable).outerHeight(!0),this._parentContainerSize=$(this._bodyContainer).innerHeight(),this._scrollBarSize=this._parentContainerSize/(this._scrollableContentSize/this._parentContainerSize),t=this.enforceMinScrollbarHeight()):(this._scrollableContentSize=this._isPageable?this._fullAxisLengthPixels:$(this._bodyScrollable).outerWidth(!0),this._parentContainerSize=$(this._bodyContainer).innerWidth(),this._scrollBarSize=this._parentContainerSize/(this._scrollableContentSize/this._parentContainerSize),t=this.enforceMinScrollbarHeight()),this._setScrollBarStepAmount(t),this._setScrollBarTotalSteps()},sap.basetable.crosstab.CrosstabScrollBar.prototype._setScrollBarStepAmount=function(t){this._scrollBarStepAmount=this._scrollableCellAmount/(this._scrollableContentSize/(this._parentContainerSize-t))},sap.basetable.crosstab.CrosstabScrollBar.prototype._setScrollBarTotalSteps=function(){var t=this._scrollableContentSize-this._parentContainerSize;this._totalScrollBarSteps=Math.floor(t/this._scrollableCellAmount)},sap.basetable.crosstab.CrosstabScrollBar.prototype._setEndPageIndex=function(t){var e=Math.floor(this._parentContainerSize/this._scrollableCellAmount);t?(this._endPageIndex=t-e,this._fullAxisLength<this._pageSize?this._endPageIndex=this._totalScrollBarSteps+1:this._endPageIndex>=this._totalScrollBarSteps&&!this._atLastPage?this._endPageIndex=this._totalScrollBarSteps:this._endPageIndex>=this._totalScrollBarSteps&&this._atLastPage&&(this._endPageIndex=this._totalScrollBarSteps+1)):this._fullAxisLength>this._pageSize?(t=this._pageSize-e,this._endPageIndex=Math.min(t,this._totalScrollBarSteps)):this._endPageIndex=this._totalScrollBarSteps+1},sap.basetable.crosstab.CrosstabScrollBar.prototype._setStartPageIndex=function(t){t?(this._startPageIndex=t,this._fullAxisLength<this._pageSize?this._startPageIndex=-1:0>=this._startPageIndex&&!this._atFirstPage?this._startPageIndex=0:0>=this._startPageIndex&&this._atFirstPage&&(this._startPageIndex=-1)):this._startPageIndex=-1},sap.basetable.crosstab.CrosstabScrollBar.prototype.getContainer=function(){return this._ScrollBarContainer},sap.basetable.crosstab.CrosstabScrollBar.prototype.setupTrackPiece=function(){this._ScrollBarTrackPiece=$(document.createElement("div"));var t="";this._isVerticalScrolling?(t+="background: #9d9c9c; position: absolute !important; border-radius: 2.5px; top: 0px; right: 5px; width: 7px;",t+="height: "+this._scrollBarSize+"px;",$(this._ScrollBarTrackPiece).addClass("vertical-Scroll-Bar-Track-Piece"),$(this._ScrollBarTrackPiece).draggable({"axis":"y","containment":"parent","drag":this._doVerticalStepScroll.bind(this),"stop":this._doVerticalStepScroll.bind(this)})):(t+="background: #9d9c9c; border-radius: 2.5px; position: absolute !important; left: 0px; bottom: 5px; height: 7px;",t+="width: "+this._scrollBarSize+"px;",$(this._ScrollBarTrackPiece).addClass("horizontal-Scroll-Bar-Track-Piece"),$(this._ScrollBarTrackPiece).draggable({"axis":"x","containment":"parent","drag":this._doHorizontalStepScroll.bind(this),"stop":this._doHorizontalStepScroll.bind(this)})),this._ScrollBarTrackPiece.attr("style",t)},sap.basetable.crosstab.CrosstabScrollBar.prototype._setMouseWheelEvent=function(t){$(t).bind("wheel",function(t){var e=this._isWheelScrollVertical(t);this._atLastPage=this._isLastPage(),this._atFirstPage=this._isFirstPage(),this._isVerticalScrolling&&e?(this._adjustIndexUpOrDown(0>t.originalEvent.deltaY),this._updateScrollPositionAndContent(this._crosstabConstants.PositionTop)):this._isVerticalScrolling||e||(this._adjustIndexUpOrDown(0>t.originalEvent.deltaX),this._updateScrollPositionAndContent(this._crosstabConstants.PositionLeft)),this._isPageable&&this._isVerticalScrolling&&e?this._doVerticalPaging():!this._isPageable||this._isVerticalScrolling||e||this._doHorizontalPaging()}.bind(this))},sap.basetable.crosstab.CrosstabScrollBar.prototype._isWheelScrollVertical=function(t){return Math.abs(t.originalEvent.deltaX)<Math.abs(t.originalEvent.deltaY)},sap.basetable.crosstab.CrosstabScrollBar.prototype._adjustIndexUpOrDown=function(t){t?(this._setAxisIndex(this._axisIndex-1),this._setShowEnd(!1)):(this._checkShowEnd(),this._setAxisIndex(this._axisIndex+1))},sap.basetable.crosstab.CrosstabScrollBar.prototype._updateScrollPositionAndContent=function(t){this._updateScrollBarTrackPiecePosition(t),this._updateScrollableContentPosition(t)},sap.basetable.crosstab.CrosstabScrollBar.prototype._doVerticalStepScroll=function(){var t=$(this._ScrollBarTrackPiece).position().top/this._crosstab.getScaleFactor(),e=Math.round(t+$(this._ScrollBarTrackPiece).outerHeight(!0));e===this._parentContainerSize?this._setShowEnd(!0):this._setShowEnd(!1);var s=Math.round(t/this._scrollBarStepAmount);this._setAxisIndex(s),this._atLastPage=this._isLastPage(),this._atFirstPage=this._isFirstPage(),this._updateScrollableContentPosition(this._crosstabConstants.PositionTop),this._doVerticalPaging()},sap.basetable.crosstab.CrosstabScrollBar.prototype._doHorizontalStepScroll=function(){var t=$(this._ScrollBarTrackPiece).position().left/this._crosstab.getScaleFactor(),e=Math.round(t+$(this._ScrollBarTrackPiece).outerWidth(!0));e===this._parentContainerSize?this._setShowEnd(!0):this._setShowEnd(!1);var s=Math.round(t/this._scrollBarStepAmount);this._setAxisIndex(s),this._atLastPage=this._isLastPage(),this._atFirstPage=this._isFirstPage(),this._updateScrollableContentPosition(this._crosstabConstants.PositionLeft),this._doHorizontalPaging()},sap.basetable.crosstab.CrosstabScrollBar.prototype._doVerticalClickScroll=function(t,e,s){e>t.offsetY?(this._setAxisIndex(this._axisIndex-1),this._setShowEnd(!1)):t.offsetY>e+s&&(this._checkShowEnd(),this._setAxisIndex(this._axisIndex+1)),this._atLastPage=this._isLastPage(),this._atFirstPage=this._isFirstPage(),this._doScrollAnimation(this._crosstabConstants.PositionTop),this._doVerticalPaging()},sap.basetable.crosstab.CrosstabScrollBar.prototype._doHorizontalClickScroll=function(t,e,s){s>t.offsetX?(this._setAxisIndex(this._axisIndex-1),this._setShowEnd(!1)):t.offsetX>e+s&&(this._checkShowEnd(),this._setAxisIndex(this._axisIndex+1)),this._atLastPage=this._isLastPage(),this._atFirstPage=this._isFirstPage(),this._doScrollAnimation(this._crosstabConstants.PositionLeft),this._doHorizontalPaging()},sap.basetable.crosstab.CrosstabScrollBar.prototype._checkShowEnd=function(){this._axisIndex===this._totalScrollBarSteps&&this._setShowEnd(!0)},sap.basetable.crosstab.CrosstabScrollBar.prototype._doScrollAnimation=function(t){var e={},s={},a=this._getScrollBarPosition(),r=this._getScrollableContentPosition();e[t]=-r,s[t]=a,$(this._scrollableContent).animate(e,"fast"),$(this._ScrollBarTrackPiece).animate(s,"fast"),this._floatedHeaders.length>0&&this._updateFloatedHeaders()},sap.basetable.crosstab.CrosstabScrollBar.prototype._updateScrollableContentPosition=function(t){var e=this._getScrollableContentPosition(),s={};s[t]=-e,$(this._scrollableContent).css(s),this._floatedHeaders.length>0&&this._updateFloatedHeaders()},sap.basetable.crosstab.CrosstabScrollBar.prototype._updateScrollBarTrackPiecePosition=function(t){var e,s={};e=this._getScrollBarPosition(),s[t]=e,$(this._ScrollBarTrackPiece).css(s)},sap.basetable.crosstab.CrosstabScrollBar.prototype._getScrollableContentPosition=function(){return this._showEnd?this._isVerticalScrolling?parseInt(this._bodyScrollable[0].style.height,10)-this._parentContainerSize:parseInt(this._bodyScrollable[0].style.width,10)-this._parentContainerSize:this._isPageable?this._isHorizontalScrolling?this._getScrollableContentPositionFromAxisIndex():(this._axisIndex-this._currentStartIndex)*this._scrollableCellAmount:this._getScrollableContentPositionFromAxisIndex()},sap.basetable.crosstab.CrosstabScrollBar.prototype._getScrollableContentPositionFromAxisIndex=function(){var t=this._positionMap[this._axisIndex];return Math.min(t,this._bodyScrollableProps.width-this._parentContainerSize-1)},sap.basetable.crosstab.CrosstabScrollBar.prototype._getScrollBarPosition=function(){return this._showEnd?this._parentContainerSize-this._scrollBarSize:this._axisIndex*this._scrollBarStepAmount},sap.basetable.crosstab.CrosstabScrollBar.prototype._doVerticalPaging=function(){this._isPageable&&(this._crosstab.model().setVerticalScrollPosition(this._axisIndex),(this._axisIndex>=this._endPageIndex||this._axisIndex<=this._startPageIndex)&&this._crosstabScrollBarEventMediator.publish(this._crosstabScrollBarEventConstants.nextPageEvent,this._getPageData()))},sap.basetable.crosstab.CrosstabScrollBar.prototype._doHorizontalPaging=function(){this._isPageable&&(this._crosstab.model().setHorizontalScrollPosition(this._axisIndex),(this._axisIndex>=this._endPageIndex||this._axisIndex<=this._startPageIndex)&&this._crosstabScrollBarEventMediator.publish(this._crosstabScrollBarEventConstants.nextPageEvent,this._getPageData()))},sap.basetable.crosstab.CrosstabScrollBar.prototype._isLastPage=function(){return this._axisIndex>=this._totalScrollBarSteps?!0:!1},sap.basetable.crosstab.CrosstabScrollBar.prototype._isFirstPage=function(){return 0===this._axisIndex?!0:!1},sap.basetable.crosstab.CrosstabScrollBar.prototype._clearFloatedHeader=function(t){this._floatedHeaders[t].$headerDom.text(""),this._floatedHeaders[t].$headerDom.attr("title",""),this._floatedHeaders[t].referenceId=null,this._floatedHeaders[t].lastCellParsed&&$(this._floatedHeaders[t].lastCellParsed[0].childNodes[0]).css({"opacity":"1"}),this._floatedHeaders[t].lastCellParsed=null},sap.basetable.crosstab.CrosstabScrollBar.prototype._updateFloatedHeaders=function(){var t,e,s,a;if(this._floatedHeaders.length>0){var r=this._getHeaderTupleIds();if(void 0!==r.tupleIndex){this._showEnd&&(t=this._crosstab.container().closest(".sapUI5Crosstab"),this._isHorizontalScrolling?(e="columnHeaderCell-Content",s=t.find("div#"+e).offset().left):(e="rowAxisHeader-Content",s=t.find("#bottomRow").offset().top));for(var o=r.tupleIndex.length-1;o>=0;o--){for(var i=r.prefix,n=0;o>=n;n++)i=i+"_"+r.tupleIndex[n];if(this._showEnd){a=t.find("#"+i);var l=this._crosstab.getScaleFactor();this._setFloatingHeaderPosition(a,o,s,l),this._hideFloatingHeader=this._isHorizontalScrolling&&a.cellSize*a.visibility<=this._MINIMUM_FLOATING_HEADER_WIDTH}var c=!0;if(this._floatedHeaders[o].lastCellParsed&&(c=this._floatedHeaders[o].lastCellParsed.is(":visible")),this._floatedHeaders[o].referenceId===i&&c&&(!this._showEnd||this._isNewIdCellEntirelyVisible))break;this._resetFloatingHeader(o,i)}if(!this._showEnd&&this._floatedHeaderPositionChanged){for(o=r.tupleIndex.length-1;o>=0;o--)this._resetFloatingHeaderPosition(o);this._floatedHeaderPositionChanged=!1}}}this._showEnd||this._updateFloatedHeadersSize()},sap.basetable.crosstab.CrosstabScrollBar.prototype._setCellProperties=function(t,e,s){this._isHorizontalScrolling?(t.position=t.offset().left,t.cellSize=t.width()*s):(t.position=t.offset().top,t.cellSize=t.height()*s),t.visibility=1-(e-t.position)/t.cellSize},sap.basetable.crosstab.CrosstabScrollBar.prototype._setFloatingHeaderPosition=function(t,e,s,a){if(this._isHorizontalScrolling)this._setCellProperties(t,s,a),this._floatedHeaders[e].$headerDom.css({"width":t.cellSize*t.visibility});else if(t.height()*a-(s-t.offset().top)<this._crosstab.getRowCellHeight()*a){this._setCellProperties(this._firstVisibleCell,s,a);var r=this._firstVisibleCell.cellSize-this._firstVisibleCell.cellSize*this._firstVisibleCell.visibility;this._floatedHeaders[e].$headerDom.css({"top":-r+"px"}),this._floatedHeaderPositionChanged=!0}else this._floatedHeaders[e].$headerDom.css({"top":"0px"})},sap.basetable.crosstab.CrosstabScrollBar.prototype._resetFloatingHeaderPosition=function(t){this._isHorizontalScrolling?this._floatedHeaders[t].$headerDom.css({"left":"0px"}):this._floatedHeaders[t].$headerDom.css({"top":"0px"})},sap.basetable.crosstab.CrosstabScrollBar.prototype._updateFloatedHeadersSize=function(){if(this._isHorizontalScrolling&&this._floatedHeaders.length>0){var t=this._getHeaderTupleIds();if(void 0!==t.tupleIndex)for(var e=t.prefix,s=t.prefix.split("-")[0]+"-ColumnHeader-LeafChild",a=t.tupleIndex.length-1,r=0;a>=r;r++){e=e+"_"+t.tupleIndex[r];for(var o=e,i=0;a-r>=i;i++)o+="_0";for(var n=$("#"+o+"-div")[0],l=0,c=0;n.classList.length-1>=c;c++)if(n.classList[c].indexOf(s)>=0){l=n.classList[c].split(s)[1]-1;break}var d=this._positionMap[this.getAxisIndex()],b=d-this._positionMap[l],h=parseInt($("#"+e)[0].style.width)-b;this._floatedHeaders[r].$headerDom.css({"width":h})}}},sap.basetable.crosstab.CrosstabScrollBar.prototype.getFloatedHeaders=function(){return this._floatedHeaders},sap.basetable.crosstab.CrosstabScrollBar.prototype._getHeaderTupleIds=function(){var t,e,s,a;return t=this._isVerticalScrolling?"."+this._crosstab.getId()+"-RowAxisHeader-LeafChild":"."+this._crosstab.getId()+"-ColumnHeader-LeafChild",a=this._showEnd?this._findCurrentLeaf(t):$(t+(this._axisIndex+1)),a.length>0&&(s=a[0].id.split("_"),e=s[0],s.splice(0,1),s.splice(-1,1)),{"prefix":e,"tupleIndex":s}},sap.basetable.crosstab.CrosstabScrollBar.prototype._findCurrentLeaf=function(t){var e,s,a,r=this._crosstab.container().closest(".sapUI5Crosstab");this._isVerticalScrolling?(e=r.find(".crosstab-dimensionHeaderCell").last(),s=r.find("#bottomRow").offset().top):(e=r.find(".crosstab-ColumnHeaderCell").last(),s=r.find("#columnHeaderCell-Content").offset().left,0===s&&(s=r.find("#rowAxisContent-Container").offset().left));for(var o,i=0;e[0].classList.length>i;i++)if(e[0].classList[i].indexOf("LeafChild")>-1){o=parseInt(e[0].classList[i].split("LeafChild")[1]);break}for(i=o;i>=0&&(a=$(t+i),!(this._isVerticalScrolling&&s>a.offset().top||this._isHorizontalScrolling&&s>a.offset().left));i--);this._firstVisibleCell=a;var n;return n=this._isVerticalScrolling?a.offset().top:a.offset().left,this._isNewIdCellEntirelyVisible=this._MINUMUM_VISIBILITY>s-n,a},sap.basetable.crosstab.CrosstabScrollBar.prototype._resetFloatingHeader=function(t,e){this._floatedHeaders[t].referenceId=e;var s=$("#"+e),a=$(s[0].childNodes[0]);a.removeClass(this._HIDE_HEADER);var r=a.attr("class");a.addClass(this._HIDE_HEADER);var o=s.text();if(this._floatedHeaders[t].$headerDom.text(o),this._floatedHeaders[t].$headerDom.attr("class","crosstab-FloatingCell "+r),this._floatedHeaders[t].$headerDom.attr("title",o),this._floatedHeaders[t].lastCellParsed&&!this._showEnd){var i=this._floatedHeaders[t].lastCellParsed.attr("id"),n=$("#"+i);n.length>0&&$(n[0].childNodes[0]).removeClass(this._HIDE_HEADER)}this._hideFloatingHeader&&this._floatedHeaders[t].$headerDom.addClass(this._HIDE_HEADER),this._floatedHeaders[t].lastCellParsed=s},sap.basetable.crosstab.CrosstabScrollBar.prototype.resetCellOpacityUnderFloatingHeader=function(){for(var t=0;this._floatedHeaders.length>=t;t++){var e=this._floatedHeaders[t];if(void 0!==e&&void 0!==e.referenceId){var s=$("#"+e.referenceId);if(void 0!==s[0]&&!this._showEnd){$(s[0].childNodes[0]).addClass("crosstab-Cell-Under-Floating-Header");var a=s.text();e.$headerDom.text(a),e.$headerDom.attr("title",a)}}}},sap.basetable.crosstab.CrosstabScrollBar.prototype._calculatePositionMap=function(){if(this._positionMap=[],this._cumulativePosition=0,this._isPageable){var t=this._crosstab.model().getTupleTree(1).rootnode,e=this._crosstab.model().getStartColumnIndex();this._calculatePositionMapFromTuple(t,e)}else this._calculatePositionMapFromDimensions()},sap.basetable.crosstab.CrosstabScrollBar.prototype._calculatePositionMapFromTuple=function(t,e){for(var s=this._crosstab.model().getResizedElements(0),a=0;t.children.length>a;a++){var r=t.children[a];r.children.length>0?e=this._calculatePositionMapFromTuple(r,e):(e++,this._positionMap[e-1]=this._cumulativePosition,this._cumulativePosition+=s[r.tuplePath]?s[r.tuplePath]:this._crosstab.getCellWidth())}return e},sap.basetable.crosstab.CrosstabScrollBar.prototype._calculatePositionMapFromDimensions=function(){for(var t=this._crosstab.model().getDimensions(0),e=this._crosstab.model().getResizedElements(1),s=0;t.length>s;s++){this._positionMap[s]=this._cumulativePosition;var a=t[s].id;this._cumulativePosition+=e[a]?e[a]:this._crosstab.getRowCellWidth()}},sap.basetable.crosstab.CrosstabScrollBar.prototype.updateFromExternalEvent=function(t){var e=this._getUpdateHandler(t.type);e.apply(this,[t])},sap.basetable.crosstab.CrosstabScrollBar.prototype._getUpdateHandler=function(t){var e;return t===this._crosstabScrollBarEventConstants.updateAxisLength?e=this._updateAxisLengthEvent:t===this._crosstabScrollBarEventConstants.conditionalFormatEvent?e=this._conditionalFormatEvent:t===this._crosstabScrollBarEventConstants.newPageEvent?e=this._newPageEvent:t===this._crosstabScrollBarEventConstants.windowResize?e=this._windowResizeEvent:t===this._crosstabScrollBarEventConstants.newSectionEvent&&(e=this._newSectionEvent),e},sap.basetable.crosstab.CrosstabScrollBar.prototype._newPageEvent=function(t){if(this._updateScrollableAreas(t),this._isPageable){var e,s,a;this._isVerticalScrolling?(a=t.eventData.coordinates.startRowIndex,e=t.eventData.coordinates.endRowIndex,s=t.eventData.coordinates.startRowIndex):(a=t.eventData.coordinates.startColumnIndex,e=t.eventData.coordinates.endColumnIndex,s=t.eventData.coordinates.startColumnIndex),this._setEndPageIndex(e),this._setStartPageIndex(s),this._setCurrentStartIndex(a)}this._calculatePositionMap(),this._setScrollableContent(),this._setCSSForScrollableContent(),this._floatedHeaders.length>0&&this._updateFloatedHeaders()},sap.basetable.crosstab.CrosstabScrollBar.prototype._conditionalFormatEvent=function(t){this._setBodyScrollable(t.containers.rowAxisContentContent),this._setScrollableContent(),this._setCSSForScrollableContent(),this._floatedHeaders.length>0&&this._updateFloatedHeaders()},sap.basetable.crosstab.CrosstabScrollBar.prototype._newSectionEvent=function(t){this._updateScrollableAreas(t),this._isPageable&&this._isHorizontalScrolling&&this._crosstab.isHorizontallyScrollable()&&(this._setEndPageIndex(t.eventData.coordinates.endColumnIndex),this._setStartPageIndex(t.eventData.coordinates.startColumnIndex),this._setCurrentStartIndex(t.eventData.coordinates.startColumnIndex)),this._calculatePositionMap(),this._setScrollableContent(),this._setCSSForScrollableContent(),this._floatedHeaders.length>0&&this._updateFloatedHeaders()},sap.basetable.crosstab.CrosstabScrollBar.prototype._windowResizeEvent=function(t){this._setAxisIndex(t.eventData.currentPosition),this._isPageable&&(this._setCurrentStartIndex(t.eventData.currentStartIndex),this._setEndPageIndex(t.eventData.endPageIndex),this._setStartPageIndex(t.eventData.startPageIndex));var e;e=this._isVerticalScrolling?this._crosstabConstants.PositionTop:this._crosstabConstants.PositionLeft,this._updateScrollPositionAndContent(e)},sap.basetable.crosstab.CrosstabScrollBar.prototype._updateAxisLengthEvent=function(t){var e;this._setFullAxisLength(t.eventData.length),this._setFullAxisLengthPixels(),this.setScrollBarSizeRelativeToContent(),this._updateScrollBarSize(),e=this._isVerticalScrolling?this._crosstabConstants.PositionTop:this._crosstabConstants.PositionLeft,this._updateScrollPositionAndContent(e),this._floatedHeaders.length>0&&this._updateFloatedHeaders()},sap.basetable.crosstab.CrosstabScrollBar.prototype._updateScrollableAreas=function(t){this._isVerticalScrolling?(this._setHeaderScrollable(t.containers.rowAxisHeaderContent),this._setBodyScrollable(t.containers.rowAxisContentContent)):!this._isVerticalScrolling&&this._isPageable?(this._setHeaderScrollable(t.containers.columnHeaderContent),this._setBodyScrollable(t.containers.rowAxisContentContent)):this._isVerticalScrolling||this._isPageable||this._setBodyScrollable(t.containers.rowAxisHeaderContent)},sap.basetable.crosstab.CrosstabScrollBar.prototype._updateScrollBarSize=function(){this._isVerticalScrolling?$(this._ScrollBarTrackPiece).height(this._scrollBarSize):$(this._ScrollBarTrackPiece).width(this._scrollBarSize)},sap.basetable.crosstab.CrosstabScrollBar.prototype._setCurrentStartIndex=function(t){this._currentStartIndex=t?t:0},sap.basetable.crosstab.CrosstabScrollBar.prototype._getPageData=function(){var t={"redrawRowAxisHeader":null,"redrawRowAxisContent":null,"redrawColumnHeader":null,"coordinates":{"startRowIndex":null,"startColumnIndex":null,"endRowIndex":null,"endColumnIndex":null}};return this._isVerticalScrolling?(t.redrawRowAxisHeader=!0,t.redrawRowAxisContent=!0,t.redrawColumnHeader=!1):(t.redrawRowAxisHeader=!1,t.redrawRowAxisContent=!0,t.redrawColumnHeader=!0),t},sap.basetable.crosstab.CrosstabScrollBar.prototype.getAxisIndex=function(){return this._axisIndex},sap.basetable.crosstab.CrosstabScrollBar.prototype._setAxisIndex=function(t){t>this._totalScrollBarSteps?this._axisIndex=this._totalScrollBarSteps:t>=0&&(this._axisIndex=t)},sap.basetable.crosstab.CrosstabScrollBar.prototype.getCurrentStartIndex=function(){return this._currentStartIndex},sap.basetable.crosstab.CrosstabScrollBar.prototype.getEndPageIndex=function(){return this._endPageIndex},sap.basetable.crosstab.CrosstabScrollBar.prototype.getStartPageIndex=function(){return this._startPageIndex},sap.basetable.crosstab.CrosstabScrollBar.prototype.getIsPageable=function(){return this._isPageable},jQuery.sap.declare("sap.basetable.crosstab.CrosstabScrollBarController"),sap.basetable.crosstab.CrosstabScrollBarController=function(t,e,s){this._crosstab=t,this._crosstabContainers=this._crosstab.crosstabContainers(),this._crosstabScrollBarEventMediator=e,this._crosstabScrollBarEventConstants=s,this._crosstabConstants=new sap.basetable.crosstab.CrosstabConstants},sap.basetable.crosstab.CrosstabScrollBarController.prototype={"_horizontalScrollBar":null,"_verticalScrollBar":null,"_rowAxisHeaderScrollBar":null,"_touchScrollData":{"startX":null,"startY":null,"endX":null,"endY":null}},sap.basetable.crosstab.CrosstabScrollBarController.prototype.draw=function(t,e){var s;if(e.horizontalScrollBar){var a=this._getScrollData(t,this._horizontalScrollBar);s=this.getScrollBarUpdateData(this._crosstabScrollBarEventConstants.windowResize,a),this.addHorizontalScrollBar(e.isVerticallyScrollable,s)}else this._horizontalScrollBar=null;if(e.verticalScrollBar){var r=this._getScrollData(t,this._verticalScrollBar);s=this.getScrollBarUpdateData(this._crosstabScrollBarEventConstants.windowResize,r),this.addVerticalScrollBar(e.horizontalScrollBar,s)}else this._verticalScrollBar=null;if(e.rowAxisHeaderScrollBar){var o=this._getScrollData(t,this._rowAxisHeaderScrollBar);s=this.getScrollBarUpdateData(this._crosstabScrollBarEventConstants.windowResize,o),this.addRowAxisHeaderScrollBar(e.isVerticallyScrollable,s)}else this._rowAxisHeaderScrollBar=null},sap.basetable.crosstab.CrosstabScrollBarController.prototype.attachCrosstabTouchEvents=function(t){t.horizontalScrollBar&&this._setCrosstabTouchEvents($(this._crosstabContainers.getRowAxisContentContainer(),this._crosstabContainers.getColumnHeaderContainer())),t.verticalScrollBar&&this._setCrosstabTouchEvents($(this._crosstabContainers.getRowAxisContentContainer(),this._crosstabContainers.getRowAxisHeaderContainer())),t.rowAxisHeaderScrollBar&&this._setCrosstabTouchEvents($(this._crosstabContainers.getRowAxisHeaderContainer(),this._crosstabContainers.getLeftAreaDimensionHeaderContainer()))},sap.basetable.crosstab.CrosstabScrollBarController.prototype._setCrosstabTouchEvents=function(t){window.PointerEvent?$(t).bind("pointerdown pointermove pointerup",function(t){"touch"===t.originalEvent.pointerType&&this._handleTouch(t)}.bind(this)):window.TouchEvent&&$(t).bind("touchstart touchmove touchend",function(t){this._handleTouch(t)}.bind(this))},sap.basetable.crosstab.CrosstabScrollBarController.prototype._handleTouch=function(t){var e;e=window.PointerEvent?t.originalEvent:t.changedTouches[0];var s;switch(t.type){case"pointerdown":case"touchstart":this._touchScrollData.startX=e.pageX,this._touchScrollData.startY=e.pageY;break;case"pointermove":case"touchmove":s="mousemove",this._touchScrollData.endX=this._touchScrollData.startX-e.pageX,this._touchScrollData.endY=this._touchScrollData.startY-e.pageY;var a,r=Math.abs(this._touchScrollData.endY),o=Math.abs(this._touchScrollData.endX);(r>this._crosstabConstants.touchThreshold||o>this._crosstabConstants.touchThreshold)&&(r>o?a=this._crosstabConstants.Vertical:o>r&&(a=this._crosstabConstants.Horizontal))}if("mousemove"===s&&a){var i,n;
n=a===this._crosstabConstants.Vertical?0>this._touchScrollData.endY?this._crosstabConstants.DecreaseAxis:this._crosstabConstants.IncreaseAxis:0>this._touchScrollData.endX?this._crosstabConstants.DecreaseAxis:this._crosstabConstants.IncreaseAxis,i={"isTouch":!0,"direction":a,"scrollBarAction":n},this._touchScrollData.startX=e.pageX,this._touchScrollData.startY=e.pageY;var l=null,c=t.currentTarget;$(c).is($(this._crosstabContainers.getRowAxisContentContainer()))?l=a===this._crosstabConstants.Vertical?this._crosstabScrollBarEventConstants.touchCrosstabVerticalScrollBarEvent:this._crosstabScrollBarEventConstants.touchCrosstabHorizontalScrollBarEvent:$(c).is($(this._crosstabContainers.getRowAxisHeaderContainer()))?l=a===this._crosstabConstants.Vertical?this._crosstabScrollBarEventConstants.touchCrosstabVerticalScrollBarEvent:this._crosstabScrollBarEventConstants.touchCrosstabRowAxisScrollBarEvent:$(c).is($(this._crosstabContainers.getColumnHeaderContainer()))?a===this._crosstabConstants.Horizontal&&(l=this._crosstabScrollBarEventConstants.touchCrosstabHorizontalScrollBarEvent):$(c).is($(this._crosstabContainers.getLeftAreaDimensionHeaderContainer()))&&a===this._crosstabConstants.Horizontal&&(l=this._crosstabScrollBarEventConstants.touchCrosstabRowAxisScrollBarEvent),null!==l&&this._crosstabScrollBarEventMediator.publish(l,i)}t.preventDefault()},sap.basetable.crosstab.CrosstabScrollBarController.prototype.addHorizontalScrollBar=function(t,e){var s=!1,a=this._floatedHeadersforScrollBar(s,this._crosstab.model().getDimensions(1).length);this._horizontalScrollBar=new sap.basetable.crosstab.CrosstabScrollBar(this._crosstab,this._crosstabConstants.Horizontal,this._crosstabScrollBarEventMediator,this._crosstab.getCellWidth(),a);var r=this._getOffsetProperties(this._crosstabConstants.Horizontal,!0,t);this._horizontalScrollBar.initializeScrollBar(this._crosstabContainers.getHorizontalScrollAreas(),r,this._crosstab.model().getFullAxisLength(this._crosstabConstants.COLUMN_AXIS_INDEX),this._crosstabConstants.HORIZONTAL_SCROLL_WINDOW,!0,e),this._crosstabContainers.getScrollContainer().append(this._horizontalScrollBar.getContainer())},sap.basetable.crosstab.CrosstabScrollBarController.prototype.addVerticalScrollBar=function(t,e){var s=!0,a=this._floatedHeadersforScrollBar(s,this._crosstab.model().getDimensions(0).length);this._verticalScrollBar=new sap.basetable.crosstab.CrosstabScrollBar(this._crosstab,this._crosstabConstants.Vertical,this._crosstabScrollBarEventMediator,this._crosstab.getCellHeight(),a);var r=this._getOffsetProperties(this._crosstabConstants.Vertical,t);this._verticalScrollBar.initializeScrollBar(this._crosstabContainers.getVerticalScrollAreas(),r,this._crosstab.model().getFullAxisLength(this._crosstabConstants.ROW_AXIS_INDEX),this._crosstabConstants.VERTICAL_SCROLL_WINDOW,!0,e),this._crosstabContainers.getScrollContainer().append(this._verticalScrollBar.getContainer())},sap.basetable.crosstab.CrosstabScrollBarController.prototype.addRowAxisHeaderScrollBar=function(t,e){var s=[];this._rowAxisHeaderScrollBar=new sap.basetable.crosstab.CrosstabScrollBar(this._crosstab,this._crosstabConstants.RowAxisHeader,this._crosstabScrollBarEventMediator,this._crosstab.getCellWidth(),s);var a=this._getOffsetProperties(this._crosstabConstants.RowAxisHeader,!0,t);this._rowAxisHeaderScrollBar.initializeScrollBar(this._crosstabContainers.getRowAxisHeaderScrollAreas(),a,null,null,!1,e),this._crosstabContainers.getScrollContainer().append(this._rowAxisHeaderScrollBar.getContainer())},sap.basetable.crosstab.CrosstabScrollBarController.prototype.updateScrollBars=function(t,e,s){var a=this.getScrollBarUpdateData(t,e),r=this._getUpdateHandler(t);r.apply(this,[s,a])},sap.basetable.crosstab.CrosstabScrollBarController.prototype._getUpdateHandler=function(t){var e;return t===this._crosstabScrollBarEventConstants.updateAxisLength?e=this._updateAxisLengthEvent:t===this._crosstabScrollBarEventConstants.conditionalFormatEvent?e=this._conditionalFormatEvent:t===this._crosstabScrollBarEventConstants.newPageEvent?e=this._newPageEvent:t===this._crosstabScrollBarEventConstants.newSectionEvent&&(e=this._newSectionEvent),e},sap.basetable.crosstab.CrosstabScrollBarController.prototype._newPageEvent=function(t,e){t.horizontalScrollBar&&(this._horizontalScrollBar.updateFromExternalEvent(e),this._horizontalScrollBar.resetCellOpacityUnderFloatingHeader()),t.verticalScrollBar&&(this._verticalScrollBar.updateFromExternalEvent(e),this._verticalScrollBar.resetCellOpacityUnderFloatingHeader()),t.rowAxisHeaderScrollBar&&this._rowAxisHeaderScrollBar.updateFromExternalEvent(e)},sap.basetable.crosstab.CrosstabScrollBarController.prototype._newSectionEvent=function(t,e){t.horizontalScrollBar&&this._horizontalScrollBar.updateFromExternalEvent(e),t.verticalScrollBar&&this._verticalScrollBar.updateFromExternalEvent(e),t.rowAxisHeaderScrollBar&&this._rowAxisHeaderScrollBar.updateFromExternalEvent(e)},sap.basetable.crosstab.CrosstabScrollBarController.prototype._conditionalFormatEvent=function(t,e){t.horizontalScrollBar&&(this._horizontalScrollBar.updateFromExternalEvent(e),this._horizontalScrollBar.resetCellOpacityUnderFloatingHeader()),t.verticalScrollBar&&(this._verticalScrollBar.updateFromExternalEvent(e),this._verticalScrollBar.resetCellOpacityUnderFloatingHeader())},sap.basetable.crosstab.CrosstabScrollBarController.prototype._updateAxisLengthEvent=function(t,e){0===e.eventData.axisIndex?t.verticalScrollBar&&this._verticalScrollBar.updateFromExternalEvent(e):t.horizontalScrollBar&&this._horizontalScrollBar.updateFromExternalEvent(e)},sap.basetable.crosstab.CrosstabScrollBarController.prototype.getScrollBarUpdateData=function(t,e){var s={"type":t,"eventData":e,"containers":{"rowAxisContentContent":this._crosstabContainers.getRowAxisContentContent(),"columnHeaderContent":this._crosstabContainers.getColumnHeaderContent(),"rowAxisHeaderContent":this._crosstabContainers.getRowAxisHeaderContent()}};return s},sap.basetable.crosstab.CrosstabScrollBarController.prototype._getScrollData=function(t,e){if(t&&e){var s={"currentPosition":null,"currentStartIndex":null,"endPageIndex":null,"startPageIndex":null,"showEnd":!1};return s.currentPosition=e.getAxisIndex(),s.showEnd=e.getShowEnd(),e.getIsPageable()&&(s.currentStartIndex=e.getCurrentStartIndex(),s.endPageIndex=e.getEndPageIndex(),s.startPageIndex=e.getStartPageIndex()),s}return null},sap.basetable.crosstab.CrosstabScrollBarController.prototype._floatedHeadersforScrollBar=function(t,e){var s,a=[];s=t?"#"+this._crosstab.getId()+"-RowAxisFloatingHeader":"#"+this._crosstab.getId()+"-ColumnAxisFloatingHeader";for(var r=0;e>r;r++)a.push({"referenceId":void 0,"$headerDom":$(s+r),"lastCellParsed":void 0});return a},sap.basetable.crosstab.CrosstabScrollBarController.prototype.getFloatedHeadersforScrollBar=function(t){var e;return t?this._verticalScrollBar&&(e=this._verticalScrollBar.getFloatedHeaders()):this._horizontalScrollBar&&(e=this._horizontalScrollBar.getFloatedHeaders()),e},sap.basetable.crosstab.CrosstabScrollBarController.prototype.getAllFloatedHeaders=function(){var t=this.getFloatedHeadersforScrollBar(!1),e=this.getFloatedHeadersforScrollBar(!0),s=[];return t&&(s=s.concat(t)),e&&(s=s.concat(e)),s},sap.basetable.crosstab.CrosstabScrollBarController.prototype._getOffsetProperties=function(t,e,s){var a={"Top":null,"Left":null},r=0,o=0;return t===this._crosstabConstants.Vertical?(o+=this._crosstabConstants.LeftDimensionHeadersBorderWidth.bottom,o+=this._crosstabConstants.LayoutBorderWidth.top,a.Top=this._crosstabContainers.getHeaderHeight()+o,a.Left=this._crosstabContainers.getLeftAreaContainerWidth()+this._crosstabContainers.getRightAreaContainerWidth(),0===this._crosstabContainers.getLeftAreaContainerWidth()||e||(a.Left+=this._crosstabConstants._METADATA_BORDER_WIDTH+this._crosstabConstants._CROSSTAB_LAYOUT_BORDER_WIDTH)):(t===this._crosstabConstants.Horizontal||t===this._crosstabConstants.RowAxisHeader)&&(r+=this._crosstabConstants.LayoutBorderWidth.left,t===this._crosstabConstants.Horizontal&&0!==this._crosstabContainers.getLeftAreaContainerWidth()?(r+=this._crosstabConstants.RowAxisHeaderContainerBorderWidth.right,a.Left=this._crosstabContainers.getLeftAreaContainerWidth()+r):a.Left=r,a.Top=s?this._crosstabContainers.getBodyHeight()+this._crosstabContainers.getHeaderHeight():this._crosstab.getTotalHeight(),a.Top>this._crosstabContainers.getOverallContainerHeight()&&(a.Top=this._crosstabContainers.getOverallContainerHeight()),a.Top+=this._getAdditionalBorderHeight()),a},sap.basetable.crosstab.CrosstabScrollBarController.prototype._getAdditionalBorderHeight=function(){var t=0;if(this._crosstab.isVerticallyScrollable())t+=this._crosstabConstants._CROSSTAB_LAYOUT_BORDER_HEIGHT,this._crosstab.isMetaDataBorderPresent(this._crosstabConstants.Horizontal)&&(t+=this._crosstabConstants._METADATA_BORDER_HEIGHT);else{var e=this._crosstab.model().getFullAxisLength(this._crosstabConstants.ROW_AXIS_INDEX);t+=this._crosstabConstants._CROSSTAB_LAYOUT_BORDER_HEIGHT,this._crosstabConstants.VERTICAL_SCROLL_WINDOW>e&&this._crosstab.isMetaDataBorderPresent(this._crosstabConstants.Horizontal)&&(t+=this._crosstabConstants._METADATA_BORDER_HEIGHT)}return t},jQuery.sap.declare("sap.basetable.crosstab.CrosstabScrollBarEventConstants"),sap.basetable.crosstab.CrosstabScrollBarEventConstants=function(){var t={};return t.nextPageEvent="nextPageEvent",t.borderEvent="borderEvent",t.updateAxisLength="updateAxisLength",t.conditionalFormatEvent="conditionalFormatEvent",t.newPageEvent="newPageEvent",t.newSectionEvent="newSectionEvent",t.windowResize="windowResize",t.touchCrosstabRowAxisScrollBarEvent="touchCrosstabRowAxisScrollBarEvent",t.touchCrosstabVerticalScrollBarEvent="touchCrosstabVerticalScrollBarEvent",t.touchCrosstabHorizontalScrollBarEvent="touchCrosstabHorizontalScrollBarEvent",Object.freeze(t)},jQuery.sap.declare("sap.basetable.crosstab.CrosstabScrollBarEventMediator"),sap.basetable.crosstab.CrosstabScrollBarEventMediator=function(){this._participants={}},sap.basetable.crosstab.CrosstabScrollBarEventMediator.prototype.subscribe=function(t,e){return this._participants.hasOwnProperty(t)||(this._participants[t]=[]),this._participants[t].push(e),!0},sap.basetable.crosstab.CrosstabScrollBarEventMediator.prototype.publish=function(t,e){if(!this._participants.hasOwnProperty(t))return!1;for(var s=0,a=this._participants[t].length;a>s;s++)this._participants[t][s].call(void 0,e);return!0},jQuery.sap.declare("sap.basetable.crosstab.ExternalScrollHandler"),sap.basetable.crosstab.ExternalScrollHandler=function(t){this._UI5Crostab=t,this._crosstab=this._UI5Crostab.getCrosstab(),this._pageSize=this._crosstab.model().getPageSize()},sap.basetable.crosstab.ExternalScrollHandler.prototype={"_data":null,"_currentRow":0,"_currentCol":0,"_direction":Object.freeze({"horizontal":"horizontal","vertical":"vertical","undetermined":"undetermined"})},sap.basetable.crosstab.ExternalScrollHandler.prototype.getUI5Crosstab=function(){return this._UI5Crostab},sap.basetable.crosstab.ExternalScrollHandler.prototype.doScroll=function(t){var e=this._determineDirection(t);this._data=t,e===this._direction.vertical?this._handleVerticalScroll():e===this._direction.horizontal&&this._handleHorizontalScroll()},sap.basetable.crosstab.ExternalScrollHandler.prototype._handleVerticalScroll=function(){var t=this._getMultiplePagesExist(this._direction.vertical);if(t){var e=this._data.containerScrollTop,s=this._data.containerOffsetTop,a=this._data.containerHeight,r=e+a,o=$("#"+this._UI5Crostab.sId);if(this._getUI5CrosstabValid(o)){var i=o.offset().top/this.getUI5Crosstab().getScaleFactor()-s,n=o.height()*this.getUI5Crosstab().getScaleFactor(),l=this._getAtBeginning(i,r),c=-1;if(l?c=0:(i=Math.abs(i),n>i&&(c=i)),c>=0){var d=this._crosstab.getCellHeight(),b=this._getDimensionCount(this._crosstab.COLUMN_AXIS)*d,h=(c-b)/d;h=Math.ceil(h),0>h&&(h=0),this._crosstab.model().setVerticalScrollPosition(h);var p=this._crosstab.model().getRecentPageData(),u=Math.ceil(a/d),_=p.coordinates.startRowIndex>h,g=h+u>=p.coordinates.endRowIndex;if(_||g)return this._crosstab.publishNextPageEvent(this._getEmptyPageData()),void 0}}}},sap.basetable.crosstab.ExternalScrollHandler.prototype._getEmptyPageData=function(){var t={"redrawRowAxisHeader":null,"redrawRowAxisContent":null,"redrawColumnHeader":null,"coordinates":{"startRowIndex":null,"startColumnIndex":null,"endRowIndex":null,"endColumnIndex":null}};return t},sap.basetable.crosstab.ExternalScrollHandler.prototype._handleHorizontalScroll=function(){var t=this._getMultiplePagesExist(this._direction.horizontal);if(t){var e=this._data.containerScrollLeft,s=this._data.containerOffsetLeft,a=this._data.containerWidth,r=e+a,o=$("#"+this._UI5Crostab.sId);if(this._getUI5CrosstabValid(o)){var i=o.offset().left/this.getUI5Crosstab().getScaleFactor()-s,n=o.width()*this.getUI5Crosstab().getScaleFactor(),l=this._getAtBeginning(i,r),c=-1;if(l?c=0:(i=Math.abs(i),n>i&&(c=i)),c>=0){var d=this._crosstab.getCellWidth(),b=this._getDimensionCount(this._crosstab.ROW_AXIS)*d,h=(c-b)/d;h=Math.ceil(h),0>h&&(h=0),this._crosstab.model().setHorizontalScrollPosition(h);var p=this._crosstab.model().getRecentPageData(),u=Math.ceil(a/d),_=p.coordinates.startColumnIndex>h,g=h+u>=p.coordinates.endColumnIndex;(_||g)&&this._crosstab.publishNextPageEvent(this._getEmptyPageData())}}}},sap.basetable.crosstab.ExternalScrollHandler.prototype._getUI5CrosstabValid=function(t){return t?"function"!=typeof t.offset||null===t.offset()?!1:"function"!=typeof t.height||"function"!=typeof t.width?!1:!0:!1},sap.basetable.crosstab.ExternalScrollHandler.prototype._getAtBeginning=function(t,e){return t>=0&&e>=t},sap.basetable.crosstab.ExternalScrollHandler.prototype._getMultiplePagesExist=function(t){var e;return e=t===this._direction.vertical?this._crosstab.ROW_AXIS:this._crosstab.COLUMN_AXIS,this._crosstab.model().getFullAxisLength(e)>this._pageSize-1},sap.basetable.crosstab.ExternalScrollHandler.prototype._determineDirection=function(t){var e=t.containerScrollTop,s=t.containerScrollLeft;return this._data&&(e-=this._data.containerScrollTop,s-=this._data.containerScrollLeft),this._getDirection(e,s)},sap.basetable.crosstab.ExternalScrollHandler.prototype._getDirection=function(t,e){var s=this._direction.undetermined;return 0!==t&&0===e?s=this._direction.vertical:0!==e&&0===t&&(s=this._direction.horizontal),s},sap.basetable.crosstab.ExternalScrollHandler.prototype._getDimensionCount=function(t){var e=this._crosstab.model().getDimensions(t).length;return t===this._crosstab.COLUMN_AXIS&&(e+=1),e},jQuery.sap.declare("sap.basetable.crosstab.Format"),sap.basetable.crosstab.Format=function(){this._type,this.body},sap.basetable.crosstab.Format.TYPE_STYLE="style",sap.basetable.crosstab.Format.TYPE_SIMPLE="simple",sap.basetable.crosstab.Format.TYPE_CONDITIONS="conditions",sap.basetable.crosstab.Format.prototype.type=function(){},sap.basetable.crosstab.Format.prototype.body=function(){},jQuery.sap.declare("sap.basetable.crosstab.library"),jQuery.sap.require("sap.ui.core.Core"),jQuery.sap.require("sap.ui.core.library"),sap.ui.getCore().initLibrary({"name":"sap.basetable.crosstab","dependencies":["sap.ui.core"],"types":[],"interfaces":[],"controls":["sap.basetable.crosstab.UI5Crosstab"],"elements":[],"version":"0.0"}),jQuery.sap.declare("sap.basetable.crosstab.MockBIQueryModelRequestHandler"),sap.basetable.crosstab.MockBIQueryModelRequestHandler=function(t,e){this._jsonData=t,this._crosstabDataProvider=e},sap.basetable.crosstab.MockBIQueryModelRequestHandler.prototype._truncateInitialData=function(t,e){var s,a={"dimAxes":{}};for(s in t.queryResponse[0].dimAxes)a.dimAxes[s]={},a.dimAxes[s].values=t.queryResponse[0].dimAxes[s].values.slice(0,e),a.dimAxes[s].count=t.queryResponse[0].dimAxes[s].count;a.ranges=t.queryResponse[0].ranges,a.valueAxes=[];for(var r=0;t.queryResponse[0].valueAxes.length>r;++r){var o=t.queryResponse[0].valueAxes[r],i=!0;for(s in t.queryResponse[0].dimAxes)if(o[s]>=e){i=!1;break}i&&a.valueAxes.push(o)}a.calculations=t.queryResponse[0].calculations,a.metadata=t.queryResponse[0].metadata,a.executionStatus=t.queryResponse[0].executionStatus;var n={"queryRequest":t.queryRequest,"queryResponse":[a],"consumptionModel":t.consumptionModel,"feeding":t.feeding};return n},sap.basetable.crosstab.MockBIQueryModelRequestHandler.prototype._fetchInitialWindow=function(t){var e=this._truncateInitialData(this._jsonData,t);this._crosstabDataProvider._initialize(e)},sap.basetable.crosstab.MockBIQueryModelRequestHandler.prototype._fetchAxesMetadata=function(t,e,s){for(var a={"dimAxes":{}},r=0;t.length>r;++r){var o="rows"===t[r]?e:s;a.dimAxes[o]={"values":this._jsonData.queryResponse[0].dimAxes[o].values,"count":this._jsonData.queryResponse[0].dimAxes[o].count}}a.ranges=this._jsonData.queryResponse[0].ranges,a.valueAxes=[],a.calculations=this._jsonData.queryResponse[0].calculations,a.metadata=this._jsonData.queryResponse[0].metadata,a.executionStatus=this._jsonData.queryResponse[0].executionStatus;var i={"queryRequest":this._jsonData.queryRequest,"queryResponse":[a],"consumptionModel":this._jsonData.consumptionModel,"feeding":this._jsonData.feeding};this._crosstabDataProvider.initializeAxesMetadata(i)},sap.basetable.crosstab.MockBIQueryModelRequestHandler.prototype._fetchWindow=function(t,e,s,a){for(var r=0;t.queryWindowSpecifications.length>r;++r){var o,i,n,l={"version":"2.0","queries":[]},c=[],d=t.queryWindowSpecifications[r],b={},h={"dimAxes":{}};for(var p in d)o="rows"===p?s:a,b[o]={"page":d[p].page,"pageSize":d[p].pageSize,"axisType":this._jsonData.queryRequest.queries[0][o].axisType,"components":this._jsonData.queryRequest.queries[0][o].components,"calculations":this._jsonData.queryRequest.queries[0][o].calculations},i=d[p].page*d[p].pageSize,n=i+d[p].pageSize-1,h.dimAxes[o]={"values":this._jsonData.queryResponse[0].dimAxes[o].values.slice(i,n+1),"count":this._jsonData.queryResponse[0].dimAxes[o].count};l.queries.push(b),h.ranges=this._jsonData.queryResponse[0].ranges,h.valueAxes=[];for(var u=0;this._jsonData.queryResponse[0].valueAxes.length>u;++u){var _=this._jsonData.queryResponse[0].valueAxes[u],g=!0,C={};for(p in d){if(i=d[p].page*d[p].pageSize,n=i+d[p].pageSize-1,i>_[o]||_[o]>n){g=!1;break}C[o]=_[o]-i}g&&(C[e]=_[e],h.valueAxes.push(C))}h.calculations=this._jsonData.queryResponse[0].calculations,h.metadata=this._jsonData.queryResponse[0].metadata,h.executionStatus=this._jsonData.queryResponse[0].executionStatus,c.push(h);var f={"queryRequest":l,"queryResponse":c,"consumptionModel":this._jsonData.consumptionModel,"feeding":this._jsonData.feeding};this._crosstabDataProvider._addPage(t.coordinates,r,f)}},jQuery.sap.declare("sap.basetable.crosstab.PageManager"),sap.basetable.crosstab.PageManager=function(t,e,s,a,r){this._crosstabDataProvider=r,this._axisTupleArray={},this._axisSubtotalLevelNumAggregationsMap={},this._axisTupleMaps={},this._pendingPageRequests=[],this._inProcessPageRequest=void 0,this._pageSize=e,this._pageCache=[],this._pageResults=[],this._eDispatch=s,this._metadataFeedIds=[],this._pendingMetadataRequests=[],this._initializingAxesMetadata=!1,this._crosstabConstants=new sap.basetable.crosstab.CrosstabConstants},sap.basetable.crosstab.PageManager.prototype.getPageSize=function(){return this._pageSize},sap.basetable.crosstab.PageManager.prototype._initialize=function(t){var e;t.windowing?(this._queryRequestHandler=new sap.basetable.crosstab.MockBIQueryModelRequestHandler(t,this._crosstabDataProvider),this._eDispatch=d3.dispatch("mock_axesMetadataRequest","mock_pageRequest"),this._eDispatch.on("mock_axesMetadataRequest",this._queryRequestHandler._fetchAxesMetadata),this._eDispatch.on("mock_pageRequest",this._queryRequestHandler._fetchWindow),e=this._queryRequestHandler._truncateInitialData(t,this._pageSize)):e=t,this._measureAxisType=null;var s=this._crosstabDataProvider._processAxisFeeding(e.feeding.cols);this._columnDimensionIdArray=s.dimensionIdArray,null!==s.measureAxisPosition&&(this._measureAxisType="column",this._measureAxisPosition=s.measureAxisPosition,this._numMeasures=s.numMeasures),s=this._crosstabDataProvider._processAxisFeeding(e.feeding.rows),this._rowDimensionIdArray=s.dimensionIdArray,null===this._measureAxisType&&null!==s.measureAxisPosition&&(this._measureAxisType="row",this._measureAxisPosition=s.measureAxisPosition,this._numMeasures=s.numMeasures),this._entityIdCaptionMap=this._crosstabDataProvider._buildEntityIdCaptionMap(e.feeding),this._measureIdCaptionMap=this._crosstabDataProvider.buildMeasureIdCaptionMap(e.measureMetadata);var a=e.queryRequest?e.queryRequest.queries[0]:null,r=e.queryResponse[0];this._columnAxisName=this._crosstabDataProvider._findAxisName(r,this._columnDimensionIdArray),this._rowAxisName=this._crosstabDataProvider._findAxisName(r,this._rowDimensionIdArray),this._measureAxisName=null,"row"===this._measureAxisType?this._measureAxisName=this._rowAxisName:"column"===this._measureAxisType&&(this._measureAxisName=this._columnAxisName),this._measureGroupName=this._crosstabDataProvider._findMeasureGroupName(a),this._rowAxisName&&(this._axisSubtotalLevelNumAggregationsMap[this._rowAxisName]=this._buildSubtotalLevelNumAggregationsMap(this._rowAxisName,r)),this._columnAxisName&&(this._axisSubtotalLevelNumAggregationsMap[this._columnAxisName]=this._buildSubtotalLevelNumAggregationsMap(this._columnAxisName,r)),this._axisTupleLengths={};var o=r.dimAxes;if(o[this._columnAxisName]&&(this._axisTupleLengths[this._columnAxisName]=o[this._columnAxisName].count),o[this._rowAxisName]&&(this._axisTupleLengths[this._rowAxisName]=o[this._rowAxisName].count),a){var i=a.layout?a.layout:a;this._columnAxisName&&(i[this._columnAxisName]&&this._axisTupleLengths[this._columnAxisName]<i[this._columnAxisName].pageSize?this._initializeAxisMetadata(this._columnAxisName,a,r):this._metadataFeedIds.push("cols")),this._rowAxisName&&(i[this._rowAxisName]&&this._axisTupleLengths[this._rowAxisName]<i[this._rowAxisName].pageSize?this._initializeAxisMetadata(this._rowAxisName,a,r):this._metadataFeedIds.push("rows")),this._initializedWithFullQuery=0===this._metadataFeedIds.length}var n=this._rowAxisName?Math.max(this._pageSize,r.dimAxes[this._rowAxisName].values.length):void 0,l=this._columnAxisName?Math.max(this._pageSize,r.dimAxes[this._columnAxisName].values.length):void 0,c=this._createInitialWindowPageSpecification(n,l),d=this._createInitialWindowMeasuresSpecification(r),b=n?n>=this._axisTupleLengths[this._rowAxisName]:!0,h=l?l>=this._axisTupleLengths[this._columnAxisName]:!0,p=this._crosstabDataProvider._buildTupleTrees(a,r,this._entityIdCaptionMap,this._measureIdCaptionMap,this._rowAxisName,this._columnAxisName,this._measureAxisType,this._measureGroupName,this._measureAxisPosition,c,d,this._axisTupleLengths,b,h);this._storeInCache(p,{"rowPageIndex":0,"columnPageIndex":0},this._pageSize)},sap.basetable.crosstab.PageManager.prototype._initializeAxisMetadata=function(t,e,s){var a;void 0!==this._measureAxisPosition&&(a=this._crosstabDataProvider._buildMeasuresInfo(e,this._measureGroupName,this._measureAxisPosition)),this._axisTupleMaps[t]=this._buildAxisTupleMap(t,s,this._measureAxisName,a,this._axisSubtotalLevelNumAggregationsMap[t])},sap.basetable.crosstab.PageManager.prototype.initializeAxesMetadata=function(){if(!this._initializingAxesMetadata&&this._metadataFeedIds.length>0){for(var t=this._metadataFeedIds.length-1;t>=0;--t){var e={},s=this._metadataFeedIds[t];e[s]={"page":0,"pageSize":100*this._pageSize-1},this._metadataFeedIds.splice(t,1),this._pendingMetadataRequests.push(e)}this._eDispatch.crosstableMembersRequest(this._pendingMetadataRequests[0]),this._pendingMetadataRequests.shift(),this._initializingAxesMetadata=!0}},sap.basetable.crosstab.PageManager.prototype.updateAxesMetadata=function(t,e){var s,a=t.queryRequest.queries[0],r=t.queryResponse[0];for(var o in r.dimAxes)if(r.dimAxes.hasOwnProperty(o)){this._updateAxisTupleArray(o,r);var i=t.queryRequest.queries[0][o].page,n=t.queryRequest.queries[0][o].pageSize,l=o===this._rowAxisName?0:1,c=r.dimAxes[o];if(c.values.length===n){var d=(i+1)*n;d>this._axisTupleLengths[o]&&(this._axisTupleLengths[o]=d,e.setFullAxisLength(l,this._axisTupleLengths[o]));var b=o===this._rowAxisName?"rows":"cols";s||(s={}),s[b]={"page":i+1,"pageSize":n},this._pendingMetadataRequests.push(s)}else{var h;void 0!==this._measureAxisPosition&&(h=this._crosstabDataProvider._buildMeasuresInfo(a,this._measureGroupName,this._measureAxisPosition)),this._axisTupleMaps[o]=this._buildAxisTupleMap(o,r,this._measureAxisName,h,this._axisSubtotalLevelNumAggregationsMap[o],this._axisTupleArray[o]),delete this._axisTupleArray[o],e.setFullAxisLength(l,this.getFullAxisLengthByIndex(l))}}this._pendingMetadataRequests.length>0?(this._eDispatch.crosstableMembersRequest(this._pendingMetadataRequests[0]),this._pendingMetadataRequests.shift()):(this._initializingAxesMetadata=!1,this._processNextPendingPageRequest())},sap.basetable.crosstab.PageManager.prototype._buildSubtotalLevelNumAggregationsMap=function(t,e){var s=[];if(e.calculations){var a=e.calculations[t];if(a)for(var r=0;a.length>r;++r){var o=a[r].values;if(o.length>0){var i=o[0],n=i.window[t],l=void 0===n?0:n.length,c=i.values.length,d=void 0===s[l]?0:s[l];s[l]=d+c}}}return s},sap.basetable.crosstab.PageManager.prototype._buildAxisTupleMap=function(t,e,s,a,r,o){for(var i=[],n=0,l=s===t?0:void 0,c=n,d=o?o:e.dimAxes[t].values;d.length>c;){i.push({"axisTupleIndex":c,"measureIndex":l});var b=d[c],h=d[c+1],p=0,u=b.length,_=!1;if(void 0!==h){_=!0;for(var g=0;h.length>g;++g)if(b[g]!==h[g]){_=!1,p=g+1,u=h.length;break}}if(!_)for(var C=u;C>=p;--C){var f=r[C];if(f)if(void 0!==l){if(a.axisPosition>C){if(l===a.members.length-1)for(var m=0;f>m;++m)for(var v=0;a.members.length>v;++v){var x=a.members[v].indexForSubTotal;x>=0&&i.push({"axisTupleIndex":c,"subTotal":{"level":C,"aggregationIndex":m},"measureIndex":x})}}else if(a.members[l].indexForSubTotal>=0)for(var S=0;f>S;++S)i.push({"axisTupleIndex":c,"subTotal":{"level":C,"aggregationIndex":S},"measureIndex":a.members[l].indexForSubTotal})}else for(var y=0;f>y;++y)i.push({"axisTupleIndex":c,"subTotal":{"level":C,"aggregationIndex":y},"measureIndex":l})}if(void 0!==l){var P=a.members.length;if(void 0===h){if(P-1>l){l++,c=n;continue}}else{var T=a.axisPosition-1,A=h[T];if(void 0!==A&&A!==b[T]){if(l!==P-1){l++,c=n;continue}l=0,n=c+1}}}c++}return i},sap.basetable.crosstab.PageManager.prototype._lookUpMemberKey=function(t,e,s,a){var r,o=t[e];if(o){var i=o[s];if(i){var n=i.value[a];if(n){var l=n.attributes.key;if(l)for(var c=0;l.length>c;++c)r+=l[c];else r=n.key}}}return r},sap.basetable.crosstab.PageManager.prototype._updateAxisTupleArray=function(t,e){for(var s=e.dimAxes[t].values,a=e.metadata.dictionary,r=0;s.length>r;++r){for(var o=s[r],i=[],n=0;o.length>n;++n){var l=o[n],c=this._lookUpMemberKey(a,t,n,l);i.push(c)}this._axisTupleArray[t]||(this._axisTupleArray[t]=[]),this._axisTupleArray[t].push(i)}},sap.basetable.crosstab.PageManager.prototype._findDimensionMemberMeasureIndex=function(t,e){for(var s=e,a=t[s];void 0!==a.subTotal;)s--,a=t[s];return a.measureIndex},sap.basetable.crosstab.PageManager.prototype._calculateSubtotalOffset=function(t,e){var s,a=t[e];if(a.subTotal){for(var r=t[e].axisTupleIndex,o=e;(t[o].axisTupleIndex!==r||void 0!==t[o].subTotal)&&o>=0;)o--;s=e-o}return s},sap.basetable.crosstab.PageManager.prototype._getAxisRange=function(t,e){var s,a,r,o,i=t*this._pageSize,n=i+this._pageSize-1,l=this._axisTupleMaps[e];return void 0===l?(s=i,a=Math.min(n,this._axisTupleLengths[e]-1)):(s=l[i].axisTupleIndex,a=l.length>n?l[n].axisTupleIndex:l[l.length-1].axisTupleIndex,o=this._calculateSubtotalOffset(l,i)),r=0,this._axisTupleLengths[e]-1>a&&(a+=1,r=1),{"startIndex":s,"endIndex":a,"endIndexOffset":r,"subtotalOffset":o}},sap.basetable.crosstab.PageManager.prototype._getNumDimensions=function(t){var e=null;return t===this._columnAxisName&&(e=this._columnDimensionIdArray.length),t===this._rowAxisName&&(e=this._rowDimensionIdArray.length),e},sap.basetable.crosstab.PageManager.prototype._buildMeasureAxisRangesFromAxisTupleMap=function(t,e,s){var a,r,o,i,n,l,c=[],d=t*this._pageSize,b=s.length,h=Math.min(d+this._pageSize-1,b-1),p=s[d];a=p.axisTupleIndex,r=p.axisTupleIndex;for(var u,_=d+1;h>=_&&(u=s[_].axisTupleIndex,!(a>u));++_)r=Math.max(r,u);if(h>=_){for(i=this._findDimensionMemberMeasureIndex(s,d),l=this._calculateSubtotalOffset(s,d),c.push({"startIndex":a,"endIndex":r,"endIndexOffset":0,"measureStartIndex":i,"measureEndIndex":i,"subtotalOffset":l}),d=_,p=s[d],a=p.axisTupleIndex,r=p.axisTupleIndex,_+=1;h>=_;++_)u=s[_].axisTupleIndex,r=Math.max(r,u);o=0,this._axisTupleLengths[e]-1>r&&(r+=1,o=1),i=this._findDimensionMemberMeasureIndex(s,d),n=this._findDimensionMemberMeasureIndex(s,h),c.push({"startIndex":a,"endIndex":r,"endIndexOffset":o,"measureStartIndex":i,"measureEndIndex":n,"subtotalOffset":0})}else o=0,this._axisTupleLengths[e]-1>r&&(r+=1,o=1),i=this._findDimensionMemberMeasureIndex(s,d),n=this._findDimensionMemberMeasureIndex(s,h),l=this._calculateSubtotalOffset(s,d),c.push({"startIndex":a,"endIndex":r,"endIndexOffset":o,"measureStartIndex":i,"measureEndIndex":n,"subtotalOffset":l});return c},sap.basetable.crosstab.PageManager.prototype._getMeasureAxisRanges=function(t,e){var s,a=this._axisTupleMaps[e];if(void 0!==a)s=this._buildMeasureAxisRangesFromAxisTupleMap(t,e,a);else{s=[];var r,o,i,n,l,c,d,b,h;0===this._measureAxisPosition?(d=t*this._pageSize,b=this._axisTupleLengths[e],h=Math.min(d+this._pageSize-1,b*this._numMeasures-1),r=d%b,o=h%b,i=0,this._axisTupleLengths[e]-1>o&&(o+=1,i=1),n=Math.floor(d/b),l=Math.floor(h/b),n===l?s.push({"startIndex":r,"endIndex":o,"endIndexOffset":i,"measureStartIndex":n,"measureEndIndex":l}):(s.push({"startIndex":r,"endIndex":b-1,"endIndexOffset":0,"measureStartIndex":n,"measureEndIndex":n}),s.push({"startIndex":0,"endIndex":o,"endIndexOffset":i,"measureStartIndex":l,"measureEndIndex":l}))):this._measureAxisPosition===this._getNumDimensions(e)&&(d=t*this._pageSize,b=this._axisTupleLengths[e],h=Math.min(d+this._pageSize-1,b*this._numMeasures-1),r=Math.floor(d/this._numMeasures),o=Math.floor(h/this._numMeasures),i=0,this._axisTupleLengths[e]-1>o&&(o+=1,i=1),n=d%this._numMeasures,l=h%this._numMeasures,s.push({"startIndex":r,"endIndex":o,"endIndexOffset":i,"measureStartIndex":n,"measureEndIndex":l,"subtotalOffset":c}))}return s},sap.basetable.crosstab.PageManager.prototype._createWindowAxisSpecifications=function(t){var e,s=[];if("row"===this._measureAxisType||"column"===this._measureAxisType){var a="row"===this._measureAxisType?this._rowAxisName:this._columnAxisName,r="row"===this._measureAxisType?t.rowPageIndex:t.columnPageIndex,o="row"===this._measureAxisType?this._columnAxisName:this._rowAxisName,i="row"===this._measureAxisType?t.columnPageIndex:t.rowPageIndex,n=o?this._getAxisRange(i,o):null,l=a?this._getMeasureAxisRanges(r,a):null;if(l)for(var c=0;l.length>c;++c)e={},e[a]=l[c],n&&(e[o]=n),s.push(e);else n&&(e={},e[o]=n,s.push(e))}else e={},this._rowAxisName&&(e[this._rowAxisName]=this._getAxisRange(t.rowPageIndex,this._rowAxisName)),this._columnAxisName&&(e[this._columnAxisName]=this._getAxisRange(t.columnPageIndex,this._columnAxisName)),s.push(e);return s},sap.basetable.crosstab.PageManager.prototype._calculatePageSize=function(t){for(var e=t.endIndex-t.startIndex+1;Math.floor(t.startIndex/e)!==Math.floor(t.endIndex/e)&&t.endIndex+1>e;)e++;return e},sap.basetable.crosstab.PageManager.prototype._convertWindowAxisRangeToPageSpecification=function(t){var e=this._calculatePageSize(t),s={"page":Math.floor(t.startIndex/e),"pageSize":e};return s},sap.basetable.crosstab.PageManager.prototype._convertWindowAxisRangeToWindowPageSpecification=function(t){var e=this._calculatePageSize(t),s={"page":Math.floor(t.startIndex/e),"pageSize":e,"startIndexOffset":t.startIndex%e,"endIndexOffset":e-t.endIndex%e+t.endIndexOffset-1};return s},sap.basetable.crosstab.PageManager.prototype._createPageSpecification=function(t,e){for(var s={"coordinates":t,"queryWindowSpecifications":[]},a=0;e.length>a;++a){var r=e[a],o={};
for(var i in r)if(r.hasOwnProperty(i)){var n=r[i],l=i===this._rowAxisName?"rows":"cols";o[l]=this._convertWindowAxisRangeToPageSpecification(n)}s.queryWindowSpecifications.push(o)}return s},sap.basetable.crosstab.PageManager.prototype._createWindowPageSpecifications=function(t){for(var e=[],s=0;t.length>s;++s){var a=t[s],r={};for(var o in a)if(a.hasOwnProperty(o)){var i=a[o];r[o]=this._convertWindowAxisRangeToWindowPageSpecification(i)}e.push(r)}return e},sap.basetable.crosstab.PageManager.prototype._createWindowMeasuresSpecifications=function(t){var e=[],s=null;if(("row"===this._measureAxisType||"column"===this._measureAxisType)&&(s="row"===this._measureAxisType?this._rowAxisName:this._columnAxisName),null!==s)for(var a=0;t.length>a;++a){var r=t[a][s],o={"measureStartIndex":r.measureStartIndex,"measureEndIndex":r.measureEndIndex};e.push(o)}return e},sap.basetable.crosstab.PageManager.prototype._createInitialWindowPageSpecification=function(t,e){var s={};return t&&(s[this._rowAxisName]={"page":0,"pageSize":t,"startIndexOffset":0,"endIndexOffset":0}),e&&(s[this._columnAxisName]={"page":0,"pageSize":e,"startIndexOffset":0,"endIndexOffset":0}),s},sap.basetable.crosstab.PageManager.prototype._createInitialWindowMeasuresSpecification=function(t){var e;if(this._measureAxisName){e={"measureStartIndex":0};var s=Math.max(this._pageSize,t.dimAxes[this._measureAxisName].values.length);s>=this._axisTupleLengths[this._measureAxisName]?e.measureEndIndex=this._numMeasures-1:0===this._measureAxisPosition?e.measureEndIndex=0:this._measureAxisPosition===this._getNumDimensions(this._measureAxisName)&&(e.measureEndIndex=this._numMeasures-1)}return e},sap.basetable.crosstab.PageManager.prototype._getFullAxisLength=function(t){var e=0;if(t){var s=this._axisTupleMaps?this._axisTupleMaps[t]:void 0;if(void 0===s){var a=t===this._rowAxisName?"row":"column";e=this._measureAxisType===a?this._axisTupleLengths[t]*this._numMeasures:this._axisTupleLengths[t]}else e=s.length}return e},sap.basetable.crosstab.PageManager.prototype._fetchPageFromCache=function(t,e){var s=null,a=this._pageCache[t.rowPageIndex];if(a){var r=a[t.columnPageIndex];if(void 0!==r)if(this._initializedWithFullQuery)s=r;else{var o=(t.rowPageIndex+1)*e,i=this._getFullAxisLength(this._rowAxisName),n=o>=i,l=n?i%e:e,c=r[0].rootnode.numOfLeafChildren?r[0].rootnode.numOfLeafChildren:0;if(c>=l){var d=(t.columnPageIndex+1)*e,b=this._getFullAxisLength(this._columnAxisName),h=d>=b,p=h?b%e:e,u=r[1].rootnode.numOfLeafChildren?r[1].rootnode.numOfLeafChildren:0;u>=p&&(s=r)}}}return s},sap.basetable.crosstab.PageManager.prototype._storeInCache=function(t,e,s){for(var a=sap.basetable.crosstab.TupleTreeUtil.splitTupleTree(t[0],s),r=sap.basetable.crosstab.TupleTreeUtil.splitTupleTree(t[1],s),o=t[1].rootnode.numOfLeafChildren?t[1].rootnode.numOfLeafChildren:0,i=e.rowPageIndex,n=0;a.length>n;++n){var l=a[n],c=sap.basetable.crosstab.TupleTreeUtil.splitTupleTreeByDataPoints(l,o,s),d=this._pageCache[i];void 0===d&&(d=[],this._pageCache[i]=d);for(var b=e.columnPageIndex,h=0;r.length>h;++h)d[b]=[c[h],r[h]],b++;i++}},sap.basetable.crosstab.PageManager.prototype._addPage=function(t,e,s){for(var a=this._createWindowAxisSpecifications(t),r=this._createWindowPageSpecifications(a),o=this._createWindowMeasuresSpecifications(a),i=this._crosstabDataProvider._buildTupleTrees(s.queryRequest.queries[0],s.queryResponse[0],this._entityIdCaptionMap,this._measureIdCaptionMap,this._rowAxisName,this._columnAxisName,this._measureAxisType,this._measureGroupName,this._measureAxisPosition,r[e],o[e],this._axisTupleLengths,!0,!0),n=this._pageResults.length-1;n>=0;--n){var l=this._pageResults[n];if(this._equalPages(l.page,t)){l.windows[e]=i;for(var c=!0,d=0;c&&l.windows.length>d;++d)void 0===l.windows[d]&&(c=!1);if(c){for(var b=null,h=0;l.windows.length>h;++h)b=null===b?l.windows[h]:"row"===this._measureAxisType?sap.basetable.crosstab.TupleTreeUtil.mergeTupleTreesVertically(b,l.windows[h]):sap.basetable.crosstab.TupleTreeUtil.mergeTupleTreesHorizontally(b,l.windows[h]);b=sap.basetable.crosstab.TupleTreeUtil.truncateTupleTrees(b,a,this._rowAxisName,this._columnAxisName),this._storeInCache(b,t,this._pageSize);var p=this._fetchPageFromCache(t,this._pageSize);this._pageResults.splice(n,1);var u=this._inProcessPageRequest;this._inProcessPageRequest=void 0;for(var _=0;u&&u.responseHandlers.length>_;++_)u.responseHandlers[_]._setTupleTrees(t,p);this._processNextPendingPageRequest()}else{var g=this._createPageSpecification(t,a);this._eDispatch.crosstablePageRequest(g.coordinates,g.queryWindowSpecifications[e+1],e+1)}}}},sap.basetable.crosstab.PageManager.prototype._processNextPendingPageRequest=function(){if(this._pendingPageRequests.length>0){var t=this._pendingPageRequests[0];this._pendingPageRequests.shift();for(var e=0;t.responseHandlers.length>e;++e)this.fetchPage(t.page,t.responseHandlers[e])}},sap.basetable.crosstab.PageManager.prototype._equalPages=function(t,e){return t.rowPageIndex===e.rowPageIndex&&t.columnPageIndex===e.columnPageIndex},sap.basetable.crosstab.PageManager.prototype._addToPendingPageRequests=function(t,e){for(var s,a=0;this._pendingPageRequests.length>a;++a)if(this._equalPages(this._pendingPageRequests[a].page,t)){s=this._pendingPageRequests[a];break}s||(s={"page":t,"responseHandlers":[]},this._pendingPageRequests.push(s)),s.responseHandlers.push(e)},sap.basetable.crosstab.PageManager.prototype.fetchPage=function(t,e){var s=this._fetchPageFromCache(t,this._pageSize);if(null===s){if(this._metadataFeedIds.length>0||this._initializingAxesMetadata)return this._addToPendingPageRequests(t,e),void 0;if(this._inProcessPageRequest)this._equalPages(this._inProcessPageRequest.page,t)?this._inProcessPageRequest.responseHandlers.push(e):this._addToPendingPageRequests(t,e);else{var a=this._createWindowAxisSpecifications(t),r=this._createPageSpecification(t,a);if(this._eDispatch.mock_pageRequest)this._eDispatch.mock_pageRequest.call(this._queryRequestHandler,r,this._measureGroupName,this._rowAxisName,this._columnAxisName);else{var o={"page":r.coordinates,"windows":[]};o.windows[r.queryWindowSpecifications.length-1]=void 0,this._pageResults.push(o),this._eDispatch.crosstablePageRequest(r.coordinates,r.queryWindowSpecifications[0],0)}this._inProcessPageRequest={"page":t,"responseHandlers":[e]}}}else e._setTupleTrees(t,s)},sap.basetable.crosstab.PageManager.prototype.getFullAxisLengthByIndex=function(t){var e=0;return 0===t?e=null===this._rowAxisName?this._measureAxisType===this._crosstabConstants.Row?this._numMeasures:0:this._getFullAxisLength(this._rowAxisName):1===t&&(e=null===this._columnAxisName?this._measureAxisType===this._crosstabConstants.Column?this._numMeasures:1:this._getFullAxisLength(this._columnAxisName)),e},jQuery.sap.declare("sap.basetable.crosstab.renderer.CustomRenderer"),sap.basetable.crosstab.renderer.CustomRenderer=function(){},sap.basetable.crosstab.renderer.CustomRenderer.render=function(t,e,s,a,r){var o=t.callBack;o.call(this,e,s,a,r)},jQuery.sap.declare("sap.basetable.crosstab.renderer.CVOMRenderer"),sap.basetable.crosstab.renderer.CVOMRenderer=function(){},sap.basetable.crosstab.renderer.CVOMRenderer.render=function(t,e,s){var a={"plotArea":{},"title":{"visible":!1},"xAxis":{"visible":!1},"yAxis":{"visible":!1},"tooltip":{"visible":!1},"legend":{"visible":!1}},r=t.chartOption?t.chartOption:a;$("#"+e).html("");var o=new sap.viz.api.data.CrosstableDataset;o.data(s),sap.viz.api.core.createViz({"type":t.type,"data":o,"container":$("#"+e),"options":r})},jQuery.sap.declare("sap.basetable.crosstab.renderer.MiniChartRenderer"),sap.basetable.crosstab.renderer.MiniChartRenderer=function(){},sap.basetable.crosstab.renderer.MiniChartRenderer.render=function(t,e,s){var a={"plotArea":{},"title":{"visible":!1},"xAxis":{"visible":!1},"yAxis":{"visible":!1},"tooltip":{"visible":!1},"legend":{"visible":!1}},r=t.chartOption?t.chartOption:a;$("#"+e).html("");var o=new sap.viz.api.data.CrosstableDataset;o.data(s),sap.viz.api.core.createViz({"type":t.type,"data":o,"container":$("#"+e),"options":r})},jQuery.sap.declare("sap.basetable.crosstab.renderer.StringRenderer"),sap.basetable.crosstab.renderer.StringRenderer=function(){},sap.basetable.crosstab.renderer.StringRenderer.render=function(t,e,s){var a=$("#"+t),r=e;s&&s.forEach(function(t){sap.basetable.crosstab.Format.TYPE_STYLE===t.type&&a.css(t.body.style),sap.basetable.crosstab.Format.TYPE_SIMPLE===t.type}),a.children(0).text(r)},jQuery.sap.declare("sap.basetable.crosstab.ScrollPageManager"),sap.basetable.crosstab.ScrollPageManager=function(t,e,s,a){this._pageManager=new sap.basetable.crosstab.PageManager(t,e,s,this,a),this._coordinatesPages=[]},sap.basetable.crosstab.ScrollPageManager.prototype.getPageSize=function(){return this._pageManager.getPageSize()},sap.basetable.crosstab.ScrollPageManager.prototype.initialize=function(t){this._pageManager._initialize(t)},sap.basetable.crosstab.ScrollPageManager.prototype.initializeAxesMetadata=function(){this._pageManager.initializeAxesMetadata()},sap.basetable.crosstab.ScrollPageManager.prototype.updateAxesMetadata=function(t,e){this._pageManager.updateAxesMetadata(t,e)},sap.basetable.crosstab.ScrollPageManager.prototype.addPage=function(t,e,s){this._pageManager._addPage(t,e,s)},sap.basetable.crosstab.ScrollPageManager.prototype._getPageCoordinatesFromViewCoordinates=function(t){var e=this.getPageSize(),s={"rowPageIndex":Math.floor(t.startRowIndex/e),"columnPageIndex":Math.floor(t.startColumnIndex/e)},a={"rowPageIndex":Math.floor(t.endRowIndex/e),"columnPageIndex":Math.floor(t.endColumnIndex/e)},r=[];if(s.rowPageIndex===a.rowPageIndex&&s.columnPageIndex===a.columnPageIndex)r.push(s);else if(r.push(s),r.push(a),s.rowPageIndex!==a.rowPageIndex&&s.columnPageIndex!==a.columnPageIndex){var o={"rowPageIndex":s.rowPageIndex,"columnPageIndex":a.columnPageIndex};r.splice(1,0,o);var i={"rowPageIndex":a.rowPageIndex,"columnPageIndex":s.columnPageIndex};r.splice(2,0,i)}return r},sap.basetable.crosstab.ScrollPageManager.prototype.fetchViewPage=function(t,e){var s=this._getPageCoordinatesFromViewCoordinates(t),a={"coordinates":t,"pageIndices":s,"pages":[],"requestHandler":e};this._coordinatesPages.push(a);for(var r=0;s.length>r;++r)this._pageManager.fetchPage(s[r],this)},sap.basetable.crosstab.ScrollPageManager.prototype._setTupleTrees=function(t,e){for(var s=this._coordinatesPages.length-1;s>=0;--s){for(var a=this._coordinatesPages[s],r=0;a.pageIndices.length>r;++r){var o=a.pageIndices[r];if(o.rowPageIndex===t.rowPageIndex&&o.columnPageIndex===t.columnPageIndex){a.pages[r]=e;break}}for(var i=a.pages.length===a.pageIndices.length,n=0;i&&a.pages.length>n;++n)a.pages[n]||(i=!1);if(i){var l;if(1===a.pageIndices.length)l=a.pages[0];else if(2===a.pageIndices.length)l=a.pageIndices[0].rowPageIndex===a.pageIndices[1].rowPageIndex?sap.basetable.crosstab.TupleTreeUtil.mergeTupleTreesHorizontally(a.pages[0],a.pages[1]):sap.basetable.crosstab.TupleTreeUtil.mergeTupleTreesVertically(a.pages[0],a.pages[1]);else{var c=sap.basetable.crosstab.TupleTreeUtil.mergeTupleTreesHorizontally(a.pages[0],a.pages[1]),d=sap.basetable.crosstab.TupleTreeUtil.mergeTupleTreesHorizontally(a.pages[2],a.pages[3]);l=sap.basetable.crosstab.TupleTreeUtil.mergeTupleTreesVertically(c,d)}var b=this.getPageSize(),h=a.coordinates.startRowIndex%b,p=a.coordinates.endRowIndex-a.coordinates.startRowIndex+1,u=a.coordinates.startColumnIndex%b,_=a.coordinates.endColumnIndex-a.coordinates.startColumnIndex+1,g=sap.basetable.crosstab.TupleTreeUtil.truncateTupleTreeRowsColumns(l,h,p,u,_);a.requestHandler.setTupleTrees(a.coordinates,g),this._coordinatesPages.splice(s,1)}}},sap.basetable.crosstab.ScrollPageManager.prototype.getFullAxisLength=function(t){return this._pageManager.getFullAxisLengthByIndex(t)},jQuery.sap.declare("sap.basetable.crosstab.TupleTreeUtil"),sap.basetable.crosstab.TupleTreeUtil={},sap.basetable.crosstab.TupleTreeUtil.getFirstTupleNodes=function(t){var e=t[t.length-1];return void 0!==e.children&&e.children.length>0&&(t.push(e.children[0]),this.getFirstTupleNodes(t)),t},sap.basetable.crosstab.TupleTreeUtil.getLastTupleNodes=function(t){var e=t[t.length-1];return void 0!==e.children&&e.children.length>0&&(t.push(e.children[e.children.length-1]),this.getLastTupleNodes(t)),t},sap.basetable.crosstab.TupleTreeUtil.mergeTupleTreeNodes=function(t,e,s){var a=t[s];if(0===e.children.length)for(var r=0;s>r;++r)t[r].numOfLeafChildren=t[r].numOfLeafChildren?t[r].numOfLeafChildren+1:1;else for(var o=0;e.children.length>o;++o){var i=t[s+1],n=e.children[o];if(!i||i.tuplePath!==n.tuplePath||i.member.id!==n.member.id||i.member.caption!==n.member.caption||i.member.aggregationTarget!==n.member.aggregationTarget){var l=this.copyNode(n);a.children.push(l),t.splice(s+1,t.length-(s+1)),t.push(l)}this.mergeTupleTreeNodes(t,n,s+1)}},sap.basetable.crosstab.TupleTreeUtil.mergeTupleTree=function(t,e){var s=this.copyNode(t,!0),a=this.getLastTupleNodes([s]);return this.mergeTupleTreeNodes(a,e,0),s},sap.basetable.crosstab.TupleTreeUtil.mergeDataPoints=function(t,e){void 0!==t.dataPoints&&void 0!==e.dataPoints&&(t.dataPoints=t.dataPoints.concat(e.dataPoints));for(var s=0;t.children.length>s;++s)this.mergeDataPoints(t.children[s],e.children[s])},sap.basetable.crosstab.TupleTreeUtil.mergeTupleTreeDataPoints=function(t,e){var s=this.copyNode(t,!0);return this.mergeDataPoints(s,e),s},sap.basetable.crosstab.TupleTreeUtil.mergeTupleTreesVertically=function(t,e){var s=[];return s[0]={"rootnode":this.mergeTupleTree(t[0].rootnode,e[0].rootnode)},s[1]={"rootnode":this.copyNode(t[1].rootnode,!0)},s},sap.basetable.crosstab.TupleTreeUtil.mergeTupleTreesHorizontally=function(t,e){var s=[];return s[0]={"rootnode":this.mergeTupleTreeDataPoints(t[0].rootnode,e[0].rootnode)},s[1]={"rootnode":this.mergeTupleTree(t[1].rootnode,e[1].rootnode)},s},sap.basetable.crosstab.TupleTreeUtil.mergeTrees=function(t,e){t.numOfLeafChildren+=e.numOfLeafChildren;for(var s=0;e.children.length>s;s++){for(var a=e.children[s],r=!1,o=0;t.children.length>o;o++){var i=t.children[o];if(i.tuplePath===a.tuplePath&&i.member.id===a.member.id&&i.member.caption===a.member.caption){if(i.member.aggregationTarget&&a.member.aggregationTarget&&i.member.aggregationTarget.id!==a.member.aggregationTarget.id)continue;if(i.member.aggregationTarget&&a.member.aggregationTarget&&i.member.aggregationTarget.id===a.member.aggregationTarget.id){r=!0;break}this.mergeTrees(i,a),r=!0;break}}r||t.children.push(a)}},sap.basetable.crosstab.TupleTreeUtil._copyNodeBase=function(t,e){var s={"tuplePath":t.tuplePath,"children":[]};return t.numOfLeafChildren&&(s.numOfLeafChildren=e?t.numOfLeafChildren:0),t.member&&(s.member={"id":t.member.id,"caption":t.member.caption,"aggregationTarget":t.member.aggregationTarget},void 0!==t.member.stackIndex&&(s.member.stackIndex=t.member.stackIndex)),void 0!==t.isTotal&&(s.isTotal=t.isTotal),void 0!==t.isMeasure&&(s.isMeasure=t.isMeasure),s},sap.basetable.crosstab.TupleTreeUtil.copyNode=function(t,e){var s=this._copyNodeBase(t,e);if(t.dataPoints){s.dataPoints=[];for(var a=0;t.dataPoints.length>a;++a)s.dataPoints.push(t.dataPoints[a])}if(e)for(var r=0;t.children.length>r;++r){var o=this.copyNode(t.children[r],e);s.children.push(o)}return s},sap.basetable.crosstab.TupleTreeUtil.copyDataPointLeafNode=function(t,e,s){var a=this._copyNodeBase(t);if(t.dataPoints){a.dataPoints=[];for(var r=e;t.dataPoints.length>r&&!(void 0!==s&&r>=e+s);++r)a.dataPoints.push(t.dataPoints[r])}return a},sap.basetable.crosstab.TupleTreeUtil.flattenTupleNodes=function(t,e,s){if(0===t.children.length)e.push(t),s.push(e);else for(var a=0;t.children.length>a;++a)this.flattenTupleNodes(t.children[a],e.concat([t]),s);return s},sap.basetable.crosstab.TupleTreeUtil.truncateTupleTree=function(t,e,s){var a,r=this.flattenTupleNodes(t.rootnode,[],[]),o=null;a=void 0===s?r.length-1:Math.min(r.length,e+s)-1;for(var i=e;a>=i;++i){for(var n=r[i],l=[],c=0;n.length>c;++c){var d=0===c?null:l[c-1],b=n[c],h=!0,p=null;if(o&&h){var u=o[c];h=!b.isTotal&&u.tuplePath===b.tuplePath&&(!b.member&&!u.member||b.member&&u.member&&b.member.id===u.member.id&&b.member.caption===u.member.caption),h&&(p=u)}null===p&&(p=this.copyNode(b),d&&d.children.push(p)),d&&d.numOfLeafChildren++,l.push(p),d=p}o=l}var _=null;return null!==o&&(_={"rootnode":o[0]}),_},sap.basetable.crosstab.TupleTreeUtil.truncateTupleTreeDataPoints=function(t,e,s){for(var a=this.flattenTupleNodes(t.rootnode,[],[]),r=null,o=0;a.length>o;++o){for(var i=a[o],n=[],l=0;i.length>l;++l){var c=0===l?null:n[l-1],d=i[l],b=!0,h=null;if(r&&b){var p=r[l];b=!d.isTotal&&p.tuplePath===d.tuplePath&&(!d.member&&!p.member||d.member&&p.member&&d.member.id===p.member.id&&d.member.caption===p.member.caption),b&&(h=p)}null===h&&(h=l===i.length-1?this.copyDataPointLeafNode(d,e,s):this.copyNode(d),c&&c.children.push(h)),c&&c.numOfLeafChildren++,n.push(h),c=h}r=n}var u=null;return null!==r&&(u={"rootnode":r[0]}),u},sap.basetable.crosstab.TupleTreeUtil.truncateTupleTrees=function(t,e,s,a){var r=t[0],o=t[1],i=e[0];if(void 0!==i){var n=i[a];n&&n.subtotalOffset&&(o=this.truncateTupleTree(o,n.subtotalOffset),r=this.truncateTupleTreeDataPoints(r,n.subtotalOffset));var l=i[s];l&&l.subtotalOffset&&(r=this.truncateTupleTree(r,l.subtotalOffset))}return[r,o]},sap.basetable.crosstab.TupleTreeUtil.truncateTupleTreeRows=function(t,e,s){var a=this.truncateTupleTree(t[0],e,s);return[a,t[1]]},sap.basetable.crosstab.TupleTreeUtil.truncateTupleTreeColumns=function(t,e,s){var a=this.truncateTupleTreeDataPoints(t[0],e,s),r=this.truncateTupleTree(t[1],e,s);return[a,r]},sap.basetable.crosstab.TupleTreeUtil.truncateTupleTreeRowsColumns=function(t,e,s,a,r){var o=this.truncateTupleTreeRows(t,e,s);return this.truncateTupleTreeColumns(o,a,r)},sap.basetable.crosstab.TupleTreeUtil.splitTupleTree=function(t,e){for(var s=this.flattenTupleNodes(t.rootnode,[],[]),a=[],r=null,o=0;s.length>o;++o){for(var i=s[o],n=!0,l=[],c=0;i.length>c;++c){var d=0===c?null:l[c-1],b=i[c],h=null;if(r&&n){var p=r[c];n=!b.isTotal&&p.tuplePath===b.tuplePath&&(!b.member&&!p.member||b.member&&p.member&&b.member.id===p.member.id&&b.member.caption===p.member.caption),n&&(h=p)}null===h&&(h=this.copyNode(b),d&&d.children.push(h)),d&&d.numOfLeafChildren++,l.push(h),d=h}0===(o+1)%e?(a.push({"rootnode":l[0]}),r=null):r=l}return r&&a.push({"rootnode":r[0]}),a},sap.basetable.crosstab.TupleTreeUtil.splitTupleTreeByDataPoints=function(t,e,s){var a=this.flattenTupleNodes(t.rootnode,[],[]),r=[],o=null,i=0;do{for(var n=0;a.length>n;++n){for(var l=a[n],c=!0,d=[],b=0;l.length>b;++b){var h=0===b?null:d[b-1],p=l[b],u=null;if(o&&c){var _=o[b];c=!p.isTotal&&_.tuplePath===p.tuplePath&&(!p.member&&!_.member||p.member&&_.member&&p.member.id===_.member.id&&p.member.caption===_.member.caption),c&&(u=_)}null===u&&(u=b===l.length-1?this.copyDataPointLeafNode(p,i,s):this.copyNode(p),h&&h.children.push(u)),h&&h.numOfLeafChildren++,d.push(u),h=u}o=d}o&&r.push({"rootnode":o[0]}),o=null,i+=s}while(e>i);return r},jQuery.sap.declare("sap.basetable.crosstab.UI5Crosstab"),jQuery.sap.require("sap.ui.core.Control"),jQuery.sap.require("sap.basetable.crosstab.BaseControl"),jQuery.sap.require("sap.basetable.crosstab.Crosstab"),jQuery.sap.require("sap.basetable.crosstab.CrosstabDataProvider"),sap.basetable.crosstab.BaseControl.extend("sap.basetable.crosstab.UI5Crosstab",{"metadata":{"publicMethods":["select"],"properties":{"width":{"type":"sap.ui.core.CSSSize","group":"Misc","defaultValue":null},"height":{"type":"sap.ui.core.CSSSize","group":"Misc","defaultValue":null},"cellWidth":{"type":"sap.ui.core.CSSSize","group":"Misc","defaultValue":null},"cellHeight":{"type":"sap.ui.core.CSSSize","group":"Misc","defaultValue":null},"rowCellHeight":{"type":"sap.ui.core.CSSSize","group":"Misc","defaultValue":null},"rowCellWidth":{"type":"sap.ui.core.CSSSize","group":"Misc","defaultValue":null}},"aggregations":{"dataProvider":{"type":"sap.basetable.crosstab.CrosstabDataProvider","multiple":!1}},"events":{}}}),sap.basetable.crosstab.UI5Crosstab.prototype.init=function(){sap.basetable.crosstab.BaseControl.prototype.init.apply(this,arguments),this._crosstab=null,this._onThemeChanged=jQuery.proxy(this._applyTheme,this),sap.ui.getCore().attachThemeChanged(this._onThemeChanged),this._clearVariables(),this._externalScrollHandler=null,sap.ui.getCore().getEventBus().subscribe("viz.ext.crosstab","externalCrosstabScroll",this.handleExternalScroll,this),sap.ui.getCore().getEventBus().subscribe("viz.ext.crosstab","scaleCrosstab",this.handleCrosstabScaling,this)},sap.basetable.crosstab.UI5Crosstab.prototype.applySettings=function(){sap.ui.core.Control.prototype.applySettings.apply(this,arguments),this._createCrosstab()},sap.basetable.crosstab.UI5Crosstab.prototype.exit=function(){sap.basetable.crosstab.BaseControl.prototype.exit.apply(this,arguments),sap.ui.getCore().detachThemeChanged(this._onThemeChanged),this._clearVariables(),sap.ui.getCore().getEventBus().unsubscribe("viz.ext.crosstab","externalCrosstabScroll",this.handleExternalScroll,this),sap.ui.getCore().getEventBus().unsubscribe("viz.ext.crosstab","scaleCrosstab",this.handleCrosstabScaling,this)},sap.basetable.crosstab.UI5Crosstab.prototype.setDataProvider=function(t){this._crosstab&&this._crosstab.setDataProvider(t)},sap.basetable.crosstab.UI5Crosstab.prototype.vizUpdate=function(t){this._crosstab&&t.dataProvider&&this._crosstab.vizUpdate(t.dataProvider)},sap.basetable.crosstab.UI5Crosstab.prototype.getIntWidth=function(){var t=-1,e=this.getWidth();return e&&"auto"!==e&&(t=parseInt(e,10)),t},sap.basetable.crosstab.UI5Crosstab.prototype.getIntHeight=function(){var t=-1,e=this.getHeight();return e&&"auto"!==e&&(t=parseInt(e,10)),t},sap.basetable.crosstab.UI5Crosstab.prototype.getIntCellWidth=function(){var t=-1,e=this.getCellWidth();return e&&"auto"!==e&&(t=parseInt(e,10)),t},sap.basetable.crosstab.UI5Crosstab.prototype.getIntCellHeight=function(){var t=-1,e=this.getCellHeight();return e&&"auto"!==e&&(t=parseInt(e,10)),t},sap.basetable.crosstab.UI5Crosstab.prototype.getIntRowCellHeight=function(){var t=-1,e=this.getRowCellHeight();return e&&"auto"!==e&&(t=parseInt(e,10)),t},sap.basetable.crosstab.UI5Crosstab.prototype.getIntRowCellWidth=function(){var t=-1,e=this.getRowCellWidth();return t&&"auto"!==e&&(t=parseInt(e,10)),t},sap.basetable.crosstab.UI5Crosstab.prototype.select=function(t,e,s){return this._crosstab?this._crosstab.select(t,e,s):null},sap.basetable.crosstab.UI5Crosstab.prototype.handleExternalScroll=function(t,e,s){this.ignoreExternalScroll()||"viz.ext.crosstab"!==t||"externalCrosstabScroll"!==e||(this.externalScrollHandler&&this.externalScrollHandler.getUI5Crosstab().sId===this.sId||(this.externalScrollHandler=new sap.basetable.crosstab.ExternalScrollHandler(this)),this.externalScrollHandler.doScroll(s))},sap.basetable.crosstab.UI5Crosstab.prototype.handleCrosstabScaling=function(t,e,s){"viz.ext.crosstab"===t&&"scaleCrosstab"===e&&void 0!==typeof s&&"number"==typeof s.scaleFactor&&this._crosstab.setScaleFactor(s.scaleFactor)},sap.basetable.crosstab.UI5Crosstab.prototype.getScaleFactor=function(){return this._crosstab.getScaleFactor()},sap.basetable.crosstab.UI5Crosstab.prototype.ignoreExternalScroll=function(){return this._crosstab?this._crosstab.isHorizontallyScrollable()&&this._crosstab.isVerticallyScrollable():!0},sap.basetable.crosstab.UI5Crosstab.prototype._clearVariables=function(){this._crosstab$=null},sap.basetable.crosstab.UI5Crosstab.prototype._createCrosstab=function(){this._applyTheme();var t="ui5-viz-controls";this._crosstab$=$(document.createElement("div")),this._crosstab$.addClass(t+"-viz-frame"),$(this._app$).attr("data-sap-ui-preserve",!0);var e={"size":{"width":this.getIntWidth(),"height":this.getIntHeight(),"cellWidth":this.getIntCellWidth(),"cellHeight":this.getIntCellHeight(),"rowCellHeight":this.getIntRowCellHeight(),"rowCellWidth":this.getIntRowCellWidth()},"container":$(this._crosstab$),"dataProvider":this.getDataProvider(),"parentId":this.sId.split("__")[1]};this._crosstab=new sap.basetable.crosstab.Crosstab(e)},sap.basetable.crosstab.UI5Crosstab.prototype._updateCrosstab=function(t){this._crosstab&&(this._crosstab.draw(this.getIntHeight(),this.getIntWidth(),t),this._crosstab.renderCellGroups())},sap.basetable.crosstab.UI5Crosstab.prototype._createChildren=function(){this._crosstab$.appendTo(this._app$),this._updateCrosstab(!1)},sap.basetable.crosstab.UI5Crosstab.prototype._updateChildren=function(t){var e=!$.isEmptyObject(t);this._updateCrosstab(e)},sap.basetable.crosstab.UI5Crosstab.prototype._applyTheme=function(){},sap.basetable.crosstab.UI5Crosstab.prototype.setRoot=function(t){this._crosstab.setRoot(t)},sap.basetable.crosstab.UI5Crosstab.prototype.getCrosstab=function(){return this._crosstab},jQuery.sap.declare("sap.basetable.crosstab.UI5CrosstabRenderer"),sap.basetable.crosstab.UI5CrosstabRenderer={},sap.basetable.crosstab.UI5CrosstabRenderer.render=function(t,e){t.write("<DIV"),t.writeControlData(e),t.addClass("sapUI5Crosstab"),t.writeClasses(),t.addStyle("width",e.getWidth()),t.addStyle("height",e.getHeight()),t.addStyle("overflow","hidden"),t.writeStyles(),t.write(">"),t.write("</DIV>")},jQuery.sap.declare("sap.basetable.crosstab.utils.FormatUtils"),sap.basetable.crosstab.utils.FormatUtils=function(){},sap.basetable.crosstab.utils.FormatUtils.NUMERIC_PREFIX="numeric:",sap.basetable.crosstab.utils.FormatUtils.createFormatArray=function(t){if(!$.isEmptyObject(t)){for(var e,s=[],a=0;t.length>a;a++){var r=t[a];r&&(void 0===e&&(e=0===r.indexOf(sap.basetable.crosstab.utils.FormatUtils.NUMERIC_PREFIX)),e&&s.push(r))}return s}},sap.basetable.crosstab.utils.FormatUtils.applyFormats=function(t,e){return"string"==typeof e&&(t=sap.viz.api.env.Format.format(t,e)),t},jQuery.sap.declare("sap.basetable.crosstab.utils.RenderUtils"),sap.basetable.crosstab.utils.RenderUtils=function(){},sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutCell=function(t){var e=$(document.createElement("div"));return e.attr({"id":t}),e},sap.basetable.crosstab.utils.RenderUtils.createMatrixLayoutRow=function(t,e,s,a){var r=$(document.createElement("div"));return r.attr({"id":t}),e&&r.css({"height":e}),s&&r.append(s),r.addClass("crosstab-row"),r.addClass(a),r},sap.basetable.crosstab.utils.RenderUtils.createMatrixLayout=function(t,e,s,a){var r=$(document.createElement("div"));return r.attr({"id":t,"layoutFixed":!0,"widths":a}),r.css({"width":e+"px","height":s+"px","border-spacing":"0px","padding":"0px"}),r},sap.basetable.crosstab.utils.RenderUtils.createContentCell=function(t,e,s,a,r,o,i,n,l,c,d){var b=e,h=s;o&&o>1?(h*=o,h-=a):h-=a,c?b=c-a:i&&i>1?(b*=i,b-=a):b-=a,b=l?b+1:b;var p=$(document.createElement("div"));if(p[0].setAttribute("id",t),p[0].style.width=b+"px",p[0].style.minWidth=b+"px",p[0].style.maxWidth=b+"px",p[0].style.height=h+"px",p[0].style.lineHeight=h+"px",n&&(p[0].className=n),p.append(r),!d){var u=$(document.createElement("div"));u[0].className="crosstab-resizable",p.append(u)}return p},sap.basetable.crosstab.utils.RenderUtils.createHeaderCell=function(t,e,s,a,r,o,i,n,l,c,d,b,h){var p=this.createMatrixLayoutCell(t+"-div"),u=this.createContentCell(t,e,s,a,r,i,n,l,c,b,h);return d&&u.attr("title",d),p.append(u),o&&p.append(o),p},sap.basetable.crosstab.utils.RenderUtils.styleClasstoString=function(t){var e="";for(var s in t)t.hasOwnProperty(s)&&(e=e+s+": "+t[s]+";");return e.substr(0,e.length-1)},sap.basetable.crosstab.utils.RenderUtils._removeSelectionForOtherCells=function(t){for(var e=$(".crosstab-cell-selected").not(t),s=0;e.length>s;s++){var a=$(e[s]);a.removeClass("crosstab-cell-selected")}},sap.basetable.crosstab.utils.RenderUtils._selectCellUnderFloatingHeader=function(t,e){var s=!1;if(t.hasClass("crosstab-FloatingCell")&&(s=!0),s)for(var a=0;e.length>a;a++){var r=e[a],o=$(r.$headerDom),i=r.referenceId,n=$("div[id='"+i+"'");if(o.hasClass("crosstab-cell-selected")){n.addClass("crosstab-cell-selected");break}}},sap.basetable.crosstab.utils.RenderUtils.styleSelectedCells=function(t,e){var s,a=t.parent(),r=".crosstab-Cell, .crosstab-Cell-Top, .crosstab-FloatingCell",o=".crosstab-DataArea, .crosstab-LeftDimensionHeaders, .crosstab-columnDimensionHeaderRow";return a.is(r)?s=a:t.is(r)&&(s=t),s&&!s.parents().is(o)&&(s.toggleClass("crosstab-cell-selected"),this._removeSelectionForOtherCells(s),this._selectCellUnderFloatingHeader(s,e)),s},define("crosstabviewer/CrosstabViewer",function(){});